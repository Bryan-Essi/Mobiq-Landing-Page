{"version":3,"file":"static/js/698.784c8c3a.chunk.js","mappings":"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","sources":["utils/deviceSelection.ts","../node_modules/lucide-react/src/icons/pencil.ts","../node_modules/lucide-react/src/icons/star.ts","../node_modules/lucide-react/src/icons/star-off.ts","../node_modules/lucide-react/src/icons/timer.ts","components/CallTestDialog.tsx","pages/TestModules.tsx"],"sourcesContent":["export const SELECTED_DEVICES_STORAGE_KEY = 'selectedDeviceIds';\nconst LEGACY_SELECTED_DEVICE_KEY = 'selectedDeviceId';\nexport const SELECTED_DEVICES_EVENT = 'selected-devices:updated';\n\nconst normalizeIds = (value: unknown): string[] => {\n  if (!value) {\n    return [];\n  }\n  if (Array.isArray(value)) {\n    return value.filter((id): id is string => typeof id === 'string' && id.trim().length > 0);\n  }\n  if (typeof value === 'string') {\n    try {\n      const parsed = JSON.parse(value);\n      if (Array.isArray(parsed)) {\n        return normalizeIds(parsed);\n      }\n    } catch {\n      const trimmed = value.trim();\n      if (trimmed.length > 0) {\n        return [trimmed];\n      }\n    }\n  }\n  return [];\n};\n\nexport const readSelectedDeviceIds = (): string[] => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return [];\n  }\n  try {\n    const stored = window.localStorage.getItem(SELECTED_DEVICES_STORAGE_KEY);\n    const ids = normalizeIds(stored);\n    if (ids.length > 0) {\n      return Array.from(new Set(ids));\n    }\n    const legacy = window.localStorage.getItem(LEGACY_SELECTED_DEVICE_KEY);\n    const legacyIds = normalizeIds(legacy);\n    if (legacyIds.length > 0) {\n      writeSelectedDeviceIds(legacyIds);\n      window.localStorage.removeItem(LEGACY_SELECTED_DEVICE_KEY);\n      return legacyIds;\n    }\n  } catch (error) {\n    console.warn('[deviceSelection] Failed to read selected devices', error);\n  }\n  return [];\n};\n\nexport const writeSelectedDeviceIds = (ids: string[]) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    const uniqueIds = Array.from(new Set(ids.filter((id) => typeof id === 'string' && id.trim().length > 0)));\n    window.localStorage.setItem(SELECTED_DEVICES_STORAGE_KEY, JSON.stringify(uniqueIds));\n    window.dispatchEvent(new CustomEvent(SELECTED_DEVICES_EVENT, { detail: uniqueIds }));\n  } catch (error) {\n    console.warn('[deviceSelection] Failed to persist selected devices', error);\n  }\n};\n\nexport const clearSelectedDeviceIds = () => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.removeItem(SELECTED_DEVICES_STORAGE_KEY);\n    window.dispatchEvent(new CustomEvent(SELECTED_DEVICES_EVENT, { detail: [] }));\n  } catch (error) {\n    console.warn('[deviceSelection] Failed to clear selected devices', error);\n  }\n};\n\nexport const toggleSelectedDeviceId = (ids: string[], deviceId: string): string[] => {\n  const set = new Set(ids);\n  if (set.has(deviceId)) {\n    set.delete(deviceId);\n  } else {\n    set.add(deviceId);\n  }\n  return Array.from(set);\n};\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z',\n      key: '1a8usu',\n    },\n  ],\n  ['path', { d: 'm15 5 4 4', key: '1mk7zo' }],\n];\n\n/**\n * @component @name Pencil\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMTc0IDYuODEyYTEgMSAwIDAgMC0zLjk4Ni0zLjk4N0wzLjg0MiAxNi4xNzRhMiAyIDAgMCAwLS41LjgzbC0xLjMyMSA0LjM1MmEuNS41IDAgMCAwIC42MjMuNjIybDQuMzUzLTEuMzJhMiAyIDAgMCAwIC44My0uNDk3eiIgLz4KICA8cGF0aCBkPSJtMTUgNSA0IDQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/pencil\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pencil = createLucideIcon('pencil', __iconNode);\n\nexport default Pencil;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z',\n      key: 'r04s7s',\n    },\n  ],\n];\n\n/**\n * @component @name Star\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTEuNTI1IDIuMjk1YS41My41MyAwIDAgMSAuOTUgMGwyLjMxIDQuNjc5YTIuMTIzIDIuMTIzIDAgMCAwIDEuNTk1IDEuMTZsNS4xNjYuNzU2YS41My41MyAwIDAgMSAuMjk0LjkwNGwtMy43MzYgMy42MzhhMi4xMjMgMi4xMjMgMCAwIDAtLjYxMSAxLjg3OGwuODgyIDUuMTRhLjUzLjUzIDAgMCAxLS43NzEuNTZsLTQuNjE4LTIuNDI4YTIuMTIyIDIuMTIyIDAgMCAwLTEuOTczIDBMNi4zOTYgMjEuMDFhLjUzLjUzIDAgMCAxLS43Ny0uNTZsLjg4MS01LjEzOWEyLjEyMiAyLjEyMiAwIDAgMC0uNjExLTEuODc5TDIuMTYgOS43OTVhLjUzLjUzIDAgMCAxIC4yOTQtLjkwNmw1LjE2NS0uNzU1YTIuMTIyIDIuMTIyIDAgMCAwIDEuNTk3LTEuMTZ6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/star\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Star = createLucideIcon('star', __iconNode);\n\nexport default Star;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43', key: '16m0ql' }],\n  ['path', { d: 'M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91', key: '1vt8nq' }],\n  ['line', { x1: '2', x2: '22', y1: '2', y2: '22', key: 'a6p6uj' }],\n];\n\n/**\n * @component @name StarOff\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNOC4zNCA4LjM0IDIgOS4yN2w1IDQuODdMNS44MiAyMSAxMiAxNy43NyAxOC4xOCAyMWwtLjU5LTMuNDMiIC8+CiAgPHBhdGggZD0iTTE4LjQyIDEyLjc2IDIyIDkuMjdsLTYuOTEtMUwxMiAybC0xLjQ0IDIuOTEiIC8+CiAgPGxpbmUgeDE9IjIiIHgyPSIyMiIgeTE9IjIiIHkyPSIyMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/star-off\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst StarOff = createLucideIcon('star-off', __iconNode);\n\nexport default StarOff;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['line', { x1: '10', x2: '14', y1: '2', y2: '2', key: '14vaq8' }],\n  ['line', { x1: '12', x2: '15', y1: '14', y2: '11', key: '17fdiu' }],\n  ['circle', { cx: '12', cy: '14', r: '8', key: '1e1u0o' }],\n];\n\n/**\n * @component @name Timer\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8bGluZSB4MT0iMTAiIHgyPSIxNCIgeTE9IjIiIHkyPSIyIiAvPgogIDxsaW5lIHgxPSIxMiIgeDI9IjE1IiB5MT0iMTQiIHkyPSIxMSIgLz4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjE0IiByPSI4IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/timer\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Timer = createLucideIcon('timer', __iconNode);\n\nexport default Timer;\n","import React, { useEffect, useMemo, useState } from 'react';\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  TextField,\n  Button,\n  Grid,\n  Typography,\n  Box,\n} from '@mui/material';\nimport { CallTestValues } from '../types/callTest';\n\nexport type CallTestMode = 'run' | 'edit';\n\ntype FormField = 'countryCode' | 'phoneNumber' | 'duration' | 'callCount';\n\ninterface CallTestDialogProps {\n  open: boolean;\n  mode: CallTestMode;\n  initialValues: CallTestValues;\n  targetDeviceId?: string | null;\n  stepIndex?: number;\n  totalSteps?: number;\n  onCancel: () => void;\n  onSubmit: (values: CallTestValues) => Promise<void> | void;\n  canGoBack?: boolean;\n  onPrevious?: () => void;\n}\n\ninterface FormState {\n  countryCode: string;\n  phoneNumber: string;\n  duration: string;\n  callCount: string;\n}\n\nconst sanitizeCountryCode = (value: string): string => {\n  const digits = value.replace(/[^0-9]/g, '');\n  return digits ? `+${digits}` : '';\n};\n\nconst sanitizePhoneNumber = (value: string): string => value.replace(/[^0-9]/g, '');\n\nconst CallTestDialog: React.FC<CallTestDialogProps> = ({\n  open,\n  mode,\n  initialValues,\n  targetDeviceId,\n  stepIndex,\n  totalSteps,\n  onCancel,\n  onSubmit,\n  canGoBack = false,\n  onPrevious,\n}) => {\n  const [formState, setFormState] = useState<FormState>(() => ({\n    countryCode: initialValues.countryCode,\n    phoneNumber: initialValues.phoneNumber,\n    duration: String(initialValues.duration),\n    callCount: String(initialValues.callCount),\n  }));\n\n  const [errors, setErrors] = useState<Partial<Record<FormField, string>>>({});\n  const [submitting, setSubmitting] = useState(false);\n\n  useEffect(() => {\n    if (!open) {\n      return;\n    }\n    setFormState({\n      countryCode: initialValues.countryCode,\n      phoneNumber: initialValues.phoneNumber,\n      duration: String(initialValues.duration),\n      callCount: String(initialValues.callCount),\n    });\n    setErrors({});\n    setSubmitting(false);\n  }, [open, initialValues]);\n\n  const isLastStep = !totalSteps || !stepIndex || stepIndex >= totalSteps;\n  const deviceLabel = targetDeviceId ?? 'Default template';\n  const stepLabel =\n    stepIndex && totalSteps\n      ? `(${stepIndex}/${totalSteps})`\n      : undefined;\n\n  const dialogTitle = useMemo(() => {\n    return mode === 'run' ? 'Call Test Parameters' : 'Edit Call Test Parameters';\n  }, [mode]);\n\n  const primaryButtonLabel = useMemo(() => {\n    if (mode === 'run') {\n      return isLastStep ? 'Launch Test' : 'Next Device';\n    }\n    return isLastStep ? 'Save' : 'Next Device';\n  }, [isLastStep, mode]);\n\n  const handleChange = (field: FormField) => (event: React.ChangeEvent<HTMLInputElement>) => {\n    setFormState((prev) => ({\n      ...prev,\n      [field]: event.target.value,\n    }));\n  };\n\n  const validate = (): { values?: CallTestValues; hasErrors: boolean } => {\n    const validationErrors: Partial<Record<FormField, string>> = {};\n\n    const normalizedCountryCode = sanitizeCountryCode(formState.countryCode.trim());\n    if (!normalizedCountryCode) {\n      validationErrors.countryCode = 'Please enter a country code (e.g. +237)';\n    } else if (!/^\\+[0-9]{1,4}$/.test(normalizedCountryCode)) {\n      validationErrors.countryCode = 'Country code must contain 1 to 4 digits';\n    }\n\n    const normalizedPhone = sanitizePhoneNumber(formState.phoneNumber);\n    if (!normalizedPhone) {\n      validationErrors.phoneNumber = 'Please enter a contact number';\n    } else if (normalizedPhone.length < 4) {\n      validationErrors.phoneNumber = 'Number must contain at least 4 digits';\n    }\n\n    const durationValue = parseInt(formState.duration, 10);\n    if (Number.isNaN(durationValue)) {\n      validationErrors.duration = 'Invalid duration';\n    } else if (durationValue <= 0) {\n      validationErrors.duration = 'Duration must be greater than 0';\n    } else if (durationValue > 600) {\n      validationErrors.duration = 'Duration cannot exceed 600 seconds';\n    }\n\n    const callCountValue = parseInt(formState.callCount, 10);\n    if (Number.isNaN(callCountValue)) {\n      validationErrors.callCount = 'Invalid call count';\n    } else if (callCountValue < 1 || callCountValue > 10) {\n      validationErrors.callCount = 'Call count must be between 1 and 10';\n    }\n\n    setErrors(validationErrors);\n\n    if (Object.keys(validationErrors).length > 0) {\n      return { hasErrors: true };\n    }\n\n    return {\n      hasErrors: false,\n      values: {\n        countryCode: normalizedCountryCode,\n        phoneNumber: normalizedPhone,\n        duration: durationValue,\n        callCount: callCountValue,\n      },\n    };\n  };\n\n  const handleSubmit = async () => {\n    const { hasErrors, values } = validate();\n    if (hasErrors || !values) {\n      return;\n    }\n\n    try {\n      setSubmitting(true);\n      await onSubmit(values);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onClose={submitting ? undefined : onCancel} fullWidth maxWidth=\"sm\">\n      <DialogTitle>{dialogTitle}</DialogTitle>\n      <DialogContent>\n        <Typography variant=\"body2\" sx={{ color: '#475569', mb: 1.5 }}>\n          Provide the details required for the call scenario. Parameters are stored locally and reused for upcoming runs.\n        </Typography>\n        {mode === 'run' ? (\n          targetDeviceId ? (\n            <Typography variant=\"body2\" sx={{ color: '#2563EB', mb: 3 }}>\n              Device {stepLabel ? `${stepLabel}  ` : ''}<strong>{targetDeviceId}</strong>\n            </Typography>\n          ) : (\n            <Typography variant=\"body2\" sx={{ color: '#DC2626', mb: 3 }}>\n              No active device selected. Choose one from the dashboard before launching.\n            </Typography>\n          )\n        ) : (\n          <Typography variant=\"body2\" sx={{ color: '#2563EB', mb: 3 }}>\n            Editing parameters for <strong>{deviceLabel}</strong> {stepLabel ? stepLabel : ''}\n          </Typography>\n        )}\n        <Grid container spacing={2}>\n          <Grid item xs={12} sm={4}>\n            <TextField\n              label=\"Country code\"\n              value={formState.countryCode}\n              onChange={handleChange('countryCode')}\n              placeholder=\"+237\"\n              error={Boolean(errors.countryCode)}\n              helperText={errors.countryCode ?? 'International prefix'}\n              fullWidth\n              disabled={submitting}\n              inputProps={{ maxLength: 5 }}\n            />\n          </Grid>\n          <Grid item xs={12} sm={8}>\n            <TextField\n              label=\"Contact number\"\n              value={formState.phoneNumber}\n              onChange={handleChange('phoneNumber')}\n              placeholder=\"691234567\"\n              error={Boolean(errors.phoneNumber)}\n              helperText={errors.phoneNumber ?? 'Digits only (spaces allowed while typing)'}\n              fullWidth\n              disabled={submitting}\n            />\n          </Grid>\n          <Grid item xs={12} sm={6}>\n            <TextField\n              label=\"Call duration (seconds)\"\n              value={formState.duration}\n              onChange={handleChange('duration')}\n              type=\"number\"\n              error={Boolean(errors.duration)}\n              helperText={errors.duration ?? 'Between 1 and 600 seconds'}\n              fullWidth\n              disabled={submitting}\n              inputProps={{ min: 1, max: 600 }}\n            />\n          </Grid>\n          <Grid item xs={12} sm={6}>\n            <TextField\n              label=\"Number of calls\"\n              value={formState.callCount}\n              onChange={handleChange('callCount')}\n              type=\"number\"\n              error={Boolean(errors.callCount)}\n              helperText={errors.callCount ?? 'Between 1 and 10 consecutive calls'}\n              fullWidth\n              disabled={submitting}\n              inputProps={{ min: 1, max: 10 }}\n            />\n          </Grid>\n        </Grid>\n        <Box mt={3} sx={{ backgroundColor: '#F8FAFC', borderRadius: '12px', padding: '12px 16px' }}>\n          <Typography variant=\"caption\" sx={{ color: '#64748B' }}>\n            Tip: adjust parameters in \"Edit\" mode ahead of time and use \"Run\" to launch immediately on the active device.\n          </Typography>\n        </Box>\n      </DialogContent>\n      <DialogActions sx={{ padding: '16px 24px' }}>\n        {canGoBack && (\n          <Button onClick={onPrevious} disabled={submitting} sx={{ textTransform: 'none' }}>\n            Previous device\n          </Button>\n        )}\n        <Button onClick={onCancel} disabled={submitting} sx={{ textTransform: 'none' }}>\n          Cancel\n        </Button>\n        <Button\n          variant=\"contained\"\n          onClick={handleSubmit}\n          disabled={submitting || (mode === 'run' && !targetDeviceId)}\n          sx={{ textTransform: 'none' }}\n        >\n          {primaryButtonLabel}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default CallTestDialog;\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport {\n  Box,\n  Typography,\n  Button,\n  Grid,\n  Card,\n  CardContent,\n  IconButton,\n  Tooltip,\n  Snackbar,\n  Alert,\n  Chip,\n  TextField,\n  InputAdornment,\n  FormControl,\n  Select,\n  MenuItem,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Stack,\n  ToggleButton,\n  ToggleButtonGroup,\n  Divider,\n} from '@mui/material';\nimport { \n  Play, \n  Pencil, \n  Timer,\n  Search,\n  Star,\n  StarOff\n} from 'lucide-react';\n\nimport Layout from '../components/Layout';\nimport CallTestDialog, { CallTestMode } from '../components/CallTestDialog';\nimport { MODULE_CATALOG, ModuleMetadata } from '../data/modules';\nimport { addStoredWorkflow } from '../utils/workflows';\nimport { readSelectedDeviceIds, SELECTED_DEVICES_EVENT } from '../utils/deviceSelection';\nimport { useDevices } from '../hooks/useDevices';\nimport { recordDeviceActivity } from '../utils/deviceActivity';\nimport { CallTestValues } from '../types/callTest';\nimport { resolveBaseUrl } from '../services/utils';\n\ninterface TestModulesProps {\n  backendUrl: string;\n}\n\nconst scriptPath = (file: string) => `adb_scripts/${file}`;\n\ntype SnackbarSeverity = 'success' | 'info' | 'error' | 'warning';\n\nconst CALL_TEST_STORAGE_KEY = 'callTestParams';\nconst GLOBAL_CALL_TEST_KEY = '__global__';\n\nconst CALL_TEST_DEFAULTS: CallTestValues = {\n  countryCode: '+237',\n  phoneNumber: '691234567',\n  duration: 30,\n  callCount: 1,\n};\nconst WAITING_TIME_STORAGE_KEY = 'waitingTimeDurationSeconds';\nconst PING_CONFIG_STORAGE_KEY = 'pingModuleConfig';\nconst WORKFLOW_BUILDER_STORAGE_KEY = 'workflowBuilderDraft';\nconst FAVORITES_STORAGE_KEY = 'moduleFavorites';\nconst RECENTS_STORAGE_KEY = 'moduleRecents';\ninterface PingConfig {\n  target: string;\n  duration: number;\n  interval: number;\n}\n\ninterface PingDialogState {\n  target: string;\n  duration: string;\n  interval: string;\n}\n\ninterface WorkflowBuilderDraftModule {\n  id: string;\n  waitDurationSeconds?: number;\n  callTestParams?: CallTestValues;\n}\n\ninterface WorkflowBuilderDraft {\n  name: string;\n  description: string;\n  showBuilder: boolean;\n  modules: WorkflowBuilderDraftModule[];\n}\n\nconst resolveModuleFailureReason = (payload: unknown): string | undefined => {\n  if (!payload || typeof payload !== 'object') {\n    return undefined;\n  }\n  const candidateError = (payload as Record<string, unknown>).error;\n  if (typeof candidateError === 'string' && candidateError.trim().length > 0) {\n    return candidateError.trim();\n  }\n  const candidateMessage = (payload as Record<string, unknown>).message;\n  if (typeof candidateMessage === 'string' && candidateMessage.trim().length > 0) {\n    return candidateMessage.trim();\n  }\n  const candidateOutput = (payload as Record<string, unknown>).output;\n  if (typeof candidateOutput === 'string' && candidateOutput.trim().length > 0) {\n    return candidateOutput.trim();\n  }\n  return undefined;\n};\n\ntype DeviceModuleResult = {\n  deviceId: string;\n  success: boolean;\n  response?: Record<string, unknown>;\n  error?: string;\n};\n\ntype DeviceModuleRunSnapshot = {\n  moduleId: string;\n  timestamp: string;\n  results: DeviceModuleResult[];\n};\n\nconst resolveApiKey = (): string | null => {\n  const envKey = process.env.REACT_APP_API_KEY || process.env.API_KEY;\n  const stored = typeof window !== 'undefined' ? window.localStorage.getItem('API_KEY') : null;\n  return (stored && stored.trim()) || (envKey && envKey.trim()) || null;\n};\n\nconst authHeaders = () => {\n  const key = resolveApiKey();\n  return key ? { 'X-API-Key': key } : {};\n};\n\nconst createWorkflowInstance = (module: ModuleMetadata): WorkflowModuleInstance => ({\n  instanceId: `${module.id}-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,\n  module,\n});\n\nconst parseDragPayload = (\n  value: string | null\n): { source: 'catalog' | 'builder'; id: string } | null => {\n  if (!value) {\n    return null;\n  }\n  if (value.startsWith('catalog:')) {\n    return { source: 'catalog', id: value.replace('catalog:', '') };\n  }\n  if (value.startsWith('builder:')) {\n    return { source: 'builder', id: value.replace('builder:', '') };\n  }\n  return null;\n};\n\nconst DEFAULT_PING_CONFIG: PingConfig = {\n  target: '8.8.8.8',\n  duration: 10,\n  interval: 1.0,\n};\nconst WAITING_TIME_DEFAULT_DURATION = 5;\nconst WAITING_TIME_MIN_DURATION = 1;\nconst WAITING_TIME_MAX_DURATION = 600;\n\nconst IPV4_SEGMENT = '(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})';\nconst IPV4_REGEX = new RegExp(`^(?:${IPV4_SEGMENT}\\\\.){3}${IPV4_SEGMENT}$`);\nconst HOSTNAME_SEGMENT_REGEX = /^[a-zA-Z0-9-]{1,63}$/;\n\nconst isValidIpv4 = (value: string): boolean => IPV4_REGEX.test(value);\nconst isValidHostnameSegment = (segment: string): boolean =>\n  HOSTNAME_SEGMENT_REGEX.test(segment) && !segment.startsWith('-') && !segment.endsWith('-');\n\nconst isValidHostname = (value: string): boolean => {\n  if (!value || value.length > 253) {\n    return false;\n  }\n  if (value === 'localhost') {\n    return true;\n  }\n  const segments = value.split('.');\n  if (segments.length < 2) {\n    return false;\n  }\n  return segments.every((segment) => isValidHostnameSegment(segment));\n};\n\nconst isValidPingTarget = (value: string): boolean => isValidIpv4(value) || isValidHostname(value);\n\nconst readFavorites = (): Set<string> => {\n  if (typeof window === 'undefined') return new Set();\n  try {\n    const raw = window.localStorage.getItem(FAVORITES_STORAGE_KEY);\n    if (!raw) return new Set();\n    const arr = JSON.parse(raw);\n    return new Set(Array.isArray(arr) ? arr.filter((v) => typeof v === 'string') : []);\n  } catch {\n    return new Set();\n  }\n};\n\nconst persistFavorites = (favorites: Set<string>) => {\n  try {\n    window.localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(Array.from(favorites)));\n  } catch {\n    // ignore\n  }\n};\n\nconst readRecents = (): string[] => {\n  if (typeof window === 'undefined') return [];\n  try {\n    const raw = window.localStorage.getItem(RECENTS_STORAGE_KEY);\n    const arr = raw ? JSON.parse(raw) : [];\n    return Array.isArray(arr) ? arr.filter((v) => typeof v === 'string').slice(0, 8) : [];\n  } catch {\n    return [];\n  }\n};\n\nconst persistRecents = (recents: string[]) => {\n  try {\n    window.localStorage.setItem(RECENTS_STORAGE_KEY, JSON.stringify(recents.slice(0, 8)));\n  } catch {\n    // ignore\n  }\n};\n\nconst CUSTOM_CODE_KEY = 'dialSecretCode';\nconst readStoredCustomCode = (): string => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return '';\n  }\n  return window.localStorage.getItem(CUSTOM_CODE_KEY) || '';\n};\n\nconst persistCustomCode = (value: string) => {\n  try {\n    if (typeof window !== 'undefined' && typeof window.localStorage !== 'undefined') {\n      window.localStorage.setItem(CUSTOM_CODE_KEY, value || '');\n    }\n  } catch {\n    // ignore\n  }\n};\n\nconst validatePingTarget = (raw: string): string | null => {\n  const value = raw.trim();\n  if (!value) {\n    return 'Target is required.';\n  }\n  if (!isValidPingTarget(value)) {\n    return 'Enter a valid IP address or domain (e.g. 8.8.8.8 or example.com).';\n  }\n  return null;\n};\n\nconst PING_TARGET_HELPER_TEXT = 'e.g. 8.8.8.8 or example.com';\n\nconst toPingDraft = (config: PingConfig): PingDialogState => ({\n  target: config.target,\n  duration: String(config.duration),\n  interval: String(config.interval),\n});\n\n\nconst READY_DEVICE_STATUSES = new Set(['connected', 'online', 'busy', 'in_use', 'idle']);\n\nconst isDeviceSelectable = (status?: string | null): boolean => {\n  if (!status || typeof status !== 'string') {\n    return false;\n  }\n  return READY_DEVICE_STATUSES.has(status.toLowerCase());\n};\n\nconst sanitizeCallTestValues = (values: CallTestValues): CallTestValues => {\n  const countryDigits = values.countryCode.replace(/[^0-9]/g, '');\n  const normalizedCountry = countryDigits ? `+${countryDigits}` : CALL_TEST_DEFAULTS.countryCode;\n  const normalizedPhone = values.phoneNumber.replace(/[^0-9]/g, '') || CALL_TEST_DEFAULTS.phoneNumber;\n\n  return {\n    countryCode: normalizedCountry,\n    phoneNumber: normalizedPhone,\n    duration: Math.max(1, Math.min(600, Math.trunc(values.duration))),\n    callCount: Math.max(1, Math.min(10, Math.trunc(values.callCount))),\n  };\n};\n\nconst isStoredCallTestValues = (value: unknown): value is CallTestValues => {\n  if (!value || typeof value !== 'object') {\n    return false;\n  }\n  const candidate = value as Record<string, unknown>;\n  return (\n    typeof candidate.countryCode === 'string' &&\n    typeof candidate.phoneNumber === 'string' &&\n    typeof candidate.duration === 'number' &&\n    typeof candidate.callCount === 'number'\n  );\n};\n\nconst readCallTestStorageMap = (): Record<string, CallTestValues> => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return {};\n  }\n  try {\n    const stored = window.localStorage.getItem(CALL_TEST_STORAGE_KEY);\n    if (!stored) {\n      return {};\n    }\n    const parsed = JSON.parse(stored);\n    if (isStoredCallTestValues(parsed)) {\n      return { [GLOBAL_CALL_TEST_KEY]: sanitizeCallTestValues(parsed) };\n    }\n    if (parsed && typeof parsed === 'object') {\n      const next: Record<string, CallTestValues> = {};\n      Object.entries(parsed as Record<string, unknown>).forEach(([key, value]) => {\n        if (isStoredCallTestValues(value)) {\n          next[key] = sanitizeCallTestValues(value);\n        }\n      });\n      return next;\n    }\n  } catch (error) {\n    console.warn('[CallTest] Failed to load stored parameters map', error);\n  }\n  return {};\n};\n\nconst resolveStoredCallTestValues = (deviceId?: string | null): CallTestValues => {\n  const map = readCallTestStorageMap();\n  if (deviceId && map[deviceId]) {\n    return map[deviceId];\n  }\n  if (map[GLOBAL_CALL_TEST_KEY]) {\n    return map[GLOBAL_CALL_TEST_KEY];\n  }\n  return CALL_TEST_DEFAULTS;\n};\n\nconst DEVICE_MODULE_IDS = new Set([\n  'enable_airplane_mode',\n  'disable_airplane_mode',\n  'ping',\n  'activate_data',\n  'wrong_apn_configuration',\n  'pull_device_logs',\n  'start_rf_logging',\n  'stop_rf_logging',\n  'pull_rf_logs',\n  'dial_secret_code',\n]);\n\nconst sanitizeWaitingTimeDuration = (value: number): number => {\n  if (!Number.isFinite(value)) {\n    return WAITING_TIME_DEFAULT_DURATION;\n  }\n  const rounded = Math.round(value);\n  return Math.min(WAITING_TIME_MAX_DURATION, Math.max(WAITING_TIME_MIN_DURATION, rounded));\n};\n\nconst readStoredPingConfig = (): PingConfig => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return DEFAULT_PING_CONFIG;\n  }\n  try {\n    const raw = window.localStorage.getItem(PING_CONFIG_STORAGE_KEY);\n    if (!raw) {\n      return DEFAULT_PING_CONFIG;\n    }\n    const parsed = JSON.parse(raw);\n    if (\n      typeof parsed?.target === 'string' &&\n      typeof parsed?.duration === 'number' &&\n      typeof parsed?.interval === 'number'\n    ) {\n      return {\n        target: parsed.target || DEFAULT_PING_CONFIG.target,\n        duration: Math.max(1, Math.round(parsed.duration)),\n        interval: Math.min(5, Math.max(0.2, Number(parsed.interval))),\n      };\n    }\n  } catch {\n    // ignore\n  }\n  return DEFAULT_PING_CONFIG;\n};\n\nconst persistPingConfig = (config: PingConfig) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.setItem(PING_CONFIG_STORAGE_KEY, JSON.stringify(config));\n  } catch (error) {\n    console.warn('[PingConfig] Failed to persist configuration', error);\n  }\n};\n\nconst readStoredWaitingTimeDuration = (): number => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return WAITING_TIME_DEFAULT_DURATION;\n  }\n  try {\n    const raw = window.localStorage.getItem(WAITING_TIME_STORAGE_KEY);\n    if (!raw) {\n      return WAITING_TIME_DEFAULT_DURATION;\n    }\n    const parsed = Number(raw);\n    return sanitizeWaitingTimeDuration(parsed);\n  } catch {\n    return WAITING_TIME_DEFAULT_DURATION;\n  }\n};\n\nconst persistWaitingTimeDuration = (value: number) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.setItem(WAITING_TIME_STORAGE_KEY, String(value));\n  } catch (error) {\n    console.warn('[WaitingTime] Failed to persist duration', error);\n  }\n};\n\nconst WRONG_APN_STORAGE_KEY = 'module.wrongApnValue';\nconst DEFAULT_WRONG_APN = 'arnaud';\nconst LOG_PULL_STORAGE_KEY = 'module.logPullDestination';\nconst DEFAULT_LOG_PULL_DESTINATION = 'C:\\\\\\\\Users\\\\\\\\rush\\\\\\\\Documents\\\\\\\\logs';\n\nconst readStoredWrongApn = (): string => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return DEFAULT_WRONG_APN;\n  }\n  try {\n    const raw = window.localStorage.getItem(WRONG_APN_STORAGE_KEY);\n    if (!raw) {\n      return DEFAULT_WRONG_APN;\n    }\n    const value = raw.trim();\n    return value.length > 0 ? value : DEFAULT_WRONG_APN;\n  } catch {\n    return DEFAULT_WRONG_APN;\n  }\n};\n\nconst persistWrongApn = (value: string) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.setItem(WRONG_APN_STORAGE_KEY, value);\n  } catch (error) {\n    console.warn('[WrongAPN] Failed to persist value', error);\n  }\n};\n\nconst readStoredLogDestination = (): string => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return DEFAULT_LOG_PULL_DESTINATION;\n  }\n  try {\n    const raw = window.localStorage.getItem(LOG_PULL_STORAGE_KEY);\n    if (!raw) {\n      return DEFAULT_LOG_PULL_DESTINATION;\n    }\n    const trimmed = raw.trim();\n    return trimmed.length > 0 ? trimmed : DEFAULT_LOG_PULL_DESTINATION;\n  } catch {\n    return DEFAULT_LOG_PULL_DESTINATION;\n  }\n};\n\nconst persistLogDestination = (value: string) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.setItem(LOG_PULL_STORAGE_KEY, value);\n  } catch (error) {\n    console.warn('[LogPull] Failed to persist destination', error);\n  }\n};\n\nconst cloneModuleForBuilderDraft = (module: ModuleMetadata): ModuleMetadata => {\n  let cloned: ModuleMetadata = { ...module };\n  if (module.id === 'waiting_time') {\n    const effectiveDuration =\n      typeof module.waitDurationSeconds === 'number'\n        ? module.waitDurationSeconds\n        : readStoredWaitingTimeDuration();\n    cloned = {\n      ...cloned,\n      waitDurationSeconds: sanitizeWaitingTimeDuration(effectiveDuration),\n    };\n  }\n  if (module.id === 'call_test') {\n    const params = module.callTestParams\n      ? sanitizeCallTestValues(module.callTestParams)\n      : resolveStoredCallTestValues(null);\n    cloned = {\n      ...cloned,\n      callTestParams: { ...params },\n    };\n  }\n  return cloned;\n};\n\ntype WorkflowModuleInstance = {\n  instanceId: string;\n  module: ModuleMetadata;\n};\n\nconst readWorkflowBuilderDraft = (): WorkflowBuilderDraft | null => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return null;\n  }\n  try {\n    const raw = window.localStorage.getItem(WORKFLOW_BUILDER_STORAGE_KEY);\n    if (!raw) {\n      return null;\n    }\n    const parsed = JSON.parse(raw);\n    if (!parsed || typeof parsed !== 'object') {\n      return null;\n    }\n    const modules: WorkflowBuilderDraftModule[] = Array.isArray(parsed.modules)\n      ? parsed.modules\n          .map((entry: any) => {\n            if (!entry || typeof entry.id !== 'string') {\n              return null;\n            }\n            const draftModule: WorkflowBuilderDraftModule = { id: entry.id };\n            if (typeof entry.waitDurationSeconds === 'number') {\n              draftModule.waitDurationSeconds = entry.waitDurationSeconds;\n            }\n            if (isStoredCallTestValues((entry as any).callTestParams)) {\n              draftModule.callTestParams = sanitizeCallTestValues((entry as any).callTestParams);\n            }\n            return draftModule;\n          })\n          .filter((entry): entry is WorkflowBuilderDraftModule => Boolean(entry))\n      : [];\n    return {\n      name: typeof parsed.name === 'string' ? parsed.name : '',\n      description: typeof parsed.description === 'string' ? parsed.description : '',\n      showBuilder: Boolean(parsed.showBuilder),\n      modules,\n    };\n  } catch (error) {\n    console.warn('[WorkflowBuilderDraft] Failed to read draft', error);\n    return null;\n  }\n};\n\nconst persistWorkflowBuilderDraft = (draft: WorkflowBuilderDraft | null) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    if (\n      !draft ||\n      (draft.modules.length === 0 && !draft.showBuilder && !draft.name && !draft.description)\n    ) {\n      window.localStorage.removeItem(WORKFLOW_BUILDER_STORAGE_KEY);\n      return;\n    }\n    window.localStorage.setItem(WORKFLOW_BUILDER_STORAGE_KEY, JSON.stringify(draft));\n  } catch (error) {\n    console.warn('[WorkflowBuilderDraft] Failed to persist draft', error);\n  }\n};\n\nconst hydrateWorkflowBuilderDraft = (draft: WorkflowBuilderDraft): WorkflowModuleInstance[] => {\n  const timestamp = Date.now();\n  return draft.modules\n    .map((entry, index) => {\n      const baseModule = MODULE_CATALOG.find((module) => module.id === entry.id);\n      if (!baseModule) {\n        return null;\n      }\n      let hydrated: ModuleMetadata = { ...baseModule };\n      if (typeof entry.waitDurationSeconds === 'number') {\n        hydrated = { ...hydrated, waitDurationSeconds: entry.waitDurationSeconds };\n      }\n      if (entry.callTestParams) {\n        hydrated = {\n          ...hydrated,\n          callTestParams: sanitizeCallTestValues(entry.callTestParams),\n        };\n      }\n      return {\n        instanceId: `draft-${entry.id}-${timestamp}-${index}-${Math.random().toString(36).slice(2, 6)}`,\n        module: cloneModuleForBuilderDraft(hydrated),\n      };\n    })\n    .filter((entry): entry is WorkflowModuleInstance => Boolean(entry));\n};\n\nconst TestModules: React.FC<TestModulesProps> = ({ backendUrl }) => {\n  const [snackbar, setSnackbar] = useState<{ message: string; severity: SnackbarSeverity }>();\n  const [selectedModules, setSelectedModules] = useState<WorkflowModuleInstance[]>([]);\n  const [showWorkflowBuilder, setShowWorkflowBuilder] = useState(false);\n  const [workflowDraftLoaded, setWorkflowDraftLoaded] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const searchInputRef = React.useRef<HTMLInputElement | null>(null);\n  const [workflowName, setWorkflowName] = useState('');\n\n  const [moduleCategoryFilter, setModuleCategoryFilter] = useState<string>('all');\n  const [workflowDescription, setWorkflowDescription] = useState('');\n  const [favorites, setFavorites] = useState<Set<string>>(() => readFavorites());\n  const [moduleFilterMode, setModuleFilterMode] = useState<'all' | 'favorites' | 'recents'>('all');\n  const [recents, setRecents] = useState<string[]>(() => readRecents());\n  const [showRecents, setShowRecents] = useState(true);\n\n  const [callTestDialogOpen, setCallTestDialogOpen] = useState(false);\n  const [callTestMode, setCallTestMode] = useState<CallTestMode>('run');\n  const [callTestDialogInitialValues, setCallTestDialogInitialValues] = useState<CallTestValues>(CALL_TEST_DEFAULTS);\n  const [currentCallTestDeviceId, setCurrentCallTestDeviceId] = useState<string | null>(null);\n  const [callTestTotalSteps, setCallTestTotalSteps] = useState(0);\n  const [callTestTargets, setCallTestTargets] = useState<string[]>([]);\n  const [callTestStepIndex, setCallTestStepIndex] = useState(0);\n  const [callTestPendingValues, setCallTestPendingValues] = useState<Record<string, CallTestValues>>({});\n  const runResultsRef = React.useRef<{ success: string[]; failure: { deviceId: string; reason: string }[] }>({\n    success: [],\n    failure: [],\n  });\n  const waitingTimeInitialRef = React.useRef(readStoredWaitingTimeDuration());\n  const [waitingTimeDuration, setWaitingTimeDuration] = useState<number>(waitingTimeInitialRef.current);\n  const [waitingTimeDialogOpen, setWaitingTimeDialogOpen] = useState(false);\n  const [waitingTimeDraft, setWaitingTimeDraft] = useState<string>(String(waitingTimeInitialRef.current));\n  const [waitingTimeDialogError, setWaitingTimeDialogError] = useState<string | null>(null);\n  const [pingDialogOpen, setPingDialogOpen] = useState(false);\n  const [pingConfig, setPingConfig] = useState<PingConfig>(() => readStoredPingConfig());\n  const [pingDraft, setPingDraft] = useState<PingDialogState>(() => toPingDraft(readStoredPingConfig()));\n  const [pingDialogError, setPingDialogError] = useState<string | null>(null);\n  const [pingTargetError, setPingTargetError] = useState<string | null>(null);\n  const [pingTargetTouched, setPingTargetTouched] = useState(false);\n  const [selectedDeviceIds, setSelectedDeviceIds] = useState<string[]>(() => readSelectedDeviceIds());\n  const [wrongApnValue, setWrongApnValue] = useState<string>(() => readStoredWrongApn());\n  const [logPullDestination, setLogPullDestination] = useState<string>(() => readStoredLogDestination());\n  const [customCode, setCustomCode] = useState<string>(() => readStoredCustomCode());\n  const [wrongApnDialogOpen, setWrongApnDialogOpen] = useState(false);\n  const [wrongApnDraft, setWrongApnDraft] = useState(wrongApnValue);\n  const [logPullDialogOpen, setLogPullDialogOpen] = useState(false);\n  const [logPullDraft, setLogPullDraft] = useState(logPullDestination);\n  const [logPullDialogError, setLogPullDialogError] = useState<string | null>(null);\n  const [customScriptDialogOpen, setCustomScriptDialogOpen] = useState(false);\n  const [customScriptDraft, setCustomScriptDraft] = useState(customCode);\n  const [customScriptDialogError, setCustomScriptDialogError] = useState<string | null>(null);\n  const [moduleRunStatuses, setModuleRunStatuses] = useState<Record<string, 'idle' | 'running'>>({});\n  const { devices: discoveredDevices, status: devicesStatus } = useDevices({ backendUrl });\n  const readyBackendDeviceIds = useMemo(\n    () =>\n      discoveredDevices\n        .filter((device) => isDeviceSelectable(device.status))\n        .map((device) => device.id),\n    [discoveredDevices]\n  );\n  const readyBackendDeviceSet = useMemo(() => new Set(readyBackendDeviceIds), [readyBackendDeviceIds]);\n  const hasWorkflowDraft =\n    workflowDraftLoaded &&\n    (selectedModules.length > 0 || workflowName.trim().length > 0 || workflowDescription.trim().length > 0);\n  const findModuleById = useCallback(\n    (moduleId: string) => MODULE_CATALOG.find((module) => module.id === moduleId),\n    []\n  );\n\n  useEffect(() => {\n    const draft = readWorkflowBuilderDraft();\n    if (draft) {\n      const hydratedModules = hydrateWorkflowBuilderDraft(draft);\n      if (hydratedModules.length > 0) {\n        setSelectedModules(hydratedModules);\n      }\n      setShowWorkflowBuilder(Boolean(draft.showBuilder));\n      setWorkflowName(draft.name ?? '');\n      setWorkflowDescription(draft.description ?? '');\n    }\n    setWorkflowDraftLoaded(true);\n  }, []);\n  useEffect(() => {\n    const handler = (event: KeyboardEvent) => {\n      if ((event.ctrlKey || event.metaKey) && event.key.toLowerCase() === 'k') {\n        event.preventDefault();\n        searchInputRef.current?.focus();\n      }\n    };\n    window.addEventListener('keydown', handler);\n    return () => window.removeEventListener('keydown', handler);\n  }, []);\n  const liveSelectedDeviceIds = useMemo(\n    () => selectedDeviceIds.filter((deviceId) => readyBackendDeviceSet.has(deviceId)),\n    [readyBackendDeviceSet, selectedDeviceIds]\n  );\n  const hasStaleSelection = selectedDeviceIds.length > 0 && liveSelectedDeviceIds.length === 0;\n  const hasSelectedDevices = liveSelectedDeviceIds.length > 0;\n  const [callTestMap, setCallTestMap] = useState<Record<string, CallTestValues>>({});\n  const selectionReminderVisible =\n    devicesStatus === 'success' && (readyBackendDeviceIds.length === 0 || !hasSelectedDevices);\n  const selectionReminderSeverity =\n    readyBackendDeviceIds.length === 0 ? 'error' : hasStaleSelection ? 'warning' : 'info';\n  const selectionReminderMessage =\n    readyBackendDeviceIds.length === 0\n      ? 'No devices are ready. Connect a phone and mark it active from the Dashboard before running modules.'\n      : hasStaleSelection\n        ? 'The previously selected device is no longer connected. Open the Dashboard to choose another one.'\n        : 'Select an active device from the Dashboard before running modules.';\n  const [draggingModuleId, setDraggingModuleId] = useState<string | null>(null);\n  const [draggingCatalogModuleId, setDraggingCatalogModuleId] = useState<string | null>(null);\n  const [lastDeviceModuleRun, setLastDeviceModuleRun] = useState<DeviceModuleRunSnapshot | null>(null);\n\n  useEffect(() => {\n    const storedIds = readSelectedDeviceIds();\n    setSelectedDeviceIds(storedIds);\n    const handler = (event: Event) => {\n      const detail = (event as CustomEvent<string[]>).detail;\n      if (Array.isArray(detail)) {\n        setSelectedDeviceIds(detail);\n      } else {\n        setSelectedDeviceIds(readSelectedDeviceIds());\n      }\n    };\n    window.addEventListener(SELECTED_DEVICES_EVENT, handler as EventListener);\n    return () => {\n      window.removeEventListener(SELECTED_DEVICES_EVENT, handler as EventListener);\n    };\n  }, []);\n\n  useEffect(() => {\n    persistWrongApn(wrongApnValue);\n  }, [wrongApnValue]);\n\n  useEffect(() => {\n    persistLogDestination(logPullDestination);\n  }, [logPullDestination]);\n\n  useEffect(() => {\n    if (!workflowDraftLoaded) {\n      return;\n    }\n    const shouldPersist =\n      showWorkflowBuilder ||\n      selectedModules.length > 0 ||\n      workflowName.trim().length > 0 ||\n      workflowDescription.trim().length > 0;\n    if (!shouldPersist) {\n      persistWorkflowBuilderDraft(null);\n      return;\n    }\n    persistWorkflowBuilderDraft({\n      name: workflowName,\n      description: workflowDescription,\n      showBuilder: showWorkflowBuilder,\n      modules: selectedModules.map((entry) => {\n        const serialized: WorkflowBuilderDraftModule = { id: entry.module.id };\n        if (typeof entry.module.waitDurationSeconds === 'number') {\n          serialized.waitDurationSeconds = entry.module.waitDurationSeconds;\n        }\n        if (entry.module.callTestParams) {\n          serialized.callTestParams = { ...entry.module.callTestParams };\n        }\n        return serialized;\n      }),\n    });\n  }, [workflowDraftLoaded, showWorkflowBuilder, selectedModules, workflowName, workflowDescription]);\n\n  useEffect(() => {\n    setCallTestMap(readCallTestStorageMap());\n  }, []);\n\n  const updateCallTestMap = useCallback((deviceKey: string, values: CallTestValues) => {\n    const sanitized = sanitizeCallTestValues(values);\n    setCallTestMap((prev) => {\n      const next = { ...prev, [deviceKey]: sanitized };\n      try {\n        localStorage.setItem(CALL_TEST_STORAGE_KEY, JSON.stringify(next));\n      } catch (error) {\n        console.warn('[CallTest] Failed to persist parameters', error);\n      }\n      return next;\n    });\n  }, []);\n\n  const getCallTestValuesForDevice = useCallback(\n    (deviceId?: string | null): CallTestValues => {\n      if (deviceId && callTestMap[deviceId]) {\n        return callTestMap[deviceId];\n      }\n      if (callTestMap[GLOBAL_CALL_TEST_KEY]) {\n        return callTestMap[GLOBAL_CALL_TEST_KEY];\n      }\n      return CALL_TEST_DEFAULTS;\n    },\n    [callTestMap]\n  );\n\n  const executeCallTestForDevice = useCallback(\n    async (deviceId: string, values: CallTestValues) => {\n      const sanitized = sanitizeCallTestValues(values);\n      const fullNumber = `${sanitized.countryCode}${sanitized.phoneNumber}`;\n\n      if (!backendUrl) {\n        throw new Error('Backend unavailable: no URL configured.');\n      }\n\n      const normalizedBackendUrl = backendUrl.replace(/\\/$/, '');\n      try {\n        const response = await fetch(`${normalizedBackendUrl}/api/modules/voice_call_test/execute`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            ...authHeaders(),\n          },\n          body: JSON.stringify({\n            device_id: deviceId,\n            parameters: {\n              number: fullNumber,\n              duration: sanitized.duration,\n              call_count: sanitized.callCount,\n            },\n          }),\n        });\n\n        if (!response.ok) {\n          const text = await response.text();\n          throw new Error(text || `Backend failure (HTTP ${response.status})`);\n        }\n\n        await response.json().catch(() => undefined);\n      } catch (error) {\n        const message =\n          error instanceof Error\n            ? error.message\n            : 'Unknown error while communicating with the backend.';\n        throw new Error(message);\n      }\n\n      if ((window as any).electronAPI?.runScript) {\n        try {\n          (window as any).electronAPI.runScript(scriptPath('call_control.sh'));\n        } catch (ipcError) {\n          console.warn('[CallTest] runScript unavailable', ipcError);\n        }\n      } else {\n        console.info(\n          `Call Test placeholder for ${fullNumber} (device: ${deviceId}) (${sanitized.callCount} call(s) / ${sanitized.duration}s).`\n        );\n      }\n\n      return { sanitized, fullNumber };\n    },\n    [backendUrl]\n  );\n\n  const runCallTestBatch = useCallback(\n    async (targets: string[], overrides: Record<string, CallTestValues> = {}) => {\n      const uniqueTargets = Array.from(new Set(targets));\n      if (uniqueTargets.length === 0) {\n        setSnackbar({\n          severity: 'error',\n          message: 'Select at least one device on the dashboard before launching the Call Test.',\n        });\n        return;\n      }\n\n      const results = await Promise.allSettled(\n        uniqueTargets.map((deviceId) => {\n          const override = overrides[deviceId];\n          const stored =\n            callTestMap[deviceId] ??\n            callTestMap[GLOBAL_CALL_TEST_KEY] ??\n            CALL_TEST_DEFAULTS;\n          const values = override ?? stored;\n          return executeCallTestForDevice(deviceId, values);\n        })\n      );\n\n      const successes: string[] = [];\n      const failures: { deviceId: string; reason: string }[] = [];\n\n      results.forEach((result, index) => {\n        const deviceId = uniqueTargets[index];\n        if (result.status === 'fulfilled') {\n          successes.push(deviceId);\n        } else {\n          const reason =\n            result.reason instanceof Error\n              ? result.reason.message\n              : typeof result.reason === 'string'\n                ? result.reason\n                : 'Execution failed.';\n          failures.push({ deviceId, reason });\n        }\n      });\n\n      if (failures.length === 0) {\n        setSnackbar({\n          severity: 'success',\n          message: `Call Test launched on ${successes.length} device${successes.length === 1 ? '' : 's'}.`,\n        });\n      } else if (successes.length > 0) {\n        const failedList = failures.map((item) => item.deviceId).join(', ');\n        setSnackbar({\n          severity: 'warning',\n          message: `Call Test partially launched. Failed for: ${failedList}.`,\n        });\n      } else {\n        const reasons = failures.map((item) => `${item.deviceId}: ${item.reason}`).join(' | ');\n        setSnackbar({\n          severity: 'error',\n          message: `Call Test failed on all selected devices. ${reasons}`,\n        });\n      }\n\n      runResultsRef.current = { success: successes, failure: failures };\n    },\n    [callTestMap, executeCallTestForDevice]\n  );\n\n  const handleCallTestSubmit = useCallback(\n    async (submitted: CallTestValues) => {\n      const sanitized = sanitizeCallTestValues(submitted);\n      const isLastStep =\n        callTestTotalSteps <= 1 || callTestStepIndex >= callTestTotalSteps - 1;\n\n      if (callTestMode === 'run') {\n        const activeDeviceId = currentCallTestDeviceId;\n        if (!activeDeviceId) {\n          setSnackbar({\n            severity: 'error',\n            message: 'No active device selected for Call Test.',\n          });\n          return;\n        }\n\n        updateCallTestMap(activeDeviceId, sanitized);\n        updateCallTestMap(GLOBAL_CALL_TEST_KEY, sanitized);\n\n        const nextPending = { ...callTestPendingValues, [activeDeviceId]: sanitized };\n        setCallTestPendingValues(nextPending);\n\n        if (!isLastStep) {\n          const nextIndex = callTestStepIndex + 1;\n          const nextDevice = callTestTargets[nextIndex];\n          if (nextDevice) {\n            setCallTestStepIndex(nextIndex);\n            setCurrentCallTestDeviceId(nextDevice);\n            const initialValues = nextPending[nextDevice] ?? getCallTestValuesForDevice(nextDevice);\n            setCallTestDialogInitialValues(initialValues);\n            return;\n          }\n        }\n\n        setCallTestDialogOpen(false);\n        setCurrentCallTestDeviceId(null);\n        setCallTestStepIndex(0);\n        setCallTestTotalSteps(0);\n        const targetsToRun = [...callTestTargets];\n        setCallTestTargets([]);\n        await runCallTestBatch(targetsToRun, nextPending);\n        setCallTestPendingValues({});\n        return;\n      }\n\n      const targetKey = currentCallTestDeviceId ?? GLOBAL_CALL_TEST_KEY;\n      updateCallTestMap(targetKey, sanitized);\n\n      if (!isLastStep) {\n        const nextIndex = callTestStepIndex + 1;\n        const nextDevice = callTestTargets[nextIndex];\n        if (nextDevice) {\n          setCallTestStepIndex(nextIndex);\n          setCurrentCallTestDeviceId(nextDevice);\n          const nextValues = getCallTestValuesForDevice(nextDevice === GLOBAL_CALL_TEST_KEY ? null : nextDevice);\n          setCallTestDialogInitialValues(nextValues);\n          return;\n        }\n      }\n\n      setCallTestDialogOpen(false);\n      setCurrentCallTestDeviceId(null);\n      setCallTestStepIndex(0);\n      setCallTestTotalSteps(0);\n      setCallTestTargets([]);\n      setSnackbar({ severity: 'success', message: 'Call Test parameters saved.' });\n      runResultsRef.current = { success: [], failure: [] };\n    },\n    [\n      callTestMode,\n      callTestTargets,\n      currentCallTestDeviceId,\n      getCallTestValuesForDevice,\n      runCallTestBatch,\n      callTestPendingValues,\n      callTestStepIndex,\n      callTestTotalSteps,\n      updateCallTestMap,\n    ]\n  );\n\n  const handleCallTestPrevious = useCallback(() => {\n    if (callTestStepIndex <= 0) {\n      return;\n    }\n    const prevIndex = callTestStepIndex - 1;\n    const prevDevice = callTestTargets[prevIndex];\n    if (!prevDevice) {\n      return;\n    }\n    setCallTestStepIndex(prevIndex);\n    setCurrentCallTestDeviceId(prevDevice);\n    const initial =\n      callTestPendingValues[prevDevice] ??\n      getCallTestValuesForDevice(prevDevice === GLOBAL_CALL_TEST_KEY ? null : prevDevice);\n    setCallTestDialogInitialValues(initial);\n  }, [callTestStepIndex, callTestTargets, callTestPendingValues, getCallTestValuesForDevice]);\n\n  const moduleCategories = useMemo(() => {\n    const unique = new Set<string>();\n    MODULE_CATALOG.forEach((module) => unique.add(module.category));\n    return ['all', ...Array.from(unique).sort((a, b) => a.localeCompare(b))];\n  }, []);\n  const callTestDialogTarget =\n    currentCallTestDeviceId === GLOBAL_CALL_TEST_KEY ? null : currentCallTestDeviceId;\n\n  const sortedModules = useMemo(() => {\n    const base = MODULE_CATALOG.filter((module) => module.hiddenInModulesPage !== true);\n    return base.sort((a, b) => a.name.localeCompare(b.name));\n  }, []);\n\n  const filteredModules = useMemo(() => {\n    const lowerQuery = searchQuery.toLowerCase();\n    const recencyRank = (id: string) => {\n      const index = recents.indexOf(id);\n      return index === -1 ? Number.MAX_SAFE_INTEGER : index;\n    };\n    const filtered = sortedModules.filter((module) => {\n      const matchesSearch =\n        module.name.toLowerCase().includes(lowerQuery) ||\n        module.description.toLowerCase().includes(lowerQuery);\n      const matchesCategory = moduleCategoryFilter === 'all' || module.category === moduleCategoryFilter;\n      const matchesFavorites = moduleFilterMode !== 'favorites' || favorites.has(module.id);\n      const matchesRecents = moduleFilterMode !== 'recents' || recents.includes(module.id);\n      return matchesSearch && matchesCategory && matchesFavorites && matchesRecents;\n    });\n\n    // Tri : par ordre alphabtique (dj tri dans sortedModules), sauf en mode \"recents\" o l'on trie par recency.\n    if (moduleFilterMode === 'recents') {\n      return [...filtered].sort((a, b) => recencyRank(a.id) - recencyRank(b.id));\n    }\n    return filtered;\n  }, [favorites, moduleCategoryFilter, recents, searchQuery, moduleFilterMode, sortedModules]);\n\n  const resolveRunTargets = useCallback(() => {\n    if (liveSelectedDeviceIds.length > 0) {\n      return liveSelectedDeviceIds;\n    }\n    const fallback = readSelectedDeviceIds();\n    if (fallback.length === 0) {\n      return [];\n    }\n    return fallback.filter((deviceId) => readyBackendDeviceSet.has(deviceId));\n  }, [liveSelectedDeviceIds, readyBackendDeviceSet]);\n\n  const runDeviceModule = useCallback(\n    async (module: ModuleMetadata, options?: { silent?: boolean }) => {\n      const silent = options?.silent === true;\n      const targets = resolveRunTargets();\n      if (targets.length === 0) {\n        setSnackbar({\n          severity: 'error',\n          message: `Select at least one device on the dashboard before running ${module.name}.`,\n        });\n        return;\n      }\n\n      if (!backendUrl) {\n        setSnackbar({\n          severity: 'error',\n          message: 'Backend unavailable: no URL configured.',\n        });\n        return;\n      }\n\n    const normalizedBackendUrl = backendUrl.replace(/\\/$/, '');\n    const sharedParameters: Record<string, any> = {};\n    if (module.id === 'wrong_apn_configuration') {\n        sharedParameters.apn_value = (wrongApnValue || DEFAULT_WRONG_APN).trim() || DEFAULT_WRONG_APN;\n        sharedParameters.use_ui_flow = true;\n      } else if (module.id === 'pull_device_logs' || module.id === 'pull_rf_logs') {\n        const destination = logPullDestination.trim();\n        if (!destination) {\n          setSnackbar({\n            severity: 'error',\n            message: 'Specify a destination path before running the Log Pull module.',\n          });\n          return;\n        }\n        sharedParameters.destination = destination;\n      } else if (module.id === 'dial_secret_code') {\n        const code = customCode.trim();\n        if (!code) {\n          setSnackbar({\n            severity: 'error',\n            message: 'Enter a secret/USSD code before running.',\n          });\n          return;\n        }\n        sharedParameters.code = code;\n      }\n      const successes: string[] = [];\n      const failures: { deviceId: string; reason: string }[] = [];\n      const deviceResults: DeviceModuleResult[] = [];\n      setModuleRunStatuses((prev) => ({ ...prev, [module.id]: 'running' }));\n      try {\n        for (const deviceId of targets) {\n          try {\n            const response = await fetch(`${normalizedBackendUrl}/api/modules/${module.id}/execute`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n                ...authHeaders(),\n              },\n              body: JSON.stringify({\n                device_id: deviceId,\n                parameters: sharedParameters,\n              }),\n            });\n\n            if (!response.ok) {\n              const text = await response.text();\n              throw new Error(text || `Backend failure (HTTP ${response.status})`);\n            }\n\n            const data = await response.json();\n            const success = typeof data.success === 'boolean' ? data.success : true;\n            const failureReason = success ? undefined : resolveModuleFailureReason(data) ?? 'Execution failed.';\n            deviceResults.push({\n              deviceId,\n              success,\n              response: data,\n              ...(failureReason ? { error: failureReason } : {}),\n            });\n            if (success) {\n              successes.push(deviceId);\n            } else {\n              failures.push({ deviceId, reason: failureReason ?? 'Execution failed.' });\n            }\n          } catch (error) {\n            const message =\n              error instanceof Error ? error.message : 'Unknown error while communicating with the backend.';\n            failures.push({ deviceId, reason: message });\n            deviceResults.push({ deviceId, success: false, error: message });\n          }\n        }\n\n        setLastDeviceModuleRun({\n          moduleId: module.id,\n          timestamp: new Date().toISOString(),\n          results: deviceResults,\n        });\n\n        const activityTimestamp = new Date().toISOString();\n        deviceResults.forEach((result) => {\n          recordDeviceActivity({\n            deviceId: result.deviceId,\n            type: 'module',\n            label: module.name,\n            status: result.success ? 'success' : 'failure',\n            referenceId: module.id,\n            details: result.error,\n            timestamp: activityTimestamp,\n          });\n        });\n\n        if (!silent) {\n          const alreadyDevices = deviceResults\n            .filter((item) => {\n              const res = (item.response as any)?.result;\n              return res && (res.already_active || res.already_configured || res.already_on || res.already_off);\n            })\n            .map((item) => item.deviceId);\n\n          if (failures.length === 0) {\n            if (alreadyDevices.length > 0) {\n              setSnackbar({\n                severity: 'info',\n                message: `${module.name}: device already in desired state (${alreadyDevices.join(', ')}).`,\n              });\n            } else {\n              setSnackbar({\n                severity: 'success',\n                message: `${module.name} executed successfully on ${successes.length} device${successes.length === 1 ? '' : 's'}.`,\n              });\n            }\n          } else if (successes.length > 0) {\n            const failedList = failures.map((item) => item.deviceId).join(', ');\n            setSnackbar({\n              severity: 'warning',\n              message: `${module.name} executed on ${successes.length} device${successes.length === 1 ? '' : 's'}. Failed for: ${failedList}.`,\n            });\n          } else {\n            const reasons = failures.map((item) => `${item.deviceId}: ${item.reason}`).join(' | ');\n            setSnackbar({\n              severity: 'error',\n              message: `${module.name} failed on all selected devices. ${reasons}`,\n            });\n          }\n        }\n      } catch (err) {\n        const msg = err instanceof Error ? err.message : 'Unexpected error during module execution.';\n        setSnackbar({ severity: 'error', message: `${module.name} execution aborted: ${msg}` });\n      } finally {\n        setModuleRunStatuses((prev) => {\n          const next = { ...prev };\n          delete next[module.id];\n          return next;\n        });\n      }\n    },\n    [backendUrl, resolveRunTargets, pingConfig, wrongApnValue, logPullDestination]\n  );\n\n  const handleRun = (module: ModuleMetadata) => {\n    setLastDeviceModuleRun(null);\n    if (module.id === 'waiting_time') {\n      setSnackbar({\n        severity: 'info',\n        message: 'Waiting Time is only available inside custom workflows.',\n      });\n      return;\n    }\n    if (module.id === 'call_test') {\n      const targets = resolveRunTargets();\n      if (targets.length === 0) {\n        setSnackbar({\n          severity: 'error',\n          message: 'Select at least one device on the dashboard before running the Call Test.',\n      });\n      return;\n    }\n    runResultsRef.current = { success: [], failure: [] };\n    void runCallTestBatch(targets);\n    return;\n  }\n\n    if (DEVICE_MODULE_IDS.has(module.id)) {\n      runDeviceModule(module, { silent: module.id === 'ping' });\n      return;\n    }\n\n    if ((window as any).electronAPI?.runScript) {\n      (window as any).electronAPI.runScript(scriptPath(module.script));\n      setSnackbar({ message: `Running ${module.name}`, severity: 'success' });\n      return;\n    }\n    console.info(`Run requested for ${module.script}`);\n    setSnackbar({ message: `Run placeholder: ${module.script}`, severity: 'info' });\n  };\n\n  const handleEdit = (module: ModuleMetadata) => {\n    if (module.id === 'call_test') {\n      const sequence = liveSelectedDeviceIds.length > 0 ? liveSelectedDeviceIds : [GLOBAL_CALL_TEST_KEY];\n      setCallTestMode('edit');\n      setCallTestTargets(sequence);\n      setCallTestTotalSteps(sequence.length);\n      setCallTestStepIndex(0);\n      const first = sequence[0];\n      setCurrentCallTestDeviceId(first);\n      setCallTestDialogInitialValues(getCallTestValuesForDevice(first === GLOBAL_CALL_TEST_KEY ? null : first));\n      setCallTestPendingValues({});\n      runResultsRef.current = { success: [], failure: [] };\n      setCallTestDialogOpen(true);\n      return;\n    }\n\n    if (module.id === 'waiting_time') {\n      setWaitingTimeDraft(String(waitingTimeDuration));\n      setWaitingTimeDialogError(null);\n      setWaitingTimeDialogOpen(true);\n      return;\n    }\n\n    if (module.id === 'ping') {\n      setPingDraft(toPingDraft(pingConfig));\n      setPingDialogError(null);\n      setPingTargetError(null);\n      setPingTargetTouched(false);\n      setPingDialogOpen(true);\n      return;\n    }\n\n    if (module.id === 'wrong_apn_configuration') {\n      setWrongApnDraft(wrongApnValue);\n      setWrongApnDialogOpen(true);\n      return;\n    }\n\n    if (module.id === 'pull_device_logs' || module.id === 'pull_rf_logs') {\n      setLogPullDraft(logPullDestination);\n      setLogPullDialogError(null);\n      setLogPullDialogOpen(true);\n      return;\n    }\n\n    if (module.id === 'dial_secret_code') {\n      setCustomScriptDraft(customCode);\n      setCustomScriptDialogError(null);\n      setCustomScriptDialogOpen(true);\n      return;\n    }\n\n    if ((window as any).electronAPI?.openFile) {\n      (window as any).electronAPI.openFile(scriptPath(module.script));\n      setSnackbar({ message: `Opening ${module.name} in editor`, severity: 'success' });\n      return;\n    }\n    setSnackbar({ message: `Script path: ${scriptPath(module.script)}`, severity: 'info' });\n  };\n\n  const insertModuleInstance = useCallback(\n    (module: ModuleMetadata | null, targetId: string | null) => {\n      if (!module) {\n        return;\n      }\n      const instance = createWorkflowInstance(module);\n      setSelectedModules((prev) => {\n        if (targetId) {\n          const targetIndex = prev.findIndex((entry) => entry.instanceId === targetId);\n          if (targetIndex === -1) {\n            return [...prev, instance];\n          }\n          const next = [...prev];\n          next.splice(targetIndex, 0, instance);\n          return next;\n        }\n        return [...prev, instance];\n      });\n      setShowWorkflowBuilder(true);\n    },\n    []\n  );\n\n  const handleAddModule = (module: ModuleMetadata) => {\n    let hydratedModule =\n      module.id === 'waiting_time'\n        ? { ...module, waitDurationSeconds: waitingTimeDuration }\n        : { ...module };\n    if (module.id === 'call_test') {\n      const snapshot = { ...getCallTestValuesForDevice(null) };\n      hydratedModule = {\n        ...hydratedModule,\n        callTestParams: snapshot,\n      };\n    }\n    insertModuleInstance(hydratedModule, null);\n    setSnackbar({ message: `Added ${module.name} to workflow`, severity: 'success' });\n    setRecents((prev) => {\n      const next = [module.id, ...prev.filter((id) => id !== module.id)].slice(0, 8);\n      persistRecents(next);\n      return next;\n    });\n  };\n\n  const handleRemoveModule = (instanceId: string) => {\n    setSelectedModules((prev) => prev.filter((m) => m.instanceId !== instanceId));\n  };\n\n  const closeWaitingTimeDialog = () => {\n    setWaitingTimeDialogOpen(false);\n    setWaitingTimeDialogError(null);\n  };\n\n  const handleWaitingTimeSave = () => {\n    const parsed = Number(waitingTimeDraft);\n    if (!Number.isFinite(parsed)) {\n      setWaitingTimeDialogError('Enter a value between 1 and 600 seconds.');\n      return;\n    }\n    const sanitized = sanitizeWaitingTimeDuration(parsed);\n    setWaitingTimeDuration(sanitized);\n    persistWaitingTimeDuration(sanitized);\n    setWaitingTimeDraft(String(sanitized));\n    setSnackbar({\n      severity: 'success',\n      message: `Waiting time set to ${sanitized} second${sanitized > 1 ? 's' : ''}.`,\n    });\n    closeWaitingTimeDialog();\n  };\n\n  const handleWrongApnClose = () => {\n    setWrongApnDialogOpen(false);\n  };\n\n  const handleWrongApnSave = () => {\n    const sanitized = (wrongApnDraft || '')\n      .trim()\n      .replace(/[^A-Za-z0-9._-]/g, '');\n    const finalValue = sanitized.length > 0 ? sanitized : DEFAULT_WRONG_APN;\n    setWrongApnValue(finalValue);\n    setWrongApnDraft(finalValue);\n    setSnackbar({\n      severity: 'success',\n      message: `Wrong APN value set to \"${finalValue}\".`,\n    });\n    setWrongApnDialogOpen(false);\n  };\n\n  const toggleFavorite = useCallback((moduleId: string) => {\n    setFavorites((prev) => {\n      const next = new Set(prev);\n      if (next.has(moduleId)) {\n        next.delete(moduleId);\n      } else {\n        next.add(moduleId);\n      }\n      persistFavorites(next);\n      return next;\n    });\n  }, []);\n\n  const handleLogPullClose = () => {\n    setLogPullDialogOpen(false);\n    setLogPullDialogError(null);\n  };\n\n  const handleLogPullSave = () => {\n    const trimmed = (logPullDraft || '').trim();\n    if (!trimmed) {\n      setLogPullDialogError('Destination path is required.');\n      return;\n    }\n    setLogPullDestination(trimmed);\n    setSnackbar({\n      severity: 'success',\n      message: `Log pull destination set to \"${trimmed}\".`,\n    });\n    setLogPullDialogError(null);\n    setLogPullDialogOpen(false);\n  };\n\n  const renderPingDetails = (response?: Record<string, unknown>) => {\n    if (!response) {\n      return null;\n    }\n    const packetsTx = typeof response.packets_transmitted === 'number' ? response.packets_transmitted : undefined;\n    const packetsRx = typeof response.packets_received === 'number' ? response.packets_received : undefined;\n    const packetLoss =\n      typeof response.packet_loss_percent === 'number' ? `${response.packet_loss_percent.toFixed(2)}%` : undefined;\n    const rtt = response.rtt && typeof response.rtt === 'object' ? (response.rtt as Record<string, unknown>) : null;\n    const rttSummary =\n      rtt && typeof rtt.avg_ms === 'number'\n        ? `avg ${rtt.avg_ms.toFixed(2)} ms (min ${Number(rtt.min_ms ?? 0).toFixed(2)}  max ${Number(rtt.max_ms ?? 0).toFixed(2)})`\n        : null;\n    return (\n      <Stack spacing={0.5} sx={{ mt: 1 }}>\n        {typeof response.target === 'string' && (\n          <Typography variant=\"body2\" sx={{ color: '#475569' }}>\n            Target: <Box component=\"span\" sx={{ fontWeight: 600 }}>{response.target}</Box>\n          </Typography>\n        )}\n        {(packetsTx !== undefined || packetsRx !== undefined) && (\n          <Typography variant=\"body2\" sx={{ color: '#475569' }}>\n            Packets: {packetsTx ?? ''} sent / {packetsRx ?? ''} received\n          </Typography>\n        )}\n        {packetLoss && (\n          <Typography variant=\"body2\" sx={{ color: '#475569' }}>\n            Packet loss: {packetLoss}\n          </Typography>\n        )}\n        {rttSummary && (\n          <Typography variant=\"body2\" sx={{ color: '#475569' }}>\n            RTT: {rttSummary}\n          </Typography>\n        )}\n      </Stack>\n    );\n  };\n\n  const reorderSelectedModules = (draggedId: string, targetId: string | null) => {\n    if (draggedId === targetId) {\n      return;\n    }\n    setSelectedModules((prev) => {\n      const draggedIndex = prev.findIndex((entry) => entry.instanceId === draggedId);\n      if (draggedIndex === -1) {\n        return prev;\n      }\n      const next = [...prev];\n      const [removed] = next.splice(draggedIndex, 1);\n      if (!targetId) {\n        next.push(removed);\n      } else {\n        const targetIndex = next.findIndex((entry) => entry.instanceId === targetId);\n        if (targetIndex === -1) {\n          return prev;\n        }\n        next.splice(targetIndex, 0, removed);\n      }\n      return next;\n    });\n  };\n\n  const handleModuleDragStart = (event: React.DragEvent<HTMLDivElement>, moduleId: string) => {\n    event.dataTransfer.setData('text/plain', `builder:${moduleId}`);\n    event.dataTransfer.effectAllowed = 'move';\n    setDraggingModuleId(moduleId);\n    setDraggingCatalogModuleId(null);\n  };\n\n  const handleModuleDragOver = (event: React.DragEvent<HTMLDivElement>) => {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleModuleDrop = (event: React.DragEvent<HTMLDivElement>, targetId: string | null) => {\n    event.preventDefault();\n    const payload = parseDragPayload(event.dataTransfer.getData('text/plain'));\n    if (payload?.source === 'builder') {\n      reorderSelectedModules(payload.id, targetId);\n    } else if (payload?.source === 'catalog') {\n      const module = findModuleById(payload.id);\n      insertModuleInstance(module ?? null, targetId);\n    }\n    setDraggingModuleId(null);\n    setDraggingCatalogModuleId(null);\n  };\n\n  const handleModuleDragEnd = () => {\n    setDraggingModuleId(null);\n    setDraggingCatalogModuleId(null);\n  };\n\n  const handleCatalogDragStart = (event: React.DragEvent<HTMLDivElement>, module: ModuleMetadata) => {\n    event.dataTransfer.setData('text/plain', `catalog:${module.id}`);\n    event.dataTransfer.effectAllowed = 'copyMove';\n    setDraggingCatalogModuleId(module.id);\n  };\n\n  const handleCatalogDragEnd = () => {\n    setDraggingCatalogModuleId(null);\n  };\n\n  const handleCatalogAreaDragOver = (event: React.DragEvent<HTMLDivElement>) => {\n    if (draggingModuleId) {\n      event.preventDefault();\n      event.dataTransfer.dropEffect = 'move';\n    }\n  };\n\n  const handleCatalogAreaDrop = (event: React.DragEvent<HTMLDivElement>) => {\n    if (!draggingModuleId) {\n      return;\n    }\n    event.preventDefault();\n    const payload = parseDragPayload(event.dataTransfer.getData('text/plain'));\n    const targetId = payload?.source === 'builder' ? payload.id : draggingModuleId;\n    if (targetId) {\n      handleRemoveModule(targetId);\n    }\n    setDraggingModuleId(null);\n  };\n\n  const handleBuildWorkflow = () => {\n    if (selectedModules.length === 0 || !workflowName.trim()) {\n      setSnackbar({ severity: 'error', message: 'Select modules and provide a workflow name before saving.' });\n      return;\n    }\n\n    addStoredWorkflow({\n      name: workflowName.trim(),\n      description: workflowDescription.trim(),\n      modules: selectedModules.map((item) => item.module),\n    });\n\n    setSnackbar({ message: `Workflow \"${workflowName}\" created with ${selectedModules.length} module(s)`, severity: 'success' });\n    setSelectedModules([]);\n    setShowWorkflowBuilder(false);\n    setWorkflowName('');\n    setWorkflowDescription('');\n  };\n\n  return (\n    <Layout>\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 4, gap: 2 }}>\n        <Typography variant=\"h1\" sx={{\n          fontSize: '28px',\n          lineHeight: '36px',\n          fontWeight: 700,\n          color: '#0F172A'\n        }}>\n          Modules\n        </Typography>\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n          <TextField\n            placeholder=\"Search modules...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            inputRef={searchInputRef}\n            sx={{\n              width: 260,\n              '& .MuiOutlinedInput-root': {\n                height: 40,\n                borderRadius: '10px'\n              }\n            }}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <Search size={20} color=\"#6B7280\" />\n                </InputAdornment>\n              )\n            }}\n          />\n          <FormControl size=\"small\" sx={{ minWidth: 180 }}>\n            <Select\n              value={moduleCategoryFilter}\n              onChange={(event) => setModuleCategoryFilter(event.target.value as string)}\n              displayEmpty\n            >\n              {moduleCategories.map((category) => (\n                <MenuItem key={category} value={category}>\n                  {category === 'all' ? 'All' : category}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n          <ToggleButtonGroup\n            size=\"small\"\n            value={moduleFilterMode}\n            exclusive\n            onChange={(_, value) => value && setModuleFilterMode(value)}\n          >\n            <ToggleButton value=\"favorites\" sx={{ gap: 0.5 }}>\n              <Star size={16} /> Favorites\n            </ToggleButton>\n            <ToggleButton value=\"recents\">Recents</ToggleButton>\n          </ToggleButtonGroup>\n        <Chip\n          label={\n            hasSelectedDevices\n              ? `${liveSelectedDeviceIds.length} active device${liveSelectedDeviceIds.length === 1 ? '' : 's'}`\n              : 'No active device'\n            }\n            size=\"small\"\n            sx={{\n              backgroundColor: '#EEF2FF',\n              color: '#2563EB',\n              fontWeight: 600\n            }}\n          />\n        </Box>\n      </Box>\n\n      {/* Recents chips section removed per request */}\n\n      {!showWorkflowBuilder && hasWorkflowDraft && (\n        <Alert\n          severity=\"info\"\n          sx={{ mb: 3 }}\n          action={\n            <Button\n              color=\"inherit\"\n              size=\"small\"\n              onClick={() => {\n                setShowWorkflowBuilder(true);\n                setSnackbar({ severity: 'info', message: 'Workflow draft restored.' });\n              }}\n              sx={{ textTransform: 'none', fontWeight: 600 }}\n            >\n              Continuer\n            </Button>\n          }\n        >\n          Un workflow en brouillon n&apos;a pas t enregistr. Cliquez sur Continuer pour reprendre l&apos;dition.\n        </Alert>\n      )}\n\n      {selectionReminderVisible && (\n        <Alert severity={selectionReminderSeverity} sx={{ mb: 3 }}>\n          {selectionReminderMessage}\n        </Alert>\n      )}\n\n      {/* Workflow Builder */}\n      {showWorkflowBuilder && (\n        <Card sx={{\n          backgroundColor: '#F8FAFC',\n          border: '2px solid #2563EB',\n          borderRadius: '16px',\n          mb: 4,\n          transition: 'all 0.2s ease-in-out'\n        }}>\n          <CardContent sx={{ padding: '20px 24px' }}>\n            <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n              <Typography variant=\"h6\" sx={{\n                fontSize: '18px',\n                fontWeight: 600,\n                color: '#0F172A'\n              }}>\n                Custom Workflow Builder ({selectedModules.length} modules)\n              </Typography>\n              <Box display=\"flex\" gap={2} alignItems=\"center\">\n                <TextField\n                  placeholder=\"Workflow name\"\n                  value={workflowName}\n                  onChange={(e) => setWorkflowName(e.target.value)}\n                  size=\"small\"\n                  sx={{ width: 200 }}\n                />\n                <TextField\n                  placeholder=\"Description (optional)\"\n                  value={workflowDescription}\n                  onChange={(e) => setWorkflowDescription(e.target.value)}\n                  size=\"small\"\n                  sx={{ width: 260 }}\n                />\n                <Button\n                  variant=\"contained\"\n                  onClick={handleBuildWorkflow}\n                  disabled={selectedModules.length === 0 || !workflowName.trim()}\n                  sx={{\n                    backgroundColor: '#16A34A',\n                    borderRadius: '8px',\n                    textTransform: 'none',\n                    fontWeight: 600,\n                    '&:hover': { backgroundColor: '#15803D' }\n                  }}\n                >\n                  Build Workflow\n                </Button>\n                <Button\n                  variant=\"outlined\"\n                  onClick={() => { setSelectedModules([]); setShowWorkflowBuilder(false); setWorkflowName(''); setWorkflowDescription(''); }}\n                  sx={{\n                    borderColor: '#6B7280',\n                    color: '#6B7280',\n                    borderRadius: '8px',\n                    textTransform: 'none'\n                  }}\n                >\n                  Cancel\n                </Button>\n              </Box>\n            </Box>\n            \n            <Box\n              display=\"flex\"\n              flexWrap=\"wrap\"\n              gap={1}\n              onDragOver={handleModuleDragOver}\n              onDrop={(event) => handleModuleDrop(event, null)}\n              sx={{\n                minHeight: 64,\n                border: draggingCatalogModuleId ? '1px dashed #2563EB' : '1px dashed transparent',\n                borderRadius: '12px',\n                padding: 1,\n                backgroundColor: draggingCatalogModuleId ? '#EEF2FF' : 'transparent',\n                transition: 'border-color 0.2s ease, background-color 0.2s ease',\n              }}\n            >\n              {selectedModules.map((entry, index) => (\n                <Box\n                  key={entry.instanceId}\n                  draggable\n                  onDragStart={(event) => handleModuleDragStart(event, entry.instanceId)}\n                  onDragOver={handleModuleDragOver}\n                  onDrop={(event) => handleModuleDrop(event, entry.instanceId)}\n                  onDragEnd={handleModuleDragEnd}\n                  sx={{ cursor: 'grab', display: 'inline-flex' }}\n                >\n                  <Chip\n                    label={`${index + 1}. ${entry.module.name}`}\n                    onDelete={() => handleRemoveModule(entry.instanceId)}\n                    sx={{\n                      backgroundColor: draggingModuleId === entry.instanceId ? '#DBEAFE' : '#EEF2FF',\n                      color: '#2563EB',\n                      borderRadius: '8px',\n                      border: draggingModuleId === entry.instanceId ? '1px dashed #2563EB' : 'none'\n                    }}\n                  />\n                </Box>\n              ))}\n              {selectedModules.length === 0 && (\n                <Typography sx={{ color: '#6B7280', fontStyle: 'italic' }}>\n                  No modules selected. Click the + button on modules below to add them.\n                </Typography>\n              )}\n            </Box>\n          </CardContent>\n        </Card>\n      )}\n\n      <Box\n        onDragOver={handleCatalogAreaDragOver}\n        onDrop={handleCatalogAreaDrop}\n      >\n      <Grid container spacing={3}>\n        {filteredModules.map((module) => {\n          const moduleRunning = moduleRunStatuses[module.id] === 'running';\n          const isPingRunning = module.id === 'ping' && moduleRunning;\n          const runButtonBackground = isPingRunning ? '#16A34A' : '#2563EB';\n          const runButtonHover = isPingRunning ? '#15803D' : '#1E48C7';\n          return (\n          <Grid item xs={12} sm={6} lg={4} key={module.id}>\n            <Card\n              draggable\n              onDragStart={(event) => handleCatalogDragStart(event, module)}\n              onDragEnd={handleCatalogDragEnd}\n              sx={{\n              backgroundColor: '#FFFFFF',\n              border: draggingCatalogModuleId === module.id ? '1px dashed #2563EB' : '1px solid #E5E7EB',\n              borderRadius: '16px',\n              boxShadow: '0 1px 2px rgba(16, 24, 40, 0.06)',\n              height: '100%',\n              transition: 'all 0.2s',\n              '&:hover': {\n                boxShadow: '0 4px 8px rgba(16, 24, 40, 0.12)'\n              }\n            }}>\n              <CardContent sx={{ padding: '20px 24px' }}>\n                <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"flex-start\" mb={2}>\n                  <Box>\n                    <Typography variant=\"h6\" sx={{ \n                      fontWeight: 600, \n                      color: '#0F172A',\n                      fontSize: '16px',\n                      lineHeight: '24px'\n                    }}>\n                      {module.name}\n                    </Typography>\n                    <Chip\n                      label={module.category}\n                      size=\"small\"\n                      sx={{\n                        mt: 0.5,\n                        backgroundColor: '#E0F2FE',\n                        color: '#0369A1',\n                        fontWeight: 600,\n                        fontSize: '10px'\n                      }}\n                    />\n                  </Box>\n                  <Stack direction=\"row\" spacing={1}>\n                    <IconButton\n                      onClick={() => toggleFavorite(module.id)}\n                      size=\"small\"\n                      sx={{ color: favorites.has(module.id) ? '#F59E0B' : '#94A3B8' }}\n                    >\n                      {favorites.has(module.id) ? <Star size={18} fill=\"#F59E0B\" /> : <StarOff size={18} />}\n                    </IconButton>\n                    <IconButton\n                      onClick={() => handleAddModule(module)}\n                      sx={{\n                        width: 28,\n                        height: 28,\n                        backgroundColor: '#2563EB',\n                        color: '#FFFFFF',\n                        borderRadius: '6px',\n                        '&:hover': {\n                          backgroundColor: '#1E48C7'\n                        }\n                      }}\n                    >\n                      +\n                    </IconButton>\n                  </Stack>\n                </Box>\n\n                <Typography variant=\"body2\" sx={{ \n                  color: '#6B7280', \n                  mb: 2,\n                  fontSize: '14px',\n                  lineHeight: '22px'\n                }}>\n                  {module.description}\n                </Typography>\n\n                <Box display=\"flex\" gap={2} mb={3}>\n                  <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                    <Timer size={16} color=\"#6B7280\" />\n                    <Typography variant=\"caption\" sx={{ \n                      color: '#6B7280',\n                      fontSize: '12px',\n                      lineHeight: '18px',\n                      fontWeight: 500\n                    }}>\n                      30-45s\n                    </Typography>\n                  </Box>\n                </Box>\n\n                <Box display=\"flex\" gap={2}>\n                  <Tooltip title={hasSelectedDevices ? 'Run module' : 'Select at least one device'}>\n                    <span style={{ flex: 1 }}>\n                      <Button\n                        variant=\"contained\"\n                        startIcon={<Play size={16} />}\n                        onClick={() => handleRun(module)}\n                        disabled={!hasSelectedDevices || moduleRunning}\n                        sx={{\n                          width: '100%',\n                          backgroundColor: runButtonBackground,\n                          borderRadius: '8px',\n                          height: 40,\n                          fontWeight: 600,\n                          textTransform: 'none',\n                          fontSize: '14px',\n                          '&:hover': {\n                            backgroundColor: runButtonHover\n                          },\n                          '&.Mui-disabled': {\n                            backgroundColor: '#94A3B8'\n                          }\n                        }}\n                      >\n                        {moduleRunning ? 'Running' : 'Run'}\n                      </Button>\n                    </span>\n                  </Tooltip>\n                  <Tooltip\n                    title={\n                      module.id === 'call_test'\n                        ? 'Edit parameters'\n                        : module.editable\n                          ? 'Edit script'\n                          : 'Not editable'\n                    }\n                  >\n                    <span>\n                      <IconButton\n                        onClick={() => handleEdit(module)}\n                        disabled={!module.editable && module.id !== 'call_test'}\n                        sx={{\n                          backgroundColor: '#F1F5F9',\n                          color: '#475569',\n                          border: '1px solid #E2E8F0',\n                          borderRadius: '8px',\n                          width: 40,\n                          height: 40,\n                          '&:hover': {\n                            backgroundColor: '#E2E8F0'\n                          },\n                          '&.Mui-disabled': {\n                            opacity: 0.4,\n                            borderColor: '#E2E8F0'\n                          }\n                        }}\n                      >\n                        <Pencil size={16} />\n                      </IconButton>\n                    </span>\n                  </Tooltip>\n                </Box>\n              </CardContent>\n            </Card>\n          </Grid>\n        );\n        })}\n      </Grid>\n      </Box>\n\n\n      <Dialog open={waitingTimeDialogOpen} onClose={closeWaitingTimeDialog} fullWidth maxWidth=\"xs\">\n        <DialogTitle>Waiting Time</DialogTitle>\n        <DialogContent>\n          <Typography variant=\"body2\" sx={{ color: '#475569', mb: 2 }}>\n            Define how many seconds to wait between workflow modules.\n          </Typography>\n          <TextField\n            label=\"Duration (seconds)\"\n            type=\"number\"\n            value={waitingTimeDraft}\n            onChange={(event) => {\n              setWaitingTimeDraft(event.target.value);\n              setWaitingTimeDialogError(null);\n            }}\n            fullWidth\n            inputProps={{ min: WAITING_TIME_MIN_DURATION, max: WAITING_TIME_MAX_DURATION }}\n            error={Boolean(waitingTimeDialogError)}\n            helperText={waitingTimeDialogError ?? 'Between 1 and 600 seconds'}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeWaitingTimeDialog} sx={{ textTransform: 'none' }}>\n            Cancel\n          </Button>\n          <Button variant=\"contained\" onClick={handleWaitingTimeSave} sx={{ textTransform: 'none' }}>\n            Save\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog open={pingDialogOpen} onClose={() => setPingDialogOpen(false)} fullWidth maxWidth=\"xs\">\n        <DialogTitle>Ping configuration</DialogTitle>\n        <DialogContent>\n          <Typography variant=\"body2\" sx={{ color: '#475569', mb: 2 }}>\n            Define the target host, duration (seconds), and interval between packets.\n          </Typography>\n          <Stack spacing={2}>\n            <TextField\n              label=\"Target (IP or domain)\"\n              value={pingDraft.target}\n              onChange={(event) => {\n                const nextValue = event.target.value;\n                setPingDraft((prev) => ({ ...prev, target: nextValue }));\n                if (pingTargetTouched) {\n                  setPingTargetError(validatePingTarget(nextValue));\n                }\n                setPingDialogError(null);\n              }}\n              onBlur={() => {\n                setPingTargetTouched(true);\n                setPingTargetError(validatePingTarget(pingDraft.target));\n              }}\n              error={Boolean(pingTargetError)}\n              helperText={pingTargetError ?? PING_TARGET_HELPER_TEXT}\n              fullWidth\n            />\n            <TextField\n              label=\"Duration (seconds)\"\n              type=\"number\"\n              value={pingDraft.duration}\n              onChange={(event) => {\n                setPingDraft((prev) => ({ ...prev, duration: event.target.value }));\n                setPingDialogError(null);\n              }}\n              inputProps={{ min: 1, max: 600 }}\n              fullWidth\n            />\n            <TextField\n              label=\"Interval (seconds)\"\n              type=\"number\"\n              value={pingDraft.interval}\n              onChange={(event) => {\n                setPingDraft((prev) => ({ ...prev, interval: event.target.value }));\n                setPingDialogError(null);\n              }}\n              inputProps={{ min: 0.2, max: 5, step: 0.1 }}\n              fullWidth\n            />\n            {pingDialogError ? <Alert severity=\"error\">{pingDialogError}</Alert> : null}\n          </Stack>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setPingDialogOpen(false)} sx={{ textTransform: 'none' }}>\n            Cancel\n          </Button>\n          <Button\n            variant=\"contained\"\n            sx={{ textTransform: 'none' }}\n            onClick={() => {\n              const targetError = validatePingTarget(pingDraft.target);\n              setPingTargetTouched(true);\n              setPingTargetError(targetError);\n              if (targetError) {\n                setPingDialogError(null);\n                return;\n              }\n              const durationValue = Number.parseFloat(pingDraft.duration);\n              if (!Number.isFinite(durationValue) || durationValue < 1) {\n                setPingDialogError('Duration must be a positive number.');\n                return;\n              }\n              const intervalValue = Number.parseFloat(pingDraft.interval);\n              if (!Number.isFinite(intervalValue) || intervalValue < 0.2) {\n                setPingDialogError('Interval must be at least 0.2 seconds.');\n                return;\n              }\n              const sanitized: PingConfig = {\n                target: pingDraft.target.trim(),\n                duration: Math.max(1, Math.round(durationValue)),\n                interval: Math.min(5, Math.max(0.2, intervalValue)),\n              };\n              setPingConfig(sanitized);\n              persistPingConfig(sanitized);\n              setPingDraft(toPingDraft(sanitized));\n              setPingDialogError(null);\n              setPingTargetError(null);\n              setPingTargetTouched(false);\n              setPingDialogOpen(false);\n              setSnackbar({ severity: 'success', message: 'Ping configuration saved.' });\n            }}\n          >\n            Save\n          </Button>\n      </DialogActions>\n    </Dialog>\n\n      <Dialog open={wrongApnDialogOpen} onClose={handleWrongApnClose} fullWidth maxWidth=\"xs\">\n        <DialogTitle>Wrong APN Configuration</DialogTitle>\n        <DialogContent>\n          <TextField\n            margin=\"dense\"\n            label=\"Wrong APN value\"\n            fullWidth\n            value={wrongApnDraft}\n            onChange={(event) => setWrongApnDraft(event.target.value)}\n            helperText='Used by the \"Wrong APN Configuration\" module (default \"arnaud\").'\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleWrongApnClose}>Cancel</Button>\n          <Button variant=\"contained\" onClick={handleWrongApnSave}>\n            Save\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog open={logPullDialogOpen} onClose={handleLogPullClose} fullWidth maxWidth=\"sm\">\n        <DialogTitle>Log Pull Destination</DialogTitle>\n        <DialogContent>\n          <TextField\n            margin=\"dense\"\n            label=\"Log pull destination (PC path)\"\n            fullWidth\n            value={logPullDraft}\n            onChange={(event) => setLogPullDraft(event.target.value)}\n            error={Boolean(logPullDialogError)}\n            helperText={logPullDialogError || 'Directory where /sdcard/log content will be copied (per device subfolder).'}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleLogPullClose}>Cancel</Button>\n          <Button variant=\"contained\" onClick={handleLogPullSave}>\n            Save\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog open={customScriptDialogOpen} onClose={() => setCustomScriptDialogOpen(false)} fullWidth maxWidth=\"sm\">\n        <DialogTitle>Dial Secret/USSD Code</DialogTitle>\n        <DialogContent>\n          <TextField\n            margin=\"dense\"\n            label=\"Code to dial (e.g., *#9900#)\"\n            fullWidth\n            value={customScriptDraft}\n            onChange={(event) => setCustomScriptDraft(event.target.value)}\n            error={Boolean(customScriptDialogError)}\n            helperText={\n              customScriptDialogError ||\n              'Only digits, * and # are supported; the code will be typed then CALL sent.'\n            }\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setCustomScriptDialogOpen(false)}>Cancel</Button>\n          <Button\n            variant=\"contained\"\n            onClick={() => {\n              const trimmed = (customScriptDraft || '').trim();\n              if (!trimmed) {\n                setCustomScriptDialogError('Enter a code to dial.');\n                return;\n              }\n              setCustomCode(trimmed);\n              persistCustomCode(trimmed);\n              setCustomScriptDialogError(null);\n              setCustomScriptDialogOpen(false);\n              setSnackbar({ severity: 'success', message: 'Code saved.' });\n            }}\n          >\n            Save\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <CallTestDialog\n        open={callTestDialogOpen}\n        mode={callTestMode}\n        initialValues={callTestDialogInitialValues}\n        targetDeviceId={callTestDialogTarget}\n        stepIndex={callTestTotalSteps === 0 ? undefined : callTestStepIndex + 1}\n        totalSteps={callTestTotalSteps}\n        canGoBack={callTestStepIndex > 0}\n        onPrevious={handleCallTestPrevious}\n        onCancel={() => {\n          setCallTestDialogOpen(false);\n          setCurrentCallTestDeviceId(null);\n          setCallTestStepIndex(0);\n          setCallTestTotalSteps(0);\n          setCallTestTargets([]);\n          setCallTestPendingValues({});\n          runResultsRef.current = { success: [], failure: [] };\n          if (callTestMode === 'run') {\n            setSnackbar({ severity: 'info', message: 'Call Test cancelled.' });\n          }\n        }}\n        onSubmit={handleCallTestSubmit}\n      />\n\n      <Snackbar\n        open={Boolean(snackbar)}\n        autoHideDuration={3500}\n        onClose={() => setSnackbar(undefined)}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\n      >\n        {snackbar ? (\n          <Alert \n            severity={snackbar.severity} \n            onClose={() => setSnackbar(undefined)} \n            sx={{ \n              borderRadius: '8px'\n            }}\n          >\n            {snackbar.message}\n          </Alert>\n        ) : null}\n      </Snackbar>\n    </Layout>\n  );\n};\n\nexport default TestModules;\n"],"names":["SELECTED_DEVICES_STORAGE_KEY","LEGACY_SELECTED_DEVICE_KEY","SELECTED_DEVICES_EVENT","normalizeIds","value","Array","isArray","filter","id","trim","length","parsed","JSON","parse","_unused","trimmed","readSelectedDeviceIds","window","localStorage","stored","getItem","ids","from","Set","legacy","legacyIds","writeSelectedDeviceIds","removeItem","error","console","warn","uniqueIds","setItem","stringify","dispatchEvent","CustomEvent","detail","toggleSelectedDeviceId","deviceId","set","has","delete","add","Pencil","createLucideIcon","d","key","Star","StarOff","x1","x2","y1","y2","Timer","cx","cy","r","_ref","_errors$countryCode","_errors$phoneNumber","_errors$duration","_errors$callCount","open","mode","initialValues","targetDeviceId","stepIndex","totalSteps","onCancel","onSubmit","canGoBack","onPrevious","formState","setFormState","useState","countryCode","phoneNumber","duration","String","callCount","errors","setErrors","submitting","setSubmitting","useEffect","isLastStep","deviceLabel","stepLabel","concat","undefined","dialogTitle","useMemo","primaryButtonLabel","handleChange","field","event","prev","_objectSpread","target","_jsxs","Dialog","onClose","fullWidth","maxWidth","children","_jsx","DialogTitle","DialogContent","Typography","variant","sx","color","mb","Grid","container","spacing","item","xs","sm","TextField","label","onChange","placeholder","Boolean","helperText","disabled","inputProps","maxLength","type","min","max","Box","mt","backgroundColor","borderRadius","padding","DialogActions","Button","onClick","textTransform","async","hasErrors","values","validate","validationErrors","normalizedCountryCode","digits","replace","sanitizeCountryCode","test","normalizedPhone","durationValue","parseInt","Number","isNaN","callCountValue","Object","keys","scriptPath","file","CALL_TEST_STORAGE_KEY","GLOBAL_CALL_TEST_KEY","CALL_TEST_DEFAULTS","WAITING_TIME_STORAGE_KEY","PING_CONFIG_STORAGE_KEY","WORKFLOW_BUILDER_STORAGE_KEY","FAVORITES_STORAGE_KEY","RECENTS_STORAGE_KEY","resolveModuleFailureReason","payload","candidateError","candidateMessage","message","candidateOutput","output","authHeaders","resolveApiKey","envKey","process","REACT_APP_API_KEY","API_KEY","parseDragPayload","startsWith","source","DEFAULT_PING_CONFIG","interval","IPV4_SEGMENT","IPV4_REGEX","RegExp","HOSTNAME_SEGMENT_REGEX","isValidHostname","segments","split","every","segment","endsWith","isValidHostnameSegment","isValidPingTarget","isValidIpv4","CUSTOM_CODE_KEY","validatePingTarget","raw","toPingDraft","config","READY_DEVICE_STATUSES","sanitizeCallTestValues","countryDigits","Math","trunc","isStoredCallTestValues","candidate","readCallTestStorageMap","next","entries","forEach","DEVICE_MODULE_IDS","sanitizeWaitingTimeDuration","isFinite","rounded","round","readStoredPingConfig","_unused6","readStoredWaitingTimeDuration","_unused7","WRONG_APN_STORAGE_KEY","DEFAULT_WRONG_APN","LOG_PULL_STORAGE_KEY","DEFAULT_LOG_PULL_DESTINATION","cloneModuleForBuilderDraft","module","cloned","effectiveDuration","waitDurationSeconds","params","callTestParams","map","resolveStoredCallTestValues","persistWorkflowBuilderDraft","draft","modules","showBuilder","name","description","_ref2","backendUrl","snackbar","setSnackbar","selectedModules","setSelectedModules","showWorkflowBuilder","setShowWorkflowBuilder","workflowDraftLoaded","setWorkflowDraftLoaded","searchQuery","setSearchQuery","searchInputRef","React","workflowName","setWorkflowName","moduleCategoryFilter","setModuleCategoryFilter","workflowDescription","setWorkflowDescription","favorites","setFavorites","readFavorites","arr","v","moduleFilterMode","setModuleFilterMode","recents","setRecents","readRecents","slice","_unused3","showRecents","setShowRecents","callTestDialogOpen","setCallTestDialogOpen","callTestMode","setCallTestMode","callTestDialogInitialValues","setCallTestDialogInitialValues","currentCallTestDeviceId","setCurrentCallTestDeviceId","callTestTotalSteps","setCallTestTotalSteps","callTestTargets","setCallTestTargets","callTestStepIndex","setCallTestStepIndex","callTestPendingValues","setCallTestPendingValues","runResultsRef","success","failure","waitingTimeInitialRef","waitingTimeDuration","setWaitingTimeDuration","current","waitingTimeDialogOpen","setWaitingTimeDialogOpen","waitingTimeDraft","setWaitingTimeDraft","waitingTimeDialogError","setWaitingTimeDialogError","pingDialogOpen","setPingDialogOpen","pingConfig","setPingConfig","pingDraft","setPingDraft","pingDialogError","setPingDialogError","pingTargetError","setPingTargetError","pingTargetTouched","setPingTargetTouched","selectedDeviceIds","setSelectedDeviceIds","wrongApnValue","setWrongApnValue","readStoredWrongApn","_unused8","logPullDestination","setLogPullDestination","readStoredLogDestination","_unused9","customCode","setCustomCode","wrongApnDialogOpen","setWrongApnDialogOpen","wrongApnDraft","setWrongApnDraft","logPullDialogOpen","setLogPullDialogOpen","logPullDraft","setLogPullDraft","logPullDialogError","setLogPullDialogError","customScriptDialogOpen","setCustomScriptDialogOpen","customScriptDraft","setCustomScriptDraft","customScriptDialogError","setCustomScriptDialogError","moduleRunStatuses","setModuleRunStatuses","devices","discoveredDevices","status","devicesStatus","useDevices","readyBackendDeviceIds","device","isDeviceSelectable","toLowerCase","readyBackendDeviceSet","hasWorkflowDraft","findModuleById","useCallback","moduleId","MODULE_CATALOG","find","readWorkflowBuilderDraft","entry","draftModule","_draft$name","_draft$description","hydratedModules","timestamp","Date","now","index","baseModule","hydrated","instanceId","random","toString","hydrateWorkflowBuilderDraft","handler","_searchInputRef$curre","ctrlKey","metaKey","preventDefault","focus","addEventListener","removeEventListener","liveSelectedDeviceIds","hasStaleSelection","hasSelectedDevices","callTestMap","setCallTestMap","selectionReminderVisible","selectionReminderSeverity","selectionReminderMessage","draggingModuleId","setDraggingModuleId","draggingCatalogModuleId","setDraggingCatalogModuleId","lastDeviceModuleRun","setLastDeviceModuleRun","storedIds","persistWrongApn","persistLogDestination","serialized","updateCallTestMap","deviceKey","sanitized","getCallTestValuesForDevice","executeCallTestForDevice","_electronAPI","fullNumber","Error","normalizedBackendUrl","response","fetch","method","headers","body","device_id","parameters","number","call_count","ok","text","json","catch","electronAPI","runScript","ipcError","info","runCallTestBatch","targets","overrides","arguments","uniqueTargets","severity","results","Promise","allSettled","_ref3","_callTestMap$deviceId","override","successes","failures","result","push","reason","failedList","join","reasons","handleCallTestSubmit","submitted","activeDeviceId","nextPending","nextIndex","nextDevice","_nextPending$nextDevi","targetsToRun","nextValues","handleCallTestPrevious","_callTestPendingValue","prevIndex","prevDevice","initial","moduleCategories","unique","category","sort","a","b","localeCompare","callTestDialogTarget","sortedModules","hiddenInModulesPage","filteredModules","lowerQuery","recencyRank","indexOf","MAX_SAFE_INTEGER","filtered","matchesSearch","includes","matchesCategory","matchesFavorites","matchesRecents","resolveRunTargets","fallback","runDeviceModule","options","silent","sharedParameters","apn_value","use_ui_flow","destination","code","deviceResults","_resolveModuleFailure","data","failureReason","toISOString","activityTimestamp","recordDeviceActivity","referenceId","details","alreadyDevices","_item$response","res","already_active","already_configured","already_on","already_off","err","msg","insertModuleInstance","targetId","instance","createWorkflowInstance","targetIndex","findIndex","splice","handleAddModule","hydratedModule","snapshot","_unused4","persistRecents","handleRemoveModule","m","closeWaitingTimeDialog","handleWrongApnClose","toggleFavorite","_unused2","persistFavorites","handleLogPullClose","handleModuleDragOver","dataTransfer","dropEffect","handleModuleDrop","getData","reorderSelectedModules","draggedId","draggedIndex","removed","handleModuleDragEnd","handleCatalogDragEnd","Layout","display","justifyContent","alignItems","gap","fontSize","lineHeight","fontWeight","e","inputRef","width","height","InputProps","startAdornment","InputAdornment","position","Search","size","FormControl","minWidth","Select","displayEmpty","MenuItem","ToggleButtonGroup","exclusive","_","ToggleButton","Chip","Alert","action","Card","border","transition","CardContent","handleBuildWorkflow","addStoredWorkflow","borderColor","flexWrap","onDragOver","onDrop","minHeight","draggable","onDragStart","handleModuleDragStart","setData","effectAllowed","onDragEnd","cursor","onDelete","fontStyle","moduleRunning","isPingRunning","runButtonBackground","runButtonHover","lg","handleCatalogDragStart","boxShadow","Stack","direction","IconButton","fill","Tooltip","title","style","flex","startIcon","Play","_electronAPI2","script","handleRun","editable","_electronAPI3","sequence","first","openFile","handleEdit","opacity","handleWaitingTimeSave","persistWaitingTimeDuration","nextValue","onBlur","step","targetError","parseFloat","intervalValue","persistPingConfig","margin","handleWrongApnSave","finalValue","handleLogPullSave","_unused5","persistCustomCode","CallTestDialog","Snackbar","autoHideDuration","anchorOrigin","vertical","horizontal"],"sourceRoot":""}