{"version":3,"file":"static/js/408.c15829ff.chunk.js","mappings":"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","sources":["utils/deviceMetadata.ts","pages/DeviceManager.tsx","utils/deviceRegistry.ts"],"sourcesContent":["export const DEVICE_METADATA_STORAGE_KEY = 'deviceManagerMetadata';\nexport const DEVICE_METADATA_EVENT = 'deviceMetadataUpdated';\n\nexport interface DeviceChecklistItem {\n  id: string;\n  label: string;\n  done: boolean;\n}\n\nexport interface DeviceMetadata {\n  alias?: string;\n  tags?: string[];\n  notes?: string;\n  pinned?: boolean;\n  checklist?: DeviceChecklistItem[];\n}\n\nexport type DeviceMetadataMap = Record<string, DeviceMetadata>;\n\nconst sanitizeTags = (tags?: unknown): string[] => {\n  if (!Array.isArray(tags)) {\n    return [];\n  }\n  return tags\n    .filter((tag): tag is string => typeof tag === 'string')\n    .map((tag) => tag.trim())\n    .filter((tag) => tag.length > 0);\n};\n\nconst defaultChecklist: DeviceChecklistItem[] = [\n  { id: 'drivers', label: 'Drivers installed', done: false },\n  { id: 'usb_debugging', label: 'USB debugging enabled', done: false },\n  { id: 'sim_ready', label: 'SIM ready', done: false },\n];\n\nconst sanitizeChecklist = (checklist?: unknown): DeviceChecklistItem[] => {\n  if (!Array.isArray(checklist)) {\n    return defaultChecklist.map((item) => ({ ...item }));\n  }\n  return defaultChecklist.map((item) => {\n    const existing = checklist.find(\n      (entry): entry is DeviceChecklistItem =>\n        entry && typeof entry === 'object' && (entry as DeviceChecklistItem).id === item.id\n    );\n    if (existing) {\n      return {\n        id: existing.id,\n        label: typeof existing.label === 'string' ? existing.label : item.label,\n        done: Boolean(existing.done),\n      };\n    }\n    return { ...item };\n  });\n};\n\nexport const normalizeDeviceMetadata = (meta?: DeviceMetadata | null): DeviceMetadata => ({\n  alias: typeof meta?.alias === 'string' ? meta.alias : '',\n  tags: sanitizeTags(meta?.tags),\n  notes: typeof meta?.notes === 'string' ? meta.notes : '',\n  pinned: Boolean(meta?.pinned),\n  checklist: sanitizeChecklist(meta?.checklist),\n});\n\nexport const DEFAULT_DEVICE_METADATA: DeviceMetadata = normalizeDeviceMetadata();\n\nexport const readDeviceMetadata = (): DeviceMetadataMap => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return {};\n  }\n  try {\n    const raw = window.localStorage.getItem(DEVICE_METADATA_STORAGE_KEY);\n    if (!raw) {\n      return {};\n    }\n    const parsed = JSON.parse(raw);\n    if (!parsed || typeof parsed !== 'object') {\n      return {};\n    }\n    const next: DeviceMetadataMap = {};\n    Object.entries(parsed as Record<string, DeviceMetadata>).forEach(([deviceId, meta]) => {\n      next[deviceId] = normalizeDeviceMetadata(meta);\n    });\n    return next;\n  } catch (error) {\n    console.warn('[deviceMetadata] Failed to read metadata', error);\n    return {};\n  }\n};\n\nexport const writeDeviceMetadata = (metadata: DeviceMetadataMap): void => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.setItem(DEVICE_METADATA_STORAGE_KEY, JSON.stringify(metadata));\n    window.dispatchEvent(new Event(DEVICE_METADATA_EVENT));\n  } catch (error) {\n    console.warn('[deviceMetadata] Failed to persist metadata', error);\n  }\n};\n\nexport const readDeviceAliasMap = (): Record<string, string> => {\n  const metadata = readDeviceMetadata();\n  const aliasMap: Record<string, string> = {};\n  Object.entries(metadata).forEach(([deviceId, meta]) => {\n    const alias = meta.alias?.trim();\n    if (alias) {\n      aliasMap[deviceId] = alias;\n    }\n  });\n  return aliasMap;\n};\n","import React, { useState, useEffect, useMemo } from 'react';\nimport {\n  Box,\n  Typography,\n  Button,\n  TextField,\n  InputAdornment,\n  Card,\n  CardContent,\n  Grid,\n  Chip,\n  IconButton,\n  Tooltip,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Stack,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Table,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableBody,\n  Checkbox,\n  FormControl,\n  Select,\n  MenuItem,\n  Divider,\n  ToggleButtonGroup,\n  ToggleButton,\n  ButtonGroup,\n} from '@mui/material';\nimport {\n  Search,\n  RefreshCw,\n  Smartphone,\n  Info,\n  Play,\n  Tag,\n  Bookmark,\n  BookmarkCheck,\n  RotateCcw,\n  Power,\n  FileText,\n  NotebookPen,\n  GitBranch,\n  Square,\n  CheckSquare,\n} from 'lucide-react';\n\nimport Layout from '../components/Layout';\nimport { useDevices } from '../hooks/useDevices';\nimport { Device } from '@types';\nimport {\n  readDeviceRegistry,\n  syncDevicesToRegistry,\n  DEVICE_REGISTRY_EVENT,\n  DEVICE_REGISTRY_STORAGE_KEY,\n  DeviceRegistryEntry,\n} from '../utils/deviceRegistry';\nimport { resolveBaseUrl } from '../services/utils';\nimport {\n  getAllDeviceActivities,\n  getDeviceActivity,\n  DEVICE_ACTIVITY_EVENT,\n  DEVICE_ACTIVITY_STORAGE_KEY,\n  DeviceActivityEntry,\n} from '../utils/deviceActivity';\nimport {\n  DeviceMetadata,\n  DeviceMetadataMap,\n  DEFAULT_DEVICE_METADATA,\n  normalizeDeviceMetadata,\n  readDeviceMetadata,\n  writeDeviceMetadata,\n} from '../utils/deviceMetadata';\n\ninterface DeviceManagerProps {\n  backendUrl: string;\n}\n\ntype ManagedDevice = Device & {\n  __historical?: boolean;\n  __registry?: DeviceRegistryEntry | null;\n};\n\nconst normalizeStatusValue = (status?: string | null): string =>\n  status ? status.toLowerCase() : 'unknown';\n\nconst formatTimestamp = (value?: string | null) => {\n  if (!value) {\n    return 'Unknown';\n  }\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) {\n    return 'Unknown';\n  }\n  return date.toLocaleString();\n};\n\nconst isWithinRange = (timestamp: string | null | undefined, range: 'any' | '24h' | '7d' | '30d'): boolean => {\n  if (range === 'any') {\n    return true;\n  }\n  if (!timestamp) {\n    return false;\n  }\n  const date = new Date(timestamp);\n  if (Number.isNaN(date.getTime())) {\n    return false;\n  }\n  const diff = Date.now() - date.getTime();\n  const dayMs = 24 * 60 * 60 * 1000;\n  if (range === '24h') {\n    return diff <= dayMs;\n  }\n  if (range === '7d') {\n    return diff <= 7 * dayMs;\n  }\n  return diff <= 30 * dayMs;\n};\n\nconst DeviceManager: React.FC<DeviceManagerProps> = ({ backendUrl }) => {\n  const { devices, status, refresh, applyDevicePatch } = useDevices({ backendUrl, pollMs: 5000 });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [metadata, setMetadata] = useState<DeviceMetadataMap>(() => readDeviceMetadata());\n  const [tagInputs, setTagInputs] = useState<Record<string, string>>({});\n  const [registryVersion, setRegistryVersion] = useState(0);\n  const [activityVersion, setActivityVersion] = useState(0);\n  const [activityDialog, setActivityDialog] = useState<{ deviceId: string; name: string } | null>(null);\n  const [activityDialogEvents, setActivityDialogEvents] = useState<DeviceActivityEntry[]>([]);\n  const [viewMode, setViewMode] = useState<'cards' | 'table'>('cards');\n  const [selectedDeviceIds, setSelectedDeviceIds] = useState<Set<string>>(new Set());\n  const [filterStatus, setFilterStatus] = useState<string>('all');\n  const [filterTag, setFilterTag] = useState<string>('all');\n  const [filterHasHistory, setFilterHasHistory] = useState<'all' | 'historical' | 'live'>('all');\n  const [filterDateRange, setFilterDateRange] = useState<'any' | '24h' | '7d' | '30d'>('any');\n  const [notesDrafts, setNotesDrafts] = useState<Record<string, string>>({});\n  const [exportStart, setExportStart] = useState<string>('');\n  const [exportEnd, setExportEnd] = useState<string>('');\n  const [historySearch, setHistorySearch] = useState('');\n  const [historyTagFilter, setHistoryTagFilter] = useState<string>('all');\n  const [historyPage, setHistoryPage] = useState(0);\n  const historyPageSize = 10;\n\n  const getStatusColor = (status?: string) => {\n    const normalized = normalizeStatusValue(status);\n    switch (normalized) {\n      case 'connected':\n        return { bg: '#EEF2FF', color: '#2563EB' };\n      case 'online':\n        return { bg: '#ECFDF5', color: '#16A34A' };\n      case 'offline':\n        return { bg: '#FEF2F2', color: '#DC2626' };\n      case 'busy':\n        return { bg: '#FEF3C7', color: '#B45309' };\n      default:\n        return { bg: '#F1F5F9', color: '#64748B' };\n    }\n  };\n\n  const handleDeviceAction = async (deviceId: string, action: string) => {\n    try {\n      const optimisticMap: Record<string, Partial<Device>> = {\n        disconnect: { status: 'disconnecting' },\n        reboot: { status: 'restarting' },\n        test: { status: 'testing' },\n        logs: { status: 'collecting_logs' },\n      };\n      const patch = optimisticMap[action];\n      if (patch) {\n        applyDevicePatch(deviceId, {\n          ...patch,\n          last_seen: new Date().toISOString(),\n        });\n      }\n      const response = await fetch(`${backendUrl}/api/v1/devices/${deviceId}/${action}`, {\n        method: 'POST',\n      });\n      if (response.ok) {\n        refresh();\n      }\n    } catch (error) {\n      console.error(`Error ${action} device:`, error);\n    }\n  };\n\n  useEffect(() => {\n    writeDeviceMetadata(metadata);\n  }, [metadata]);\n\n  useEffect(() => {\n    const handleRegistryUpdate = () => setRegistryVersion((prev) => prev + 1);\n    const handleStorage = (event: StorageEvent) => {\n      if (event.key === DEVICE_REGISTRY_STORAGE_KEY) {\n        handleRegistryUpdate();\n      }\n    };\n    window.addEventListener(DEVICE_REGISTRY_EVENT, handleRegistryUpdate);\n    window.addEventListener('storage', handleStorage);\n    return () => {\n      window.removeEventListener(DEVICE_REGISTRY_EVENT, handleRegistryUpdate);\n      window.removeEventListener('storage', handleStorage);\n    };\n  }, []);\n\n  useEffect(() => {\n    const handleActivityUpdate = () => setActivityVersion((prev) => prev + 1);\n    const handleStorage = (event: StorageEvent) => {\n      if (event.key === DEVICE_ACTIVITY_STORAGE_KEY) {\n        handleActivityUpdate();\n      }\n    };\n    window.addEventListener(DEVICE_ACTIVITY_EVENT, handleActivityUpdate);\n    window.addEventListener('storage', handleStorage);\n    return () => {\n      window.removeEventListener(DEVICE_ACTIVITY_EVENT, handleActivityUpdate);\n      window.removeEventListener('storage', handleStorage);\n    };\n  }, []);\n\n  useEffect(() => {\n    syncDevicesToRegistry(devices);\n  }, [devices]);\n\n  const updateDeviceMetadata = (\n    deviceId: string,\n    patch: Partial<DeviceMetadata> | ((current: DeviceMetadata) => Partial<DeviceMetadata>)\n  ) => {\n    setMetadata((prev) => {\n      const current = normalizeDeviceMetadata(prev[deviceId] ?? DEFAULT_DEVICE_METADATA);\n      const resolvedPatch = typeof patch === 'function' ? patch(current) : patch;\n      const next = normalizeDeviceMetadata({ ...current, ...resolvedPatch });\n      return {\n        ...prev,\n        [deviceId]: next,\n      };\n    });\n  };\n\n  const handleAliasChange = (deviceId: string, value: string) => {\n    updateDeviceMetadata(deviceId, { alias: value });\n  };\n\n  const handleAddTag = (deviceId: string) => {\n    const value = (tagInputs[deviceId] ?? '').trim();\n    if (!value) {\n      return;\n    }\n    updateDeviceMetadata(deviceId, (current) => ({\n      tags: current.tags.includes(value) ? current.tags : [...current.tags, value],\n    }));\n    setTagInputs((prev) => ({ ...prev, [deviceId]: '' }));\n  };\n\n  const handleRemoveTag = (deviceId: string, tag: string) => {\n    updateDeviceMetadata(deviceId, (current) => ({\n      tags: current.tags.filter((existing) => existing !== tag),\n    }));\n  };\n\n  const handleTagInputChange = (deviceId: string, value: string) => {\n    setTagInputs((prev) => ({ ...prev, [deviceId]: value }));\n  };\n\n  const togglePin = (deviceId: string) => {\n    updateDeviceMetadata(deviceId, (current) => ({ pinned: !current.pinned }));\n  };\n\n  const openActivityDialog = (device: ManagedDevice) => {\n    const alias = metadata[device.id]?.alias?.trim();\n    const name = alias || device.model || device.id;\n    setActivityDialog({ deviceId: device.id, name });\n    setActivityDialogEvents(getDeviceActivity(device.id));\n  };\n\n  const closeActivityDialog = () => {\n    setActivityDialog(null);\n    setActivityDialogEvents([]);\n  };\n\n  const toggleManagedDeviceSelection = (deviceId: string, checked: boolean) => {\n    setSelectedDeviceIds((prev) => {\n      const next = new Set(prev);\n      if (checked) {\n        next.add(deviceId);\n      } else {\n        next.delete(deviceId);\n      }\n      return next;\n    });\n  };\n\n  const toggleSelectAllFiltered = (checked: boolean, devicesSubset: ManagedDevice[]) => {\n    if (checked) {\n      setSelectedDeviceIds((prev) => {\n        const next = new Set(prev);\n        devicesSubset.forEach((device) => next.add(device.id));\n        return next;\n      });\n    } else {\n      setSelectedDeviceIds((prev) => {\n        const next = new Set(prev);\n        devicesSubset.forEach((device) => next.delete(device.id));\n        return next;\n      });\n    }\n  };\n\n  const clearSelection = () => setSelectedDeviceIds(new Set());\n\n  const handleBulkAction = async (action: 'disconnect' | 'reboot' | 'logs' | 'pin' | 'unpin') => {\n    const ids = Array.from(selectedDeviceIds);\n    if (ids.length === 0) {\n      return;\n    }\n    if (action === 'pin' || action === 'unpin') {\n      ids.forEach((deviceId) => updateDeviceMetadata(deviceId, { pinned: action === 'pin' }));\n      return;\n    }\n    await Promise.all(ids.map((deviceId) => handleDeviceAction(deviceId, action).catch(() => null)));\n    clearSelection();\n  };\n\n  const handleNotesChange = (deviceId: string, value: string) => {\n    setNotesDrafts((prev) => ({ ...prev, [deviceId]: value }));\n  };\n\n  const persistNotes = (deviceId: string) => {\n    const value = notesDrafts[deviceId];\n    updateDeviceMetadata(deviceId, { notes: value ?? '' });\n    setNotesDrafts((prev) => {\n      const next = { ...prev };\n      delete next[deviceId];\n      return next;\n    });\n  };\n\n  const toggleChecklistItem = (deviceId: string, itemId: string) => {\n    updateDeviceMetadata(deviceId, (current) => {\n      const checklist = current.checklist ?? [];\n      const nextChecklist = checklist.map((item) =>\n        item.id === itemId ? { ...item, done: !item.done } : item\n      );\n      return { checklist: nextChecklist };\n    });\n  };\n\n  const registryEntries = useMemo(() => readDeviceRegistry(), [registryVersion]);\n  const activityMap = useMemo(() => getAllDeviceActivities(), [activityVersion]);\n\n  const managedDevices = useMemo<ManagedDevice[]>(() => {\n    const map = new Map<string, ManagedDevice>();\n    devices.forEach((device) => {\n      map.set(device.id, {\n        ...device,\n        __historical: false,\n        __registry: registryEntries[device.id] ?? null,\n      });\n    });\n    Object.values(registryEntries).forEach((entry) => {\n        if (!map.has(entry.id)) {\n        map.set(entry.id, {\n          id: entry.id,\n          model: entry.model ?? 'Unknown Device',\n          connection_type: entry.connectionType,\n          status: 'offline',\n          last_seen: entry.lastSeen,\n          __historical: true,\n          __registry: entry,\n        } as ManagedDevice);\n      }\n    });\n    return Array.from(map.values()).sort((a, b) => {\n      const aHistorical = a.__historical ? 1 : 0;\n      const bHistorical = b.__historical ? 1 : 0;\n      if (aHistorical !== bHistorical) {\n        return aHistorical - bHistorical;\n      }\n      const aTime = a.last_seen || a.__registry?.lastSeen || '';\n      const bTime = b.last_seen || b.__registry?.lastSeen || '';\n      return (bTime || '').localeCompare(aTime || '');\n    });\n  }, [devices, registryEntries]);\n\n  const allTags = useMemo(() => {\n    const set = new Set<string>();\n    Object.values(metadata).forEach((meta) => meta?.tags?.forEach((tag) => set.add(tag)));\n    return Array.from(set).sort((a, b) => a.localeCompare(b));\n  }, [metadata]);\n\n  const filteredDevices = useMemo(() => {\n    const query = searchQuery.trim().toLowerCase();\n    return managedDevices.filter((device) => {\n      const meta = metadata[device.id];\n      const registryMeta = (device as ManagedDevice).__registry;\n      const haystack = [\n        device.model,\n        device.id,\n        device.os_version,\n        meta?.alias,\n        ...(meta?.tags ?? []),\n        registryMeta?.model,\n      ]\n        .filter(Boolean)\n        .join(' ')\n        .toLowerCase();\n      const matchesSearch = !query || haystack.includes(query);\n      if (!matchesSearch) {\n        return false;\n      }\n      if (\n        filterStatus !== 'all' &&\n        normalizeStatusValue(device.status) !== filterStatus &&\n        !(filterStatus === 'offline' && normalizeStatusValue(device.status) === 'unknown')\n      ) {\n        return false;\n      }\n      if (filterTag !== 'all' && !meta?.tags?.includes(filterTag)) {\n        return false;\n      }\n      if (filterHasHistory === 'historical' && !device.__historical) {\n        return false;\n      }\n      if (filterHasHistory === 'live' && device.__historical) {\n        return false;\n      }\n      if (!isWithinRange(device.last_seen || registryMeta?.lastSeen, filterDateRange)) {\n        return false;\n      }\n      return true;\n    });\n  }, [managedDevices, metadata, searchQuery, filterStatus, filterTag, filterHasHistory, filterDateRange]);\n\n  const pinnedDevices = useMemo(\n    () => managedDevices.filter((device) => metadata[device.id]?.pinned),\n    [managedDevices, metadata]\n  );\n\n  const tagUsage = useMemo(() => {\n    const counts: Record<string, number> = {};\n    Object.values(metadata).forEach((meta) => {\n      meta?.tags?.forEach((tag) => {\n        counts[tag] = (counts[tag] || 0) + 1;\n      });\n    });\n    return Object.entries(counts)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 5);\n  }, [metadata]);\n\n  const recentActivity = useMemo(() => {\n    const entries: Array<DeviceActivityEntry & { deviceId: string }> = [];\n    Object.entries(activityMap).forEach(([deviceId, events]) => {\n      events.slice(0, 3).forEach((event) => entries.push({ ...event, deviceId }));\n    });\n    return entries.sort((a, b) => (b.timestamp || '').localeCompare(a.timestamp || '')).slice(0, 5);\n  }, [activityMap]);\n\n  const filteredHistoryEvents = useMemo(() => {\n    let list = activityDialogEvents;\n    if (historySearch.trim()) {\n      const q = historySearch.toLowerCase();\n      list = list.filter((evt) => {\n        const hay = [evt.label, evt.referenceId, evt.details]\n          .filter(Boolean)\n          .join(' ')\n          .toLowerCase();\n        return hay.includes(q);\n      });\n    }\n    if (historyTagFilter !== 'all') {\n      const tags = metadata[activityDialog?.deviceId || '']?.tags || [];\n      if (!tags.includes(historyTagFilter)) {\n        list = [];\n      }\n    }\n    return list;\n  }, [activityDialog?.deviceId, activityDialogEvents, historySearch, historyTagFilter, metadata]);\n\n  const pagedHistoryEvents = useMemo(() => {\n    const start = historyPage * historyPageSize;\n    return filteredHistoryEvents.slice(start, start + historyPageSize);\n  }, [filteredHistoryEvents, historyPage, historyPageSize]);\n\n  const usageAnalytics = useMemo(() => {\n    let workflowCount = 0;\n    let moduleCount = 0;\n    const deviceFrequency: Record<string, number> = {};\n    Object.entries(activityMap).forEach(([deviceId, events]) => {\n      events.forEach((event) => {\n        if (event.type === 'workflow') {\n          workflowCount += 1;\n        } else {\n          moduleCount += 1;\n        }\n      });\n      deviceFrequency[deviceId] = events.length;\n    });\n    const mostActiveDeviceId = Object.entries(deviceFrequency).sort((a, b) => b[1] - a[1])[0]?.[0];\n    const mostActiveDevice =\n      mostActiveDeviceId &&\n      (metadata[mostActiveDeviceId]?.alias ||\n        managedDevices.find((device) => device.id === mostActiveDeviceId)?.model ||\n        mostActiveDeviceId);\n    return {\n      workflowCount,\n      moduleCount,\n      mostActiveDevice,\n    };\n  }, [activityMap, metadata, managedDevices]);\n\n  const handleViewModeChange = (_event: React.MouseEvent<HTMLElement>, next: 'cards' | 'table' | null) => {\n    if (next) {\n      setViewMode(next);\n    }\n  };\n\n  const selectionCount = selectedDeviceIds.size;\n  const allFilteredSelected =\n    filteredDevices.length > 0 && filteredDevices.every((device) => selectedDeviceIds.has(device.id));\n\n  const statusOptions = [\n    { value: 'all', label: 'All statuses' },\n    { value: 'connected', label: 'Connected' },\n    { value: 'online', label: 'Online' },\n    { value: 'busy', label: 'Busy' },\n    { value: 'offline', label: 'Offline' },\n  ];\n\n  const historyOptions: Array<{ value: 'all' | 'live' | 'historical'; label: string }> = [\n    { value: 'all', label: 'All devices' },\n    { value: 'live', label: 'Live only' },\n    { value: 'historical', label: 'History only' },\n  ];\n\n  const dateRangeOptions = [\n    { value: 'any', label: 'Any time' },\n    { value: '24h', label: 'Last 24h' },\n    { value: '7d', label: 'Last 7 days' },\n    { value: '30d', label: 'Last 30 days' },\n  ];\n\n  const renderChecklist = (deviceId: string, checklist?: DeviceMetadata['checklist']) => {\n    if (!checklist || checklist.length === 0) {\n      return null;\n    }\n    return (\n      <Stack direction=\"row\" spacing={1} flexWrap=\"wrap\" sx={{ mb: 2 }}>\n        {checklist.map((item) => (\n          <Chip\n            key={`${deviceId}-${item.id}`}\n            label={item.label}\n            icon={item.done ? <CheckSquare size={12} /> : <Square size={12} />}\n            onClick={() => toggleChecklistItem(deviceId, item.id)}\n            sx={{\n              backgroundColor: item.done ? '#DCFCE7' : '#F1F5F9',\n              color: item.done ? '#15803D' : '#475569',\n              '& .MuiChip-icon': {\n                color: item.done ? '#15803D' : '#94A3B8',\n              },\n            }}\n          />\n        ))}\n      </Stack>\n    );\n  };\n\n  const renderDeviceCard = (device: ManagedDevice) => {\n    const registryMeta = device.__registry;\n    const isHistorical = device.__historical === true;\n    const deviceMeta = metadata[device.id] ?? DEFAULT_DEVICE_METADATA;\n    const alias = deviceMeta.alias?.trim();\n    const displayName = alias || device.model || registryMeta?.model || 'Unknown Device';\n    const deviceTags = deviceMeta.tags ?? [];\n    const tagInputValue = tagInputs[device.id] ?? '';\n    const isPinned = Boolean(deviceMeta.pinned);\n    const lastSeenDisplay = device.last_seen || registryMeta?.lastSeen || registryMeta?.firstSeen || null;\n    const connectionLabel = device.connection_type || registryMeta?.connectionType || 'Unknown';\n    const statusStyle = isHistorical ? { bg: '#F3F4F6', color: '#6B7280' } : getStatusColor(device.status);\n    const activityEntries = (activityMap[device.id] ?? []).slice(0, 3);\n    const moduleRuns = activityEntries.filter((entry) => entry.type === 'module').length;\n    const workflowRuns = activityEntries.filter((entry) => entry.type === 'workflow').length;\n    const hasActivity = (activityMap[device.id] ?? []).length > 0;\n    const notesValue = notesDrafts[device.id] ?? deviceMeta.notes ?? '';\n\n    return (\n      <Grid item xs={12} md={6} key={device.id}>\n        <Card\n          sx={{\n            backgroundColor: '#F8FAFC',\n            border: selectedDeviceIds.has(device.id) ? '2px solid #2563EB' : '1px solid #E5E7EB',\n            borderRadius: '12px',\n            transition: 'all 0.2s',\n            '&:hover': {\n              boxShadow: '0 4px 8px rgba(16, 24, 40, 0.12)',\n              borderColor: '#2563EB',\n            },\n          }}\n        >\n          <CardContent sx={{ padding: '20px' }}>\n            <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"flex-start\" mb={2}>\n              <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                <Checkbox\n                  checked={selectedDeviceIds.has(device.id)}\n                  onChange={(event) => toggleManagedDeviceSelection(device.id, event.target.checked)}\n                />\n                <Chip\n                  label={isHistorical ? 'History' : device.status || 'Unknown'}\n                  size=\"small\"\n                  sx={{\n                    backgroundColor: statusStyle.bg,\n                    color: statusStyle.color,\n                    fontWeight: 600,\n                    textTransform: 'capitalize',\n                  }}\n                />\n              </Box>\n              <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n                <Tooltip title={isPinned ? 'Unpin device' : 'Pin device'}>\n                  <IconButton\n                    size=\"small\"\n                    onClick={() => togglePin(device.id)}\n                    sx={{\n                      backgroundColor: isPinned ? '#FFE4E6' : '#F1F5F9',\n                      color: isPinned ? '#BE123C' : '#475569',\n                      width: 32,\n                      height: 32,\n                    }}\n                  >\n                    {isPinned ? <BookmarkCheck size={16} /> : <Bookmark size={16} />}\n                  </IconButton>\n                </Tooltip>\n                <Tooltip title={hasActivity ? 'View timeline' : 'No activity yet'}>\n                  <span>\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => openActivityDialog(device)}\n                      disabled={!hasActivity}\n                      sx={{ width: 32, height: 32 }}\n                    >\n                      <NotebookPen size={16} />\n                    </IconButton>\n                  </span>\n                </Tooltip>\n              </Stack>\n            </Box>\n            <Box display=\"flex\" alignItems=\"center\" gap={2} mb={2}>\n              <Box\n                sx={{\n                  backgroundColor: statusStyle.bg,\n                  borderRadius: '12px',\n                  p: 1.5,\n                  color: statusStyle.color,\n                }}\n              >\n                <Smartphone size={24} />\n              </Box>\n              <Box>\n                <Typography variant=\"h6\" sx={{ fontSize: '16px', fontWeight: 700, color: '#0F172A' }}>\n                  {displayName}\n                </Typography>\n                <Typography variant=\"body2\" sx={{ color: '#6B7280', fontSize: '12px' }}>\n                  {device.model && device.model !== displayName ? `${device.model}  ` : ''}\n                  {device.id}\n                </Typography>\n              </Box>\n            </Box>\n            <Box display=\"flex\" alignItems=\"center\" gap={1.5} sx={{ mb: 2 }}>\n              <Info size={16} color=\"#6B7280\" />\n              <Typography variant=\"caption\" sx={{ color: '#6B7280', fontSize: '12px' }}>\n                Android {device.os_version || 'Unknown'}\n              </Typography>\n            </Box>\n            <TextField\n              size=\"small\"\n              label=\"Alias\"\n              fullWidth\n              value={deviceMeta.alias ?? ''}\n              onChange={(e) => handleAliasChange(device.id, e.target.value)}\n              sx={{ mb: 1.5 }}\n            />\n            <Stack direction=\"row\" spacing={1} flexWrap=\"wrap\" sx={{ mb: 1 }}>\n              {deviceTags.length === 0 ? (\n                <Typography variant=\"caption\" sx={{ color: '#94A3B8' }}>\n                  No tags yet\n                </Typography>\n              ) : (\n                deviceTags.map((tag) => (\n                  <Chip\n                    key={`${device.id}-${tag}`}\n                    label={`#${tag}`}\n                    size=\"small\"\n                    onDelete={() => handleRemoveTag(device.id, tag)}\n                    sx={{ backgroundColor: '#E0E7FF', color: '#1E3A8A' }}\n                  />\n                ))\n              )}\n            </Stack>\n            <TextField\n              size=\"small\"\n              placeholder=\"Add tag (enter)\"\n              value={tagInputValue}\n              onChange={(e) => handleTagInputChange(device.id, e.target.value)}\n              onKeyDown={(event) => {\n                if (event.key === 'Enter') {\n                  event.preventDefault();\n                  handleAddTag(device.id);\n                }\n              }}\n              InputProps={{\n                endAdornment: (\n                  <InputAdornment position=\"end\">\n                    <IconButton size=\"small\" onClick={() => handleAddTag(device.id)}>\n                      <Tag size={14} />\n                    </IconButton>\n                  </InputAdornment>\n                ),\n              }}\n              sx={{ mb: 2 }}\n            />\n            {renderChecklist(device.id, deviceMeta.checklist)}\n            <TextField\n              label=\"Notes\"\n              size=\"small\"\n              fullWidth\n              multiline\n              minRows={2}\n              value={notesValue}\n              onChange={(event) => handleNotesChange(device.id, event.target.value)}\n              onBlur={() => persistNotes(device.id)}\n              sx={{ mb: 2 }}\n            />\n            <Typography variant=\"caption\" sx={{ color: '#6B7280', fontSize: '12px' }}>\n              Last seen: {formatTimestamp(lastSeenDisplay)}  Connection: {connectionLabel}\n            </Typography>\n            <Typography variant=\"caption\" sx={{ color: '#475569', fontSize: '12px', display: 'block', mb: 2 }}>\n              {workflowRuns} workflow{workflowRuns === 1 ? '' : 's'}  {moduleRuns} module{moduleRuns === 1 ? '' : 's'}\n              {activityEntries[0]?.timestamp ? `  Last activity: ${formatTimestamp(activityEntries[0].timestamp)}` : ''}\n            </Typography>\n            <Stack direction=\"row\" spacing={1} justifyContent=\"space-between\" alignItems=\"center\">\n              <Stack direction=\"row\" spacing={1}>\n                <Tooltip title={isHistorical ? 'Unavailable for historical devices' : 'Disconnect from ADB'}>\n                  <span>\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => handleDeviceAction(device.id, 'disconnect')}\n                      disabled={isHistorical}\n                      sx={{\n                        backgroundColor: '#FFF7ED',\n                        color: '#C2410C',\n                        width: 32,\n                        height: 32,\n                        opacity: isHistorical ? 0.5 : 1,\n                      }}\n                    >\n                      <Power size={16} />\n                    </IconButton>\n                  </span>\n                </Tooltip>\n                <Tooltip title={isHistorical ? 'Unavailable for historical devices' : 'Reboot device'}>\n                  <span>\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => handleDeviceAction(device.id, 'reboot')}\n                      disabled={isHistorical}\n                      sx={{\n                        backgroundColor: '#E0F2FE',\n                        color: '#0369A1',\n                        width: 32,\n                        height: 32,\n                        opacity: isHistorical ? 0.5 : 1,\n                      }}\n                    >\n                      <RotateCcw size={16} />\n                    </IconButton>\n                  </span>\n                </Tooltip>\n                <Tooltip title={isHistorical ? 'Unavailable for historical devices' : 'Capture logs'}>\n                  <span>\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => handleDeviceAction(device.id, 'logs')}\n                      disabled={isHistorical}\n                      sx={{\n                        backgroundColor: '#EEF2FF',\n                        color: '#4338CA',\n                        width: 32,\n                        height: 32,\n                        opacity: isHistorical ? 0.5 : 1,\n                      }}\n                    >\n                      <FileText size={16} />\n                    </IconButton>\n                  </span>\n                </Tooltip>\n              </Stack>\n              <Stack direction=\"row\" spacing={1}>\n                <Tooltip title=\"Device Info\">\n                  <IconButton\n                    size=\"small\"\n                    sx={{\n                      backgroundColor: '#F1F5F9',\n                      color: '#475569',\n                      width: 32,\n                      height: 32,\n                    }}\n                  >\n                    <Info size={16} />\n                  </IconButton>\n                </Tooltip>\n                <Tooltip title={isHistorical ? 'Unavailable for historical devices' : 'Run quick test'}>\n                  <span>\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => handleDeviceAction(device.id, 'test')}\n                      disabled={isHistorical}\n                      sx={{\n                        backgroundColor: '#2563EB',\n                        color: 'white',\n                        width: 32,\n                        height: 32,\n                        opacity: isHistorical ? 0.5 : 1,\n                      }}\n                    >\n                      <Play size={16} />\n                    </IconButton>\n                  </span>\n                </Tooltip>\n              </Stack>\n            </Stack>\n          </CardContent>\n        </Card>\n      </Grid>\n    );\n  };\n\n  const renderTableView = () => (\n    <Box>\n      <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n        <Checkbox\n          checked={allFilteredSelected}\n          indeterminate={selectedDeviceIds.size > 0 && !allFilteredSelected}\n          onChange={(event) => toggleSelectAllFiltered(event.target.checked, filteredDevices)}\n        />\n        <Typography sx={{ color: '#475569', fontSize: '14px' }}>Select all</Typography>\n      </Box>\n      <Table size=\"small\">\n        <TableHead>\n          <TableRow>\n            <TableCell padding=\"checkbox\" />\n            <TableCell>Device</TableCell>\n            <TableCell>Status</TableCell>\n            <TableCell>Last seen</TableCell>\n            <TableCell>Tags</TableCell>\n            <TableCell align=\"right\">Workflows</TableCell>\n            <TableCell align=\"right\">Modules</TableCell>\n            <TableCell align=\"right\">Timeline</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {filteredDevices.map((device) => {\n            const managedDevice = device as ManagedDevice;\n            const registryMeta = managedDevice.__registry;\n            const isHistorical = managedDevice.__historical === true;\n            const deviceMeta = metadata[device.id] ?? DEFAULT_DEVICE_METADATA;\n            const alias = deviceMeta.alias?.trim();\n            const displayName = alias || device.model || registryMeta?.model || device.id;\n            const statusStyle = isHistorical ? { bg: '#F3F4F6', color: '#6B7280' } : getStatusColor(device.status);\n            const activityEntries = activityMap[device.id] ?? [];\n            const moduleRuns = activityEntries.filter((entry) => entry.type === 'module').length;\n            const workflowRuns = activityEntries.filter((entry) => entry.type === 'workflow').length;\n            const hasActivity = activityEntries.length > 0;\n            return (\n              <TableRow key={`${device.id}-table`}>\n                <TableCell padding=\"checkbox\">\n                  <Checkbox\n                    checked={selectedDeviceIds.has(device.id)}\n                    onChange={(event) => toggleManagedDeviceSelection(device.id, event.target.checked)}\n                  />\n                </TableCell>\n                <TableCell>\n                  <Typography sx={{ fontWeight: 600, color: '#0F172A' }}>{displayName}</Typography>\n                  <Typography sx={{ fontSize: '12px', color: '#6B7280' }}>{device.id}</Typography>\n                </TableCell>\n                <TableCell>\n                  <Chip\n                    label={isHistorical ? 'History' : device.status || 'Unknown'}\n                    size=\"small\"\n                    sx={{\n                      backgroundColor: statusStyle.bg,\n                      color: statusStyle.color,\n                      fontWeight: 600,\n                      textTransform: 'capitalize',\n                    }}\n                  />\n                </TableCell>\n                <TableCell>{formatTimestamp(device.last_seen || registryMeta?.lastSeen)}</TableCell>\n                <TableCell>\n                  {(deviceMeta.tags ?? []).length === 0\n                    ? ''\n                    : (deviceMeta.tags ?? []).map((tag) => `#${tag}`).join(', ')}\n                </TableCell>\n                <TableCell align=\"right\">{workflowRuns}</TableCell>\n                <TableCell align=\"right\">{moduleRuns}</TableCell>\n                <TableCell align=\"right\">\n                  <Tooltip title={hasActivity ? 'View activity history' : 'No activity yet'}>\n                    <span>\n                      <IconButton\n                        size=\"small\"\n                        onClick={() => openActivityDialog(managedDevice)}\n                        disabled={!hasActivity}\n                      >\n                        <NotebookPen size={16} />\n                      </IconButton>\n                    </span>\n                  </Tooltip>\n                </TableCell>\n              </TableRow>\n            );\n          })}\n        </TableBody>\n      </Table>\n    </Box>\n  );\n\n  return (\n    <Layout>\n      <Box\n        sx={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          mb: 4,\n        }}\n      >\n        <Typography variant=\"h1\" sx={{ fontSize: '28px', lineHeight: '36px', fontWeight: 700, color: '#0F172A' }}>\n          Device Manager\n        </Typography>\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n          <TextField\n            placeholder=\"Search devices...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            sx={{\n              width: 280,\n              '& .MuiOutlinedInput-root': {\n                height: 40,\n                borderRadius: '10px',\n              },\n            }}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <Search size={20} color=\"#6B7280\" />\n                </InputAdornment>\n              ),\n            }}\n          />\n          <Button\n            variant=\"contained\"\n            startIcon={<RefreshCw size={20} />}\n            onClick={refresh}\n            sx={{\n              height: 40,\n              borderRadius: '10px',\n              backgroundColor: '#2563EB',\n              textTransform: 'none',\n              fontWeight: 600,\n            }}\n          >\n            Scan Devices\n          </Button>\n        </Box>\n      </Box>\n\n      <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 2, mb: 3 }}>\n        <FormControl size=\"small\" sx={{ minWidth: 150 }}>\n          <Select value={filterStatus} onChange={(event) => setFilterStatus(event.target.value)}>\n            {statusOptions.map((option) => (\n              <MenuItem key={option.value} value={option.value}>\n                {option.label}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <FormControl size=\"small\" sx={{ minWidth: 150 }}>\n          <Select value={filterTag} onChange={(event) => setFilterTag(event.target.value)}>\n            <MenuItem value=\"all\">All tags</MenuItem>\n            {allTags.map((tag) => (\n              <MenuItem key={tag} value={tag}>\n                #{tag}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <FormControl size=\"small\" sx={{ minWidth: 150 }}>\n          <Select value={filterHasHistory} onChange={(event) => setFilterHasHistory(event.target.value as any)}>\n            {historyOptions.map((option) => (\n              <MenuItem key={option.value} value={option.value}>\n                {option.label}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <FormControl size=\"small\" sx={{ minWidth: 150 }}>\n          <Select value={filterDateRange} onChange={(event) => setFilterDateRange(event.target.value as any)}>\n            {dateRangeOptions.map((option) => (\n              <MenuItem key={option.value} value={option.value}>\n                {option.label}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <ToggleButtonGroup\n          size=\"small\"\n          exclusive\n          value={viewMode}\n          onChange={handleViewModeChange}\n          sx={{ ml: 'auto' }}\n        >\n          <ToggleButton value=\"cards\">Cards</ToggleButton>\n          <ToggleButton value=\"table\">Table</ToggleButton>\n        </ToggleButtonGroup>\n      </Box>\n\n      {selectionCount > 0 && (\n        <Card sx={{ mb: 3, border: '1px solid #2563EB', backgroundColor: '#EEF2FF' }}>\n          <CardContent sx={{ display: 'flex', flexWrap: 'wrap', gap: 2, alignItems: 'center' }}>\n            <Typography sx={{ fontWeight: 600, color: '#1E3A8A' }}>\n              {selectionCount} device{selectionCount === 1 ? '' : 's'} selected\n            </Typography>\n            <ButtonGroup size=\"small\" variant=\"contained\">\n              <Button onClick={() => handleBulkAction('disconnect')}>Disconnect</Button>\n              <Button onClick={() => handleBulkAction('reboot')}>Reboot</Button>\n              <Button onClick={() => handleBulkAction('logs')}>Logs</Button>\n              <Button onClick={() => handleBulkAction('pin')}>Pin</Button>\n              <Button onClick={() => handleBulkAction('unpin')}>Unpin</Button>\n            </ButtonGroup>\n            <Button size=\"small\" onClick={clearSelection} sx={{ textTransform: 'none' }}>\n              Clear selection\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Summary cards removed per request */}\n\n      <Card\n        sx={{\n          backgroundColor: '#FFFFFF',\n          border: '1px solid #E5E7EB',\n          borderRadius: '16px',\n          boxShadow: '0 1px 2px rgba(16, 24, 40, 0.06)',\n        }}\n      >\n        <CardContent sx={{ padding: '20px 24px' }}>\n          <Typography sx={{ fontSize: '16px', lineHeight: '24px', fontWeight: 600, color: '#0F172A', mb: 3 }}>\n            Devices ({filteredDevices.length}\n            {filteredDevices.length !== managedDevices.length ? ` / ${managedDevices.length}` : ''})\n          </Typography>\n          {filteredDevices.length === 0 ? (\n            <Box\n              sx={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'center',\n                textAlign: 'center',\n                py: 8,\n              }}\n            >\n              <Smartphone size={56} color=\"#6B7280\" style={{ marginBottom: 16 }} />\n              <Typography sx={{ fontSize: '16px', fontWeight: 600, color: '#0F172A', mb: 1 }}>\n                {managedDevices.length === 0\n                  ? 'No devices recorded yet'\n                  : devices.length === 0\n                    ? 'No devices connected'\n                    : 'No devices match this filter'}\n              </Typography>\n              <Typography sx={{ fontSize: '14px', color: '#6B7280', mb: 3, maxWidth: 320 }}>\n                {managedDevices.length === 0\n                  ? 'Connect a device once to start building its history.'\n                  : devices.length === 0\n                    ? 'Connect an Android device via USB and enable USB debugging.'\n                    : 'Try adjusting your search or tags to see other devices.'}\n              </Typography>\n              <Button\n                variant=\"contained\"\n                startIcon={<RefreshCw size={16} />}\n                onClick={refresh}\n                sx={{\n                  height: 44,\n                  borderRadius: '12px',\n                  backgroundColor: '#2563EB',\n                  textTransform: 'none',\n                  fontWeight: 600,\n                }}\n              >\n                Scan Again\n              </Button>\n            </Box>\n          ) : viewMode === 'table' ? (\n            renderTableView()\n          ) : (\n            <Grid container spacing={3}>\n              {filteredDevices.map((device) => renderDeviceCard(device as ManagedDevice))}\n            </Grid>\n          )}\n        </CardContent>\n      </Card>\n\n      <Dialog open={Boolean(activityDialog)} onClose={closeActivityDialog} maxWidth=\"sm\" fullWidth>\n        <DialogTitle sx={{ fontWeight: 600, color: '#0F172A' }}>\n          Device History  {activityDialog?.name || ''}\n        </DialogTitle>\n        <DialogContent dividers>\n          <Stack direction=\"row\" spacing={2} mb={2} flexWrap=\"wrap\" rowGap={2}>\n            <TextField\n              label=\"Start date/time\"\n              type=\"datetime-local\"\n              size=\"small\"\n              value={exportStart}\n              onChange={(e) => setExportStart(e.target.value)}\n              InputLabelProps={{ shrink: true }}\n            />\n            <TextField\n              label=\"End date/time\"\n              type=\"datetime-local\"\n              size=\"small\"\n              value={exportEnd}\n              onChange={(e) => setExportEnd(e.target.value)}\n              InputLabelProps={{ shrink: true }}\n            />\n            <TextField\n              label=\"Search history\"\n              size=\"small\"\n              value={historySearch}\n              onChange={(e) => {\n                setHistorySearch(e.target.value);\n                setHistoryPage(0);\n              }}\n            />\n            <FormControl size=\"small\" sx={{ minWidth: 140 }}>\n              <Select\n                value={historyTagFilter}\n                displayEmpty\n                onChange={(e) => {\n                  setHistoryTagFilter(e.target.value);\n                  setHistoryPage(0);\n                }}\n              >\n                <MenuItem value=\"all\">All tags</MenuItem>\n                {(metadata[activityDialog?.deviceId || '']?.tags || []).map((tag) => (\n                  <MenuItem key={tag} value={tag}>\n                    {tag}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n            <Button\n              variant=\"outlined\"\n              startIcon={<FileText size={16} />}\n              onClick={async () => {\n                if (!activityDialog) return;\n                const startTs = exportStart ? new Date(exportStart).getTime() : Number.NEGATIVE_INFINITY;\n                const endTs = exportEnd ? new Date(exportEnd).getTime() : Number.POSITIVE_INFINITY;\n                const filtered = filteredHistoryEvents.filter((evt) => {\n                  const ts = new Date(evt.timestamp).getTime();\n                  return ts >= startTs && ts <= endTs;\n                });\n                const body = {\n                  device_alias: metadata[activityDialog.deviceId]?.alias,\n                  device_tags: metadata[activityDialog.deviceId]?.tags ?? [],\n                  start: exportStart || null,\n                  end: exportEnd || null,\n                  entries: filtered.map((evt) => ({\n                    timestamp: new Date(evt.timestamp).toLocaleString(),\n                    type: evt.type,\n                    label: evt.label,\n                    referenceId: evt.referenceId ?? '',\n                    status: evt.status ?? '',\n                    details: evt.details ?? '',\n                  })),\n                };\n                try {\n                  const url = resolveBaseUrl(backendUrl);\n                  const encodedId = encodeURIComponent(activityDialog.deviceId);\n                  const endpoints = [\n                    `${url}/api/v1/devices/${encodedId}/history/export`,\n                    `${url}/api/devices/${encodedId}/history/export`, // legacy prefix fallback\n                  ];\n                  let lastError: string | null = null;\n                  for (const endpoint of endpoints) {\n                    const resp = await fetch(endpoint, {\n                      method: 'POST',\n                      headers: { 'Content-Type': 'application/json' },\n                      body: JSON.stringify(body),\n                    });\n                    if (resp.ok) {\n                      const blob = await resp.blob();\n                      const dlUrl = URL.createObjectURL(blob);\n                      const a = document.createElement('a');\n                      a.href = dlUrl;\n                      a.download = `device_history_${activityDialog.deviceId}.pdf`;\n                      document.body.appendChild(a);\n                      a.click();\n                      document.body.removeChild(a);\n                      URL.revokeObjectURL(dlUrl);\n                      return;\n                    }\n                    const text = await resp.text();\n                    lastError = text || `HTTP ${resp.status}`;\n                  }\n                  throw new Error(lastError || 'Unknown error');\n                } catch (err) {\n                  alert(`Failed to export PDF: ${err instanceof Error ? err.message : 'Unknown error'}`);\n                }\n              }}\n            >\n              Export PDF\n            </Button>\n          </Stack>\n          {activityDialogEvents.length === 0 ? (\n            <Typography sx={{ color: '#6B7280', fontSize: '14px' }}>\n              No recorded workflows or modules for this device yet.\n            </Typography>\n          ) : (\n            <Box sx={{ position: 'relative', pl: 3 }}>\n              <Box\n                sx={{\n                  position: 'absolute',\n                  left: 6,\n                  top: 0,\n                  bottom: 0,\n                  width: 2,\n                  backgroundColor: '#E5E7EB',\n                }}\n              />\n              <Stack spacing={2}>\n                {pagedHistoryEvents.map((event) => {\n                  const statusColor = event.status === 'success' ? '#16A34A' : '#DC2626';\n                  const icon = event.type === 'workflow' ? <GitBranch size={16} /> : <Play size={16} />;\n                  return (\n                    <Box key={event.id} sx={{ position: 'relative', pl: 2 }}>\n                      <Box\n                        sx={{\n                          position: 'absolute',\n                          left: -9,\n                          top: 2,\n                          width: 16,\n                          height: 16,\n                          borderRadius: '50%',\n                          backgroundColor: '#fff',\n                          border: `2px solid ${statusColor}`,\n                          display: 'flex',\n                          alignItems: 'center',\n                          justifyContent: 'center',\n                          color: statusColor,\n                        }}\n                      >\n                        {icon}\n                      </Box>\n                      <Typography sx={{ fontWeight: 600, color: '#0F172A' }}>\n                        {event.label}{' '}\n                        <Chip\n                          label={event.status === 'success' ? 'Success' : 'Failed'}\n                          size=\"small\"\n                          sx={{ ml: 1, backgroundColor: `${statusColor}1A`, color: statusColor, fontWeight: 600 }}\n                        />\n                      </Typography>\n                      <Typography sx={{ fontSize: '12px', color: '#6B7280' }}>\n                        {event.type === 'workflow' ? 'Workflow' : 'Module'}  {formatTimestamp(event.timestamp)}\n                      </Typography>\n                      {event.details ? (\n                        <Typography sx={{ fontSize: '12px', color: '#475569' }}>{event.details}</Typography>\n                      ) : null}\n                    </Box>\n                  );\n                })}\n                {filteredHistoryEvents.length > historyPageSize && (\n                  <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" pt={1}>\n                    <Typography variant=\"body2\" sx={{ color: '#475569' }}>\n                      Page {historyPage + 1} / {Math.ceil(filteredHistoryEvents.length / historyPageSize)}\n                    </Typography>\n                    <ButtonGroup size=\"small\" variant=\"outlined\">\n                      <Button\n                        onClick={() => setHistoryPage((p) => Math.max(0, p - 1))}\n                        disabled={historyPage === 0}\n                      >\n                        Prev\n                      </Button>\n                      <Button\n                        onClick={() =>\n                          setHistoryPage((p) =>\n                            p + 1 < Math.ceil(filteredHistoryEvents.length / historyPageSize) ? p + 1 : p\n                          )\n                        }\n                        disabled={historyPage + 1 >= Math.ceil(filteredHistoryEvents.length / historyPageSize)}\n                      >\n                        Next\n                      </Button>\n                    </ButtonGroup>\n                  </Box>\n                )}\n              </Stack>\n            </Box>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeActivityDialog} sx={{ textTransform: 'none' }}>\n            Close\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Layout>\n  );\n};\n\nexport default DeviceManager;\n","import { Device } from '@types';\n\nexport interface DeviceRegistryEntry {\n  id: string;\n  model?: string;\n  connectionType?: string;\n  lastStatus?: string;\n  firstSeen: string;\n  lastSeen: string;\n}\n\nexport type DeviceRegistryMap = Record<string, DeviceRegistryEntry>;\n\nexport const DEVICE_REGISTRY_STORAGE_KEY = 'deviceRegistry';\nexport const DEVICE_REGISTRY_EVENT = 'deviceRegistry:updated';\n\nconst emitRegistryUpdate = () => {\n  if (typeof window !== 'undefined') {\n    window.dispatchEvent(new CustomEvent(DEVICE_REGISTRY_EVENT));\n  }\n};\n\nconst readRegistryInternal = (): DeviceRegistryMap => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return {};\n  }\n  try {\n    const raw = window.localStorage.getItem(DEVICE_REGISTRY_STORAGE_KEY);\n    if (!raw) {\n      return {};\n    }\n    const parsed = JSON.parse(raw);\n    if (parsed && typeof parsed === 'object') {\n      return parsed as DeviceRegistryMap;\n    }\n  } catch (error) {\n    console.warn('[deviceRegistry] Failed to read registry', error);\n  }\n  return {};\n};\n\nconst persistRegistry = (registry: DeviceRegistryMap) => {\n  if (typeof window === 'undefined' || typeof window.localStorage === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.setItem(DEVICE_REGISTRY_STORAGE_KEY, JSON.stringify(registry));\n    emitRegistryUpdate();\n  } catch (error) {\n    console.warn('[deviceRegistry] Failed to persist registry', error);\n  }\n};\n\nexport const readDeviceRegistry = (): DeviceRegistryMap => {\n  return readRegistryInternal();\n};\n\nconst entriesEqual = (a: DeviceRegistryEntry, b: DeviceRegistryEntry): boolean => {\n  return (\n    a.model === b.model &&\n    a.connectionType === b.connectionType &&\n    a.lastStatus === b.lastStatus &&\n    a.firstSeen === b.firstSeen &&\n    a.lastSeen === b.lastSeen\n  );\n};\n\nexport const syncDevicesToRegistry = (devices: Device[]): void => {\n  if (!devices || devices.length === 0) {\n    return;\n  }\n  const registry = readRegistryInternal();\n  let changed = false;\n  const now = new Date().toISOString();\n\n  devices.forEach((device) => {\n    if (!device?.id) {\n      return;\n    }\n    const existing = registry[device.id];\n    const entry: DeviceRegistryEntry = {\n      id: device.id,\n      model: device.model || existing?.model,\n      connectionType: device.connection_type || existing?.connectionType,\n      lastStatus: device.status || existing?.lastStatus,\n      firstSeen: existing?.firstSeen ?? now,\n      lastSeen: now,\n    };\n    if (!existing || !entriesEqual(existing, entry)) {\n      registry[device.id] = entry;\n      changed = true;\n    }\n  });\n\n  if (changed) {\n    persistRegistry(registry);\n  }\n};\n"],"names":["DEVICE_METADATA_STORAGE_KEY","DEVICE_METADATA_EVENT","defaultChecklist","id","label","done","normalizeDeviceMetadata","meta","alias","tags","Array","isArray","filter","tag","map","trim","length","notes","pinned","Boolean","checklist","item","existing","find","entry","_objectSpread","DEFAULT_DEVICE_METADATA","readDeviceMetadata","window","localStorage","raw","getItem","parsed","JSON","parse","next","Object","entries","forEach","_ref","deviceId","error","console","warn","writeDeviceMetadata","metadata","setItem","stringify","dispatchEvent","Event","readDeviceAliasMap","aliasMap","_ref2","_meta$alias","normalizeStatusValue","status","toLowerCase","formatTimestamp","value","date","Date","Number","isNaN","getTime","toLocaleString","_metadata2","backendUrl","devices","refresh","applyDevicePatch","useDevices","pollMs","searchQuery","setSearchQuery","useState","setMetadata","tagInputs","setTagInputs","registryVersion","setRegistryVersion","activityVersion","setActivityVersion","activityDialog","setActivityDialog","activityDialogEvents","setActivityDialogEvents","viewMode","setViewMode","selectedDeviceIds","setSelectedDeviceIds","Set","filterStatus","setFilterStatus","filterTag","setFilterTag","filterHasHistory","setFilterHasHistory","filterDateRange","setFilterDateRange","notesDrafts","setNotesDrafts","exportStart","setExportStart","exportEnd","setExportEnd","historySearch","setHistorySearch","historyTagFilter","setHistoryTagFilter","historyPage","setHistoryPage","historyPageSize","getStatusColor","bg","color","handleDeviceAction","async","action","patch","disconnect","reboot","test","logs","last_seen","toISOString","fetch","concat","method","ok","useEffect","handleRegistryUpdate","prev","handleStorage","event","key","DEVICE_REGISTRY_STORAGE_KEY","addEventListener","DEVICE_REGISTRY_EVENT","removeEventListener","handleActivityUpdate","DEVICE_ACTIVITY_STORAGE_KEY","DEVICE_ACTIVITY_EVENT","syncDevicesToRegistry","updateDeviceMetadata","_prev$deviceId","current","resolvedPatch","handleAddTag","_tagInputs$deviceId","includes","openActivityDialog","device","_metadata$device$id","_metadata$device$id$a","name","model","getDeviceActivity","closeActivityDialog","toggleManagedDeviceSelection","checked","add","delete","clearSelection","handleBulkAction","ids","from","Promise","all","catch","registryEntries","useMemo","readDeviceRegistry","activityMap","getAllDeviceActivities","managedDevices","Map","_registryEntries$devi","set","__historical","__registry","values","_entry$model","has","connection_type","connectionType","lastSeen","sort","a","b","_a$__registry","_b$__registry","aHistorical","bHistorical","aTime","localeCompare","allTags","_meta$tags","filteredDevices","query","_meta$tags2","_meta$tags3","registryMeta","haystack","os_version","join","isWithinRange","timestamp","range","diff","now","dayMs","filteredHistoryEvents","_metadata$device$id2","counts","_meta$tags4","slice","events","push","list","q","evt","referenceId","details","_metadata","pagedHistoryEvents","start","selectionCount","_Object$entries$sort$","_metadata$mostActiveD","_managedDevices$find","workflowCount","moduleCount","deviceFrequency","_ref3","type","mostActiveDeviceId","mostActiveDevice","size","allFilteredSelected","every","renderChecklist","_jsx","Stack","direction","spacing","flexWrap","sx","mb","children","Chip","icon","CheckSquare","Square","onClick","toggleChecklistItem","itemId","_current$checklist","backgroundColor","renderDeviceCard","_metadata$device$id3","_deviceMeta$alias","_deviceMeta$tags","_tagInputs$device$id","_activityMap$device$i","_activityMap$device$i2","_ref4","_notesDrafts$device$i","_deviceMeta$alias2","_activityEntries$","isHistorical","deviceMeta","displayName","deviceTags","tagInputValue","isPinned","lastSeenDisplay","firstSeen","connectionLabel","statusStyle","activityEntries","moduleRuns","workflowRuns","hasActivity","notesValue","Grid","xs","md","Card","border","borderRadius","transition","boxShadow","borderColor","_jsxs","CardContent","padding","Box","display","justifyContent","alignItems","gap","Checkbox","onChange","target","fontWeight","textTransform","Tooltip","title","IconButton","togglePin","width","height","BookmarkCheck","Bookmark","disabled","NotebookPen","p","Smartphone","Typography","variant","fontSize","Info","TextField","fullWidth","e","handleAliasChange","onDelete","handleRemoveTag","placeholder","handleTagInputChange","onKeyDown","preventDefault","InputProps","endAdornment","InputAdornment","position","Tag","multiline","minRows","handleNotesChange","onBlur","persistNotes","opacity","Power","RotateCcw","FileText","Play","Layout","lineHeight","startAdornment","Search","Button","startIcon","RefreshCw","FormControl","minWidth","Select","option","MenuItem","ToggleButtonGroup","exclusive","handleViewModeChange","_event","ml","ToggleButton","ButtonGroup","flexDirection","textAlign","py","style","marginBottom","maxWidth","indeterminate","toggleSelectAllFiltered","devicesSubset","Table","TableHead","TableRow","TableCell","align","TableBody","_metadata$device$id4","_deviceMeta$alias3","_activityMap$device$i3","_deviceMeta$tags2","_deviceMeta$tags3","managedDevice","container","Dialog","open","onClose","DialogTitle","DialogContent","dividers","rowGap","InputLabelProps","shrink","displayEmpty","_metadata$activityDia","_metadata$activityDia2","_metadata$activityDia3","startTs","NEGATIVE_INFINITY","endTs","POSITIVE_INFINITY","filtered","ts","body","device_alias","device_tags","end","_evt$referenceId","_evt$status","_evt$details","url","resolveBaseUrl","encodedId","encodeURIComponent","endpoints","lastError","endpoint","resp","headers","blob","dlUrl","URL","createObjectURL","document","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","text","Error","err","alert","message","pl","left","top","bottom","statusColor","GitBranch","pt","Math","ceil","max","DialogActions","readRegistryInternal","persistRegistry","registry","CustomEvent","changed","_existing$firstSeen","lastStatus","entriesEqual"],"sourceRoot":""}