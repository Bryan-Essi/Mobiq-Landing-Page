/*! For license information please see 698.784c8c3a.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktelco_frontend=self.webpackChunktelco_frontend||[]).push([[698],{2120:(e,t,n)=>{n.d(t,{HE:()=>l,PS:()=>a,X0:()=>c,wp:()=>s});const o="selectedDeviceIds",r="selectedDeviceId",a="selected-devices:updated",i=e=>{if(!e)return[];if(Array.isArray(e))return e.filter(e=>"string"===typeof e&&e.trim().length>0);if("string"===typeof e)try{const t=JSON.parse(e);if(Array.isArray(t))return i(t)}catch(t){const n=e.trim();if(n.length>0)return[n]}return[]},s=()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return[];try{const e=window.localStorage.getItem(o),t=i(e);if(t.length>0)return Array.from(new Set(t));const n=window.localStorage.getItem(r),a=i(n);if(a.length>0)return l(a),window.localStorage.removeItem(r),a}catch(e){console.warn("[deviceSelection] Failed to read selected devices",e)}return[]},l=e=>{if("undefined"!==typeof window&&"undefined"!==typeof window.localStorage)try{const t=Array.from(new Set(e.filter(e=>"string"===typeof e&&e.trim().length>0)));window.localStorage.setItem(o,JSON.stringify(t)),window.dispatchEvent(new CustomEvent(a,{detail:t}))}catch(t){console.warn("[deviceSelection] Failed to persist selected devices",t)}},c=(e,t)=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),Array.from(n)}},5505:(e,t,n)=>{n.d(t,{A:()=>o});const o=(0,n(7784).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},5698:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ce});var o=n(2555),r=n(5043),a=n(9216),i=n(5865),s=n(6446),l=n(5146),c=n(1787),d=n(3193),u=n(9285),f=n(2143),h=n(5078),g=n(8983),m=n(3845),p=n(547),v=n(2518),x=n(2110),w=n(6494),y=n(8903),b=n(7392),A=n(9508),S=n(35),C=n(6600),j=n(5316),E=n(9347),k=n(794),I=n(9292),_=n(7784);const T=(0,_.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),D=(0,_.A)("star-off",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),P=(0,_.A)("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);var N=n(4830),F=n(5505),W=n(6655),B=n(579);const O=e=>{var t,n,a,c;let{open:d,mode:u,initialValues:f,targetDeviceId:h,stepIndex:g,totalSteps:m,onCancel:p,onSubmit:x,canGoBack:w=!1,onPrevious:b}=e;const[A,k]=(0,r.useState)(()=>({countryCode:f.countryCode,phoneNumber:f.phoneNumber,duration:String(f.duration),callCount:String(f.callCount)})),[I,_]=(0,r.useState)({}),[T,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{d&&(k({countryCode:f.countryCode,phoneNumber:f.phoneNumber,duration:String(f.duration),callCount:String(f.callCount)}),_({}),D(!1))},[d,f]);const P=!m||!g||g>=m,N=null!==h&&void 0!==h?h:"Default template",F=g&&m?"(".concat(g,"/").concat(m,")"):void 0,W=(0,r.useMemo)(()=>"run"===u?"Call Test Parameters":"Edit Call Test Parameters",[u]),O=(0,r.useMemo)(()=>"run"===u?P?"Launch Test":"Next Device":P?"Save":"Next Device",[P,u]),M=e=>t=>{k(n=>(0,o.A)((0,o.A)({},n),{},{[e]:t.target.value}))};return(0,B.jsxs)(S.A,{open:d,onClose:T?void 0:p,fullWidth:!0,maxWidth:"sm",children:[(0,B.jsx)(C.A,{children:W}),(0,B.jsxs)(j.A,{children:[(0,B.jsx)(i.A,{variant:"body2",sx:{color:"#475569",mb:1.5},children:"Provide the details required for the call scenario. Parameters are stored locally and reused for upcoming runs."}),"run"===u?h?(0,B.jsxs)(i.A,{variant:"body2",sx:{color:"#2563EB",mb:3},children:["Device ",F?"".concat(F," \u2013 "):"",(0,B.jsx)("strong",{children:h})]}):(0,B.jsx)(i.A,{variant:"body2",sx:{color:"#DC2626",mb:3},children:"No active device selected. Choose one from the dashboard before launching."}):(0,B.jsxs)(i.A,{variant:"body2",sx:{color:"#2563EB",mb:3},children:["Editing parameters for ",(0,B.jsx)("strong",{children:N})," ",F||""]}),(0,B.jsxs)(y.Ay,{container:!0,spacing:2,children:[(0,B.jsx)(y.Ay,{item:!0,xs:12,sm:4,children:(0,B.jsx)(l.A,{label:"Country code",value:A.countryCode,onChange:M("countryCode"),placeholder:"+237",error:Boolean(I.countryCode),helperText:null!==(t=I.countryCode)&&void 0!==t?t:"International prefix",fullWidth:!0,disabled:T,inputProps:{maxLength:5}})}),(0,B.jsx)(y.Ay,{item:!0,xs:12,sm:8,children:(0,B.jsx)(l.A,{label:"Contact number",value:A.phoneNumber,onChange:M("phoneNumber"),placeholder:"691234567",error:Boolean(I.phoneNumber),helperText:null!==(n=I.phoneNumber)&&void 0!==n?n:"Digits only (spaces allowed while typing)",fullWidth:!0,disabled:T})}),(0,B.jsx)(y.Ay,{item:!0,xs:12,sm:6,children:(0,B.jsx)(l.A,{label:"Call duration (seconds)",value:A.duration,onChange:M("duration"),type:"number",error:Boolean(I.duration),helperText:null!==(a=I.duration)&&void 0!==a?a:"Between 1 and 600 seconds",fullWidth:!0,disabled:T,inputProps:{min:1,max:600}})}),(0,B.jsx)(y.Ay,{item:!0,xs:12,sm:6,children:(0,B.jsx)(l.A,{label:"Number of calls",value:A.callCount,onChange:M("callCount"),type:"number",error:Boolean(I.callCount),helperText:null!==(c=I.callCount)&&void 0!==c?c:"Between 1 and 10 consecutive calls",fullWidth:!0,disabled:T,inputProps:{min:1,max:10}})})]}),(0,B.jsx)(s.A,{mt:3,sx:{backgroundColor:"#F8FAFC",borderRadius:"12px",padding:"12px 16px"},children:(0,B.jsx)(i.A,{variant:"caption",sx:{color:"#64748B"},children:'Tip: adjust parameters in "Edit" mode ahead of time and use "Run" to launch immediately on the active device.'})})]}),(0,B.jsxs)(E.A,{sx:{padding:"16px 24px"},children:[w&&(0,B.jsx)(v.A,{onClick:b,disabled:T,sx:{textTransform:"none"},children:"Previous device"}),(0,B.jsx)(v.A,{onClick:p,disabled:T,sx:{textTransform:"none"},children:"Cancel"}),(0,B.jsx)(v.A,{variant:"contained",onClick:async()=>{const{hasErrors:e,values:t}=(()=>{const e={},t=(e=>{const t=e.replace(/[^0-9]/g,"");return t?"+".concat(t):""})(A.countryCode.trim());t?/^\+[0-9]{1,4}$/.test(t)||(e.countryCode="Country code must contain 1 to 4 digits"):e.countryCode="Please enter a country code (e.g. +237)";const n=A.phoneNumber.replace(/[^0-9]/g,"");n?n.length<4&&(e.phoneNumber="Number must contain at least 4 digits"):e.phoneNumber="Please enter a contact number";const o=parseInt(A.duration,10);Number.isNaN(o)?e.duration="Invalid duration":o<=0?e.duration="Duration must be greater than 0":o>600&&(e.duration="Duration cannot exceed 600 seconds");const r=parseInt(A.callCount,10);return Number.isNaN(r)?e.callCount="Invalid call count":(r<1||r>10)&&(e.callCount="Call count must be between 1 and 10"),_(e),Object.keys(e).length>0?{hasErrors:!0}:{hasErrors:!1,values:{countryCode:t,phoneNumber:n,duration:o,callCount:r}}})();if(!e&&t)try{D(!0),await x(t)}finally{D(!1)}},disabled:T||"run"===u&&!h,sx:{textTransform:"none"},children:O})]})]})};var M=n(8738),R=n(7426),z=n(2120),L=n(8729),U=n(9849);const H=e=>"adb_scripts/".concat(e),J="callTestParams",K="__global__",q={countryCode:"+237",phoneNumber:"691234567",duration:30,callCount:1},$="waitingTimeDurationSeconds",V="pingModuleConfig",G="workflowBuilderDraft",X="moduleFavorites",Y="moduleRecents",Z=e=>{if(!e||"object"!==typeof e)return;const t=e.error;if("string"===typeof t&&t.trim().length>0)return t.trim();const n=e.message;if("string"===typeof n&&n.trim().length>0)return n.trim();const o=e.output;return"string"===typeof o&&o.trim().length>0?o.trim():void 0},Q=()=>{const e=(()=>{const e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_KEY||{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_KEY,t="undefined"!==typeof window?window.localStorage.getItem("API_KEY"):null;return t&&t.trim()||e&&e.trim()||null})();return e?{"X-API-Key":e}:{}},ee=e=>e?e.startsWith("catalog:")?{source:"catalog",id:e.replace("catalog:","")}:e.startsWith("builder:")?{source:"builder",id:e.replace("builder:","")}:null:null,te={target:"8.8.8.8",duration:10,interval:1},ne="(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})",oe=new RegExp("^(?:".concat(ne,"\\.){3}").concat(ne,"$")),re=/^[a-zA-Z0-9-]{1,63}$/,ae=e=>{if(!e||e.length>253)return!1;if("localhost"===e)return!0;const t=e.split(".");return!(t.length<2)&&t.every(e=>(e=>re.test(e)&&!e.startsWith("-")&&!e.endsWith("-"))(e))},ie=e=>(e=>oe.test(e))(e)||ae(e),se="dialSecretCode",le=e=>{const t=e.trim();return t?ie(t)?null:"Enter a valid IP address or domain (e.g. 8.8.8.8 or example.com).":"Target is required."},ce=e=>({target:e.target,duration:String(e.duration),interval:String(e.interval)}),de=new Set(["connected","online","busy","in_use","idle"]),ue=e=>{const t=e.countryCode.replace(/[^0-9]/g,"");return{countryCode:t?"+".concat(t):q.countryCode,phoneNumber:e.phoneNumber.replace(/[^0-9]/g,"")||q.phoneNumber,duration:Math.max(1,Math.min(600,Math.trunc(e.duration))),callCount:Math.max(1,Math.min(10,Math.trunc(e.callCount)))}},fe=e=>{if(!e||"object"!==typeof e)return!1;const t=e;return"string"===typeof t.countryCode&&"string"===typeof t.phoneNumber&&"number"===typeof t.duration&&"number"===typeof t.callCount},he=()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return{};try{const e=window.localStorage.getItem(J);if(!e)return{};const t=JSON.parse(e);if(fe(t))return{[K]:ue(t)};if(t&&"object"===typeof t){const e={};return Object.entries(t).forEach(t=>{let[n,o]=t;fe(o)&&(e[n]=ue(o))}),e}}catch(e){console.warn("[CallTest] Failed to load stored parameters map",e)}return{}},ge=new Set(["enable_airplane_mode","disable_airplane_mode","ping","activate_data","wrong_apn_configuration","pull_device_logs","start_rf_logging","stop_rf_logging","pull_rf_logs","dial_secret_code"]),me=e=>{if(!Number.isFinite(e))return 5;const t=Math.round(e);return Math.min(600,Math.max(1,t))},pe=()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return te;try{const e=window.localStorage.getItem(V);if(!e)return te;const t=JSON.parse(e);if("string"===typeof(null===t||void 0===t?void 0:t.target)&&"number"===typeof(null===t||void 0===t?void 0:t.duration)&&"number"===typeof(null===t||void 0===t?void 0:t.interval))return{target:t.target||te.target,duration:Math.max(1,Math.round(t.duration)),interval:Math.min(5,Math.max(.2,Number(t.interval)))}}catch(e){}return te},ve=()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return 5;try{const e=window.localStorage.getItem($);if(!e)return 5;const t=Number(e);return me(t)}catch(e){return 5}},xe="module.wrongApnValue",we="arnaud",ye="module.logPullDestination",be="C:\\\\Users\\\\rush\\\\Documents\\\\logs",Ae=e=>{let t=(0,o.A)({},e);if("waiting_time"===e.id){const n="number"===typeof e.waitDurationSeconds?e.waitDurationSeconds:ve();t=(0,o.A)((0,o.A)({},t),{},{waitDurationSeconds:me(n)})}if("call_test"===e.id){const n=e.callTestParams?ue(e.callTestParams):(e=>{const t=he();return e&&t[e]?t[e]:t[K]?t[K]:q})(null);t=(0,o.A)((0,o.A)({},t),{},{callTestParams:(0,o.A)({},n)})}return t},Se=e=>{if("undefined"!==typeof window&&"undefined"!==typeof window.localStorage)try{if(!e||0===e.modules.length&&!e.showBuilder&&!e.name&&!e.description)return void window.localStorage.removeItem(G);window.localStorage.setItem(G,JSON.stringify(e))}catch(t){console.warn("[WorkflowBuilderDraft] Failed to persist draft",t)}},Ce=e=>{let{backendUrl:t}=e;const[n,_]=(0,r.useState)(),[te,ne]=(0,r.useState)([]),[oe,re]=(0,r.useState)(!1),[ae,ie]=(0,r.useState)(!1),[Ce,je]=(0,r.useState)(""),Ee=r.useRef(null),[ke,Ie]=(0,r.useState)(""),[_e,Te]=(0,r.useState)("all"),[De,Pe]=(0,r.useState)(""),[Ne,Fe]=(0,r.useState)(()=>(()=>{if("undefined"===typeof window)return new Set;try{const e=window.localStorage.getItem(X);if(!e)return new Set;const t=JSON.parse(e);return new Set(Array.isArray(t)?t.filter(e=>"string"===typeof e):[])}catch(e){return new Set}})()),[We,Be]=(0,r.useState)("all"),[Oe,Me]=(0,r.useState)(()=>(()=>{if("undefined"===typeof window)return[];try{const e=window.localStorage.getItem(Y),t=e?JSON.parse(e):[];return Array.isArray(t)?t.filter(e=>"string"===typeof e).slice(0,8):[]}catch(e){return[]}})()),[Re,ze]=(0,r.useState)(!0),[Le,Ue]=(0,r.useState)(!1),[He,Je]=(0,r.useState)("run"),[Ke,qe]=(0,r.useState)(q),[$e,Ve]=(0,r.useState)(null),[Ge,Xe]=(0,r.useState)(0),[Ye,Ze]=(0,r.useState)([]),[Qe,et]=(0,r.useState)(0),[tt,nt]=(0,r.useState)({}),ot=r.useRef({success:[],failure:[]}),rt=r.useRef(ve()),[at,it]=(0,r.useState)(rt.current),[st,lt]=(0,r.useState)(!1),[ct,dt]=(0,r.useState)(String(rt.current)),[ut,ft]=(0,r.useState)(null),[ht,gt]=(0,r.useState)(!1),[mt,pt]=(0,r.useState)(()=>pe()),[vt,xt]=(0,r.useState)(()=>ce(pe())),[wt,yt]=(0,r.useState)(null),[bt,At]=(0,r.useState)(null),[St,Ct]=(0,r.useState)(!1),[jt,Et]=(0,r.useState)(()=>(0,z.wp)()),[kt,It]=(0,r.useState)(()=>(()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return we;try{const e=window.localStorage.getItem(xe);if(!e)return we;const t=e.trim();return t.length>0?t:we}catch(e){return we}})()),[_t,Tt]=(0,r.useState)(()=>(()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return be;try{const e=window.localStorage.getItem(ye);if(!e)return be;const t=e.trim();return t.length>0?t:be}catch(e){return be}})()),[Dt,Pt]=(0,r.useState)(()=>"undefined"===typeof window||"undefined"===typeof window.localStorage?"":window.localStorage.getItem(se)||""),[Nt,Ft]=(0,r.useState)(!1),[Wt,Bt]=(0,r.useState)(kt),[Ot,Mt]=(0,r.useState)(!1),[Rt,zt]=(0,r.useState)(_t),[Lt,Ut]=(0,r.useState)(null),[Ht,Jt]=(0,r.useState)(!1),[Kt,qt]=(0,r.useState)(Dt),[$t,Vt]=(0,r.useState)(null),[Gt,Xt]=(0,r.useState)({}),{devices:Yt,status:Zt}=(0,L.t)({backendUrl:t}),Qt=(0,r.useMemo)(()=>Yt.filter(e=>{return!(!(t=e.status)||"string"!==typeof t)&&de.has(t.toLowerCase());var t}).map(e=>e.id),[Yt]),en=(0,r.useMemo)(()=>new Set(Qt),[Qt]),tn=ae&&(te.length>0||ke.trim().length>0||De.trim().length>0),nn=(0,r.useCallback)(e=>M.v.find(t=>t.id===e),[]);(0,r.useEffect)(()=>{const e=(()=>{if("undefined"===typeof window||"undefined"===typeof window.localStorage)return null;try{const e=window.localStorage.getItem(G);if(!e)return null;const t=JSON.parse(e);if(!t||"object"!==typeof t)return null;const n=Array.isArray(t.modules)?t.modules.map(e=>{if(!e||"string"!==typeof e.id)return null;const t={id:e.id};return"number"===typeof e.waitDurationSeconds&&(t.waitDurationSeconds=e.waitDurationSeconds),fe(e.callTestParams)&&(t.callTestParams=ue(e.callTestParams)),t}).filter(e=>Boolean(e)):[];return{name:"string"===typeof t.name?t.name:"",description:"string"===typeof t.description?t.description:"",showBuilder:Boolean(t.showBuilder),modules:n}}catch(e){return console.warn("[WorkflowBuilderDraft] Failed to read draft",e),null}})();if(e){var t,n;const r=(e=>{const t=Date.now();return e.modules.map((e,n)=>{const r=M.v.find(t=>t.id===e.id);if(!r)return null;let a=(0,o.A)({},r);return"number"===typeof e.waitDurationSeconds&&(a=(0,o.A)((0,o.A)({},a),{},{waitDurationSeconds:e.waitDurationSeconds})),e.callTestParams&&(a=(0,o.A)((0,o.A)({},a),{},{callTestParams:ue(e.callTestParams)})),{instanceId:"draft-".concat(e.id,"-").concat(t,"-").concat(n,"-").concat(Math.random().toString(36).slice(2,6)),module:Ae(a)}}).filter(e=>Boolean(e))})(e);r.length>0&&ne(r),re(Boolean(e.showBuilder)),Ie(null!==(t=e.name)&&void 0!==t?t:""),Pe(null!==(n=e.description)&&void 0!==n?n:"")}ie(!0)},[]),(0,r.useEffect)(()=>{const e=e=>{var t;(e.ctrlKey||e.metaKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),null===(t=Ee.current)||void 0===t||t.focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);const on=(0,r.useMemo)(()=>jt.filter(e=>en.has(e)),[en,jt]),rn=jt.length>0&&0===on.length,an=on.length>0,[sn,ln]=(0,r.useState)({}),cn="success"===Zt&&(0===Qt.length||!an),dn=0===Qt.length?"error":rn?"warning":"info",un=0===Qt.length?"No devices are ready. Connect a phone and mark it active from the Dashboard before running modules.":rn?"The previously selected device is no longer connected. Open the Dashboard to choose another one.":"Select an active device from the Dashboard before running modules.",[fn,hn]=(0,r.useState)(null),[gn,mn]=(0,r.useState)(null),[pn,vn]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=(0,z.wp)();Et(e);const t=e=>{const t=e.detail;Array.isArray(t)?Et(t):Et((0,z.wp)())};return window.addEventListener(z.PS,t),()=>{window.removeEventListener(z.PS,t)}},[]),(0,r.useEffect)(()=>{(e=>{if("undefined"!==typeof window&&"undefined"!==typeof window.localStorage)try{window.localStorage.setItem(xe,e)}catch(t){console.warn("[WrongAPN] Failed to persist value",t)}})(kt)},[kt]),(0,r.useEffect)(()=>{(e=>{if("undefined"!==typeof window&&"undefined"!==typeof window.localStorage)try{window.localStorage.setItem(ye,e)}catch(t){console.warn("[LogPull] Failed to persist destination",t)}})(_t)},[_t]),(0,r.useEffect)(()=>{if(!ae)return;oe||te.length>0||ke.trim().length>0||De.trim().length>0?Se({name:ke,description:De,showBuilder:oe,modules:te.map(e=>{const t={id:e.module.id};return"number"===typeof e.module.waitDurationSeconds&&(t.waitDurationSeconds=e.module.waitDurationSeconds),e.module.callTestParams&&(t.callTestParams=(0,o.A)({},e.module.callTestParams)),t})}):Se(null)},[ae,oe,te,ke,De]),(0,r.useEffect)(()=>{ln(he())},[]);const xn=(0,r.useCallback)((e,t)=>{const n=ue(t);ln(t=>{const r=(0,o.A)((0,o.A)({},t),{},{[e]:n});try{localStorage.setItem(J,JSON.stringify(r))}catch(a){console.warn("[CallTest] Failed to persist parameters",a)}return r})},[]),wn=(0,r.useCallback)(e=>e&&sn[e]?sn[e]:sn[K]?sn[K]:q,[sn]),yn=(0,r.useCallback)(async(e,n)=>{var r;const a=ue(n),i="".concat(a.countryCode).concat(a.phoneNumber);if(!t)throw new Error("Backend unavailable: no URL configured.");const s=t.replace(/\/$/,"");try{const t=await fetch("".concat(s,"/api/modules/voice_call_test/execute"),{method:"POST",headers:(0,o.A)({"Content-Type":"application/json"},Q()),body:JSON.stringify({device_id:e,parameters:{number:i,duration:a.duration,call_count:a.callCount}})});if(!t.ok){const e=await t.text();throw new Error(e||"Backend failure (HTTP ".concat(t.status,")"))}await t.json().catch(()=>{})}catch(l){const e=l instanceof Error?l.message:"Unknown error while communicating with the backend.";throw new Error(e)}if(null!==(r=window.electronAPI)&&void 0!==r&&r.runScript)try{window.electronAPI.runScript(H("call_control.sh"))}catch(c){console.warn("[CallTest] runScript unavailable",c)}else console.info("Call Test placeholder for ".concat(i," (device: ").concat(e,") (").concat(a.callCount," call(s) / ").concat(a.duration,"s)."));return{sanitized:a,fullNumber:i}},[t]),bn=(0,r.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Array.from(new Set(e));if(0===n.length)return void _({severity:"error",message:"Select at least one device on the dashboard before launching the Call Test."});const o=await Promise.allSettled(n.map(e=>{var n,o;const r=t[e],a=null!==(n=null!==(o=sn[e])&&void 0!==o?o:sn[K])&&void 0!==n?n:q;return yn(e,null!==r&&void 0!==r?r:a)})),r=[],a=[];if(o.forEach((e,t)=>{const o=n[t];if("fulfilled"===e.status)r.push(o);else{const t=e.reason instanceof Error?e.reason.message:"string"===typeof e.reason?e.reason:"Execution failed.";a.push({deviceId:o,reason:t})}}),0===a.length)_({severity:"success",message:"Call Test launched on ".concat(r.length," device").concat(1===r.length?"":"s",".")});else if(r.length>0){const e=a.map(e=>e.deviceId).join(", ");_({severity:"warning",message:"Call Test partially launched. Failed for: ".concat(e,".")})}else{const e=a.map(e=>"".concat(e.deviceId,": ").concat(e.reason)).join(" | ");_({severity:"error",message:"Call Test failed on all selected devices. ".concat(e)})}ot.current={success:r,failure:a}},[sn,yn]),An=(0,r.useCallback)(async e=>{const t=ue(e),n=Ge<=1||Qe>=Ge-1;if("run"===He){const e=$e;if(!e)return void _({severity:"error",message:"No active device selected for Call Test."});xn(e,t),xn(K,t);const a=(0,o.A)((0,o.A)({},tt),{},{[e]:t});if(nt(a),!n){const e=Qe+1,t=Ye[e];if(t){var r;et(e),Ve(t);const n=null!==(r=a[t])&&void 0!==r?r:wn(t);return void qe(n)}}Ue(!1),Ve(null),et(0),Xe(0);const i=[...Ye];return Ze([]),await bn(i,a),void nt({})}if(xn(null!==$e&&void 0!==$e?$e:K,t),!n){const e=Qe+1,t=Ye[e];if(t){et(e),Ve(t);const n=wn(t===K?null:t);return void qe(n)}}Ue(!1),Ve(null),et(0),Xe(0),Ze([]),_({severity:"success",message:"Call Test parameters saved."}),ot.current={success:[],failure:[]}},[He,Ye,$e,wn,bn,tt,Qe,Ge,xn]),Sn=(0,r.useCallback)(()=>{var e;if(Qe<=0)return;const t=Qe-1,n=Ye[t];if(!n)return;et(t),Ve(n);const o=null!==(e=tt[n])&&void 0!==e?e:wn(n===K?null:n);qe(o)},[Qe,Ye,tt,wn]),Cn=(0,r.useMemo)(()=>{const e=new Set;return M.v.forEach(t=>e.add(t.category)),["all",...Array.from(e).sort((e,t)=>e.localeCompare(t))]},[]),jn=$e===K?null:$e,En=(0,r.useMemo)(()=>M.v.filter(e=>!0!==e.hiddenInModulesPage).sort((e,t)=>e.name.localeCompare(t.name)),[]),kn=(0,r.useMemo)(()=>{const e=Ce.toLowerCase(),t=e=>{const t=Oe.indexOf(e);return-1===t?Number.MAX_SAFE_INTEGER:t},n=En.filter(t=>{const n=t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e),o="all"===_e||t.category===_e,r="favorites"!==We||Ne.has(t.id),a="recents"!==We||Oe.includes(t.id);return n&&o&&r&&a});return"recents"===We?[...n].sort((e,n)=>t(e.id)-t(n.id)):n},[Ne,_e,Oe,Ce,We,En]),In=(0,r.useCallback)(()=>{if(on.length>0)return on;const e=(0,z.wp)();return 0===e.length?[]:e.filter(e=>en.has(e))},[on,en]),_n=(0,r.useCallback)(async(e,n)=>{const r=!0===(null===n||void 0===n?void 0:n.silent),a=In();if(0===a.length)return void _({severity:"error",message:"Select at least one device on the dashboard before running ".concat(e.name,".")});if(!t)return void _({severity:"error",message:"Backend unavailable: no URL configured."});const i=t.replace(/\/$/,""),s={};if("wrong_apn_configuration"===e.id)s.apn_value=(kt||we).trim()||we,s.use_ui_flow=!0;else if("pull_device_logs"===e.id||"pull_rf_logs"===e.id){const e=_t.trim();if(!e)return void _({severity:"error",message:"Specify a destination path before running the Log Pull module."});s.destination=e}else if("dial_secret_code"===e.id){const e=Dt.trim();if(!e)return void _({severity:"error",message:"Enter a secret/USSD code before running."});s.code=e}const l=[],c=[],d=[];Xt(t=>(0,o.A)((0,o.A)({},t),{},{[e.id]:"running"}));try{for(const n of a)try{var u;const t=await fetch("".concat(i,"/api/modules/").concat(e.id,"/execute"),{method:"POST",headers:(0,o.A)({"Content-Type":"application/json"},Q()),body:JSON.stringify({device_id:n,parameters:s})});if(!t.ok){const e=await t.text();throw new Error(e||"Backend failure (HTTP ".concat(t.status,")"))}const r=await t.json(),a="boolean"!==typeof r.success||r.success,f=a?void 0:null!==(u=Z(r))&&void 0!==u?u:"Execution failed.";d.push((0,o.A)({deviceId:n,success:a,response:r},f?{error:f}:{})),a?l.push(n):c.push({deviceId:n,reason:null!==f&&void 0!==f?f:"Execution failed."})}catch(f){const e=f instanceof Error?f.message:"Unknown error while communicating with the backend.";c.push({deviceId:n,reason:e}),d.push({deviceId:n,success:!1,error:e})}vn({moduleId:e.id,timestamp:(new Date).toISOString(),results:d});const t=(new Date).toISOString();if(d.forEach(n=>{(0,U.$Q)({deviceId:n.deviceId,type:"module",label:e.name,status:n.success?"success":"failure",referenceId:e.id,details:n.error,timestamp:t})}),!r){const t=d.filter(e=>{var t;const n=null===(t=e.response)||void 0===t?void 0:t.result;return n&&(n.already_active||n.already_configured||n.already_on||n.already_off)}).map(e=>e.deviceId);if(0===c.length)t.length>0?_({severity:"info",message:"".concat(e.name,": device already in desired state (").concat(t.join(", "),").")}):_({severity:"success",message:"".concat(e.name," executed successfully on ").concat(l.length," device").concat(1===l.length?"":"s",".")});else if(l.length>0){const t=c.map(e=>e.deviceId).join(", ");_({severity:"warning",message:"".concat(e.name," executed on ").concat(l.length," device").concat(1===l.length?"":"s",". Failed for: ").concat(t,".")})}else{const t=c.map(e=>"".concat(e.deviceId,": ").concat(e.reason)).join(" | ");_({severity:"error",message:"".concat(e.name," failed on all selected devices. ").concat(t)})}}}catch(h){const t=h instanceof Error?h.message:"Unexpected error during module execution.";_({severity:"error",message:"".concat(e.name," execution aborted: ").concat(t)})}finally{Xt(t=>{const n=(0,o.A)({},t);return delete n[e.id],n})}},[t,In,mt,kt,_t]),Tn=(0,r.useCallback)((e,t)=>{if(!e)return;const n=(e=>({instanceId:"".concat(e.id,"-").concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,8)),module:e}))(e);ne(e=>{if(t){const o=e.findIndex(e=>e.instanceId===t);if(-1===o)return[...e,n];const r=[...e];return r.splice(o,0,n),r}return[...e,n]}),re(!0)},[]),Dn=e=>{let t="waiting_time"===e.id?(0,o.A)((0,o.A)({},e),{},{waitDurationSeconds:at}):(0,o.A)({},e);if("call_test"===e.id){const e=(0,o.A)({},wn(null));t=(0,o.A)((0,o.A)({},t),{},{callTestParams:e})}Tn(t,null),_({message:"Added ".concat(e.name," to workflow"),severity:"success"}),Me(t=>{const n=[e.id,...t.filter(t=>t!==e.id)].slice(0,8);return(e=>{try{window.localStorage.setItem(Y,JSON.stringify(e.slice(0,8)))}catch(t){}})(n),n})},Pn=e=>{ne(t=>t.filter(t=>t.instanceId!==e))},Nn=()=>{lt(!1),ft(null)},Fn=()=>{Ft(!1)},Wn=(0,r.useCallback)(e=>{Fe(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),(e=>{try{window.localStorage.setItem(X,JSON.stringify(Array.from(e)))}catch(t){}})(n),n})},[]),Bn=()=>{Mt(!1),Ut(null)},On=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},Mn=(e,t)=>{e.preventDefault();const n=ee(e.dataTransfer.getData("text/plain"));if("builder"===(null===n||void 0===n?void 0:n.source))((e,t)=>{e!==t&&ne(n=>{const o=n.findIndex(t=>t.instanceId===e);if(-1===o)return n;const r=[...n],[a]=r.splice(o,1);if(t){const e=r.findIndex(e=>e.instanceId===t);if(-1===e)return n;r.splice(e,0,a)}else r.push(a);return r})})(n.id,t);else if("catalog"===(null===n||void 0===n?void 0:n.source)){const e=nn(n.id);Tn(null!==e&&void 0!==e?e:null,t)}hn(null),mn(null)},Rn=()=>{hn(null),mn(null)},zn=()=>{mn(null)};return(0,B.jsxs)(W.A,{children:[(0,B.jsxs)(s.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,gap:2},children:[(0,B.jsx)(i.A,{variant:"h1",sx:{fontSize:"28px",lineHeight:"36px",fontWeight:700,color:"#0F172A"},children:"Modules"}),(0,B.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,B.jsx)(l.A,{placeholder:"Search modules...",value:Ce,onChange:e=>je(e.target.value),inputRef:Ee,sx:{width:260,"& .MuiOutlinedInput-root":{height:40,borderRadius:"10px"}},InputProps:{startAdornment:(0,B.jsx)(c.A,{position:"start",children:(0,B.jsx)(I.A,{size:20,color:"#6B7280"})})}}),(0,B.jsx)(d.A,{size:"small",sx:{minWidth:180},children:(0,B.jsx)(u.A,{value:_e,onChange:e=>Te(e.target.value),displayEmpty:!0,children:Cn.map(e=>(0,B.jsx)(f.A,{value:e,children:"all"===e?"All":e},e))})}),(0,B.jsxs)(h.A,{size:"small",value:We,exclusive:!0,onChange:(e,t)=>t&&Be(t),children:[(0,B.jsxs)(g.A,{value:"favorites",sx:{gap:.5},children:[(0,B.jsx)(T,{size:16})," Favorites"]}),(0,B.jsx)(g.A,{value:"recents",children:"Recents"})]}),(0,B.jsx)(m.A,{label:an?"".concat(on.length," active device").concat(1===on.length?"":"s"):"No active device",size:"small",sx:{backgroundColor:"#EEF2FF",color:"#2563EB",fontWeight:600}})]})]}),!oe&&tn&&(0,B.jsx)(p.A,{severity:"info",sx:{mb:3},action:(0,B.jsx)(v.A,{color:"inherit",size:"small",onClick:()=>{re(!0),_({severity:"info",message:"Workflow draft restored."})},sx:{textTransform:"none",fontWeight:600},children:"Continuer"}),children:"Un workflow en brouillon n'a pas \xe9t\xe9 enregistr\xe9. Cliquez sur Continuer pour reprendre l'\xe9dition."}),cn&&(0,B.jsx)(p.A,{severity:dn,sx:{mb:3},children:un}),oe&&(0,B.jsx)(x.A,{sx:{backgroundColor:"#F8FAFC",border:"2px solid #2563EB",borderRadius:"16px",mb:4,transition:"all 0.2s ease-in-out"},children:(0,B.jsxs)(w.A,{sx:{padding:"20px 24px"},children:[(0,B.jsxs)(s.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,B.jsxs)(i.A,{variant:"h6",sx:{fontSize:"18px",fontWeight:600,color:"#0F172A"},children:["Custom Workflow Builder (",te.length," modules)"]}),(0,B.jsxs)(s.A,{display:"flex",gap:2,alignItems:"center",children:[(0,B.jsx)(l.A,{placeholder:"Workflow name",value:ke,onChange:e=>Ie(e.target.value),size:"small",sx:{width:200}}),(0,B.jsx)(l.A,{placeholder:"Description (optional)",value:De,onChange:e=>Pe(e.target.value),size:"small",sx:{width:260}}),(0,B.jsx)(v.A,{variant:"contained",onClick:()=>{0!==te.length&&ke.trim()?((0,R.ss)({name:ke.trim(),description:De.trim(),modules:te.map(e=>e.module)}),_({message:'Workflow "'.concat(ke,'" created with ').concat(te.length," module(s)"),severity:"success"}),ne([]),re(!1),Ie(""),Pe("")):_({severity:"error",message:"Select modules and provide a workflow name before saving."})},disabled:0===te.length||!ke.trim(),sx:{backgroundColor:"#16A34A",borderRadius:"8px",textTransform:"none",fontWeight:600,"&:hover":{backgroundColor:"#15803D"}},children:"Build Workflow"}),(0,B.jsx)(v.A,{variant:"outlined",onClick:()=>{ne([]),re(!1),Ie(""),Pe("")},sx:{borderColor:"#6B7280",color:"#6B7280",borderRadius:"8px",textTransform:"none"},children:"Cancel"})]})]}),(0,B.jsxs)(s.A,{display:"flex",flexWrap:"wrap",gap:1,onDragOver:On,onDrop:e=>Mn(e,null),sx:{minHeight:64,border:gn?"1px dashed #2563EB":"1px dashed transparent",borderRadius:"12px",padding:1,backgroundColor:gn?"#EEF2FF":"transparent",transition:"border-color 0.2s ease, background-color 0.2s ease"},children:[te.map((e,t)=>(0,B.jsx)(s.A,{draggable:!0,onDragStart:t=>((e,t)=>{e.dataTransfer.setData("text/plain","builder:".concat(t)),e.dataTransfer.effectAllowed="move",hn(t),mn(null)})(t,e.instanceId),onDragOver:On,onDrop:t=>Mn(t,e.instanceId),onDragEnd:Rn,sx:{cursor:"grab",display:"inline-flex"},children:(0,B.jsx)(m.A,{label:"".concat(t+1,". ").concat(e.module.name),onDelete:()=>Pn(e.instanceId),sx:{backgroundColor:fn===e.instanceId?"#DBEAFE":"#EEF2FF",color:"#2563EB",borderRadius:"8px",border:fn===e.instanceId?"1px dashed #2563EB":"none"}})},e.instanceId)),0===te.length&&(0,B.jsx)(i.A,{sx:{color:"#6B7280",fontStyle:"italic"},children:"No modules selected. Click the + button on modules below to add them."})]})]})}),(0,B.jsx)(s.A,{onDragOver:e=>{fn&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},onDrop:e=>{if(!fn)return;e.preventDefault();const t=ee(e.dataTransfer.getData("text/plain")),n="builder"===(null===t||void 0===t?void 0:t.source)?t.id:fn;n&&Pn(n),hn(null)},children:(0,B.jsx)(y.Ay,{container:!0,spacing:3,children:kn.map(e=>{const t="running"===Gt[e.id],n="ping"===e.id&&t,o=n?"#16A34A":"#2563EB",r=n?"#15803D":"#1E48C7";return(0,B.jsx)(y.Ay,{item:!0,xs:12,sm:6,lg:4,children:(0,B.jsx)(x.A,{draggable:!0,onDragStart:t=>((e,t)=>{e.dataTransfer.setData("text/plain","catalog:".concat(t.id)),e.dataTransfer.effectAllowed="copyMove",mn(t.id)})(t,e),onDragEnd:zn,sx:{backgroundColor:"#FFFFFF",border:gn===e.id?"1px dashed #2563EB":"1px solid #E5E7EB",borderRadius:"16px",boxShadow:"0 1px 2px rgba(16, 24, 40, 0.06)",height:"100%",transition:"all 0.2s","&:hover":{boxShadow:"0 4px 8px rgba(16, 24, 40, 0.12)"}},children:(0,B.jsxs)(w.A,{sx:{padding:"20px 24px"},children:[(0,B.jsxs)(s.A,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[(0,B.jsxs)(s.A,{children:[(0,B.jsx)(i.A,{variant:"h6",sx:{fontWeight:600,color:"#0F172A",fontSize:"16px",lineHeight:"24px"},children:e.name}),(0,B.jsx)(m.A,{label:e.category,size:"small",sx:{mt:.5,backgroundColor:"#E0F2FE",color:"#0369A1",fontWeight:600,fontSize:"10px"}})]}),(0,B.jsxs)(a.A,{direction:"row",spacing:1,children:[(0,B.jsx)(b.A,{onClick:()=>Wn(e.id),size:"small",sx:{color:Ne.has(e.id)?"#F59E0B":"#94A3B8"},children:Ne.has(e.id)?(0,B.jsx)(T,{size:18,fill:"#F59E0B"}):(0,B.jsx)(D,{size:18})}),(0,B.jsx)(b.A,{onClick:()=>Dn(e),sx:{width:28,height:28,backgroundColor:"#2563EB",color:"#FFFFFF",borderRadius:"6px","&:hover":{backgroundColor:"#1E48C7"}},children:"+"})]})]}),(0,B.jsx)(i.A,{variant:"body2",sx:{color:"#6B7280",mb:2,fontSize:"14px",lineHeight:"22px"},children:e.description}),(0,B.jsx)(s.A,{display:"flex",gap:2,mb:3,children:(0,B.jsxs)(s.A,{display:"flex",alignItems:"center",gap:1,children:[(0,B.jsx)(P,{size:16,color:"#6B7280"}),(0,B.jsx)(i.A,{variant:"caption",sx:{color:"#6B7280",fontSize:"12px",lineHeight:"18px",fontWeight:500},children:"30-45s"})]})}),(0,B.jsxs)(s.A,{display:"flex",gap:2,children:[(0,B.jsx)(A.A,{title:an?"Run module":"Select at least one device",children:(0,B.jsx)("span",{style:{flex:1},children:(0,B.jsx)(v.A,{variant:"contained",startIcon:(0,B.jsx)(N.A,{size:16}),onClick:()=>(e=>{var t;if(vn(null),"waiting_time"!==e.id){if("call_test"===e.id){const e=In();return 0===e.length?void _({severity:"error",message:"Select at least one device on the dashboard before running the Call Test."}):(ot.current={success:[],failure:[]},void bn(e))}if(ge.has(e.id))_n(e,{silent:"ping"===e.id});else{if(null!==(t=window.electronAPI)&&void 0!==t&&t.runScript)return window.electronAPI.runScript(H(e.script)),void _({message:"Running ".concat(e.name,"\u2026"),severity:"success"});console.info("Run requested for ".concat(e.script)),_({message:"Run placeholder: ".concat(e.script),severity:"info"})}}else _({severity:"info",message:"Waiting Time is only available inside custom workflows."})})(e),disabled:!an||t,sx:{width:"100%",backgroundColor:o,borderRadius:"8px",height:40,fontWeight:600,textTransform:"none",fontSize:"14px","&:hover":{backgroundColor:r},"&.Mui-disabled":{backgroundColor:"#94A3B8"}},children:t?"Running\u2026":"Run"})})}),(0,B.jsx)(A.A,{title:"call_test"===e.id?"Edit parameters":e.editable?"Edit script":"Not editable",children:(0,B.jsx)("span",{children:(0,B.jsx)(b.A,{onClick:()=>(e=>{var t;if("call_test"===e.id){const e=on.length>0?on:[K];Je("edit"),Ze(e),Xe(e.length),et(0);const t=e[0];return Ve(t),qe(wn(t===K?null:t)),nt({}),ot.current={success:[],failure:[]},void Ue(!0)}return"waiting_time"===e.id?(dt(String(at)),ft(null),void lt(!0)):"ping"===e.id?(xt(ce(mt)),yt(null),At(null),Ct(!1),void gt(!0)):"wrong_apn_configuration"===e.id?(Bt(kt),void Ft(!0)):"pull_device_logs"===e.id||"pull_rf_logs"===e.id?(zt(_t),Ut(null),void Mt(!0)):"dial_secret_code"===e.id?(qt(Dt),Vt(null),void Jt(!0)):null!==(t=window.electronAPI)&&void 0!==t&&t.openFile?(window.electronAPI.openFile(H(e.script)),void _({message:"Opening ".concat(e.name," in editor\u2026"),severity:"success"})):void _({message:"Script path: ".concat(H(e.script)),severity:"info"})})(e),disabled:!e.editable&&"call_test"!==e.id,sx:{backgroundColor:"#F1F5F9",color:"#475569",border:"1px solid #E2E8F0",borderRadius:"8px",width:40,height:40,"&:hover":{backgroundColor:"#E2E8F0"},"&.Mui-disabled":{opacity:.4,borderColor:"#E2E8F0"}},children:(0,B.jsx)(F.A,{size:16})})})})]})]})})},e.id)})})}),(0,B.jsxs)(S.A,{open:st,onClose:Nn,fullWidth:!0,maxWidth:"xs",children:[(0,B.jsx)(C.A,{children:"Waiting Time"}),(0,B.jsxs)(j.A,{children:[(0,B.jsx)(i.A,{variant:"body2",sx:{color:"#475569",mb:2},children:"Define how many seconds to wait between workflow modules."}),(0,B.jsx)(l.A,{label:"Duration (seconds)",type:"number",value:ct,onChange:e=>{dt(e.target.value),ft(null)},fullWidth:!0,inputProps:{min:1,max:600},error:Boolean(ut),helperText:null!==ut&&void 0!==ut?ut:"Between 1 and 600 seconds"})]}),(0,B.jsxs)(E.A,{children:[(0,B.jsx)(v.A,{onClick:Nn,sx:{textTransform:"none"},children:"Cancel"}),(0,B.jsx)(v.A,{variant:"contained",onClick:()=>{const e=Number(ct);if(!Number.isFinite(e))return void ft("Enter a value between 1 and 600 seconds.");const t=me(e);it(t),(e=>{if("undefined"!==typeof window&&"undefined"!==typeof window.localStorage)try{window.localStorage.setItem($,String(e))}catch(t){console.warn("[WaitingTime] Failed to persist duration",t)}})(t),dt(String(t)),_({severity:"success",message:"Waiting time set to ".concat(t," second").concat(t>1?"s":"",".")}),Nn()},sx:{textTransform:"none"},children:"Save"})]})]}),(0,B.jsxs)(S.A,{open:ht,onClose:()=>gt(!1),fullWidth:!0,maxWidth:"xs",children:[(0,B.jsx)(C.A,{children:"Ping configuration"}),(0,B.jsxs)(j.A,{children:[(0,B.jsx)(i.A,{variant:"body2",sx:{color:"#475569",mb:2},children:"Define the target host, duration (seconds), and interval between packets."}),(0,B.jsxs)(a.A,{spacing:2,children:[(0,B.jsx)(l.A,{label:"Target (IP or domain)",value:vt.target,onChange:e=>{const t=e.target.value;xt(e=>(0,o.A)((0,o.A)({},e),{},{target:t})),St&&At(le(t)),yt(null)},onBlur:()=>{Ct(!0),At(le(vt.target))},error:Boolean(bt),helperText:null!==bt&&void 0!==bt?bt:"e.g. 8.8.8.8 or example.com",fullWidth:!0}),(0,B.jsx)(l.A,{label:"Duration (seconds)",type:"number",value:vt.duration,onChange:e=>{xt(t=>(0,o.A)((0,o.A)({},t),{},{duration:e.target.value})),yt(null)},inputProps:{min:1,max:600},fullWidth:!0}),(0,B.jsx)(l.A,{label:"Interval (seconds)",type:"number",value:vt.interval,onChange:e=>{xt(t=>(0,o.A)((0,o.A)({},t),{},{interval:e.target.value})),yt(null)},inputProps:{min:.2,max:5,step:.1},fullWidth:!0}),wt?(0,B.jsx)(p.A,{severity:"error",children:wt}):null]})]}),(0,B.jsxs)(E.A,{children:[(0,B.jsx)(v.A,{onClick:()=>gt(!1),sx:{textTransform:"none"},children:"Cancel"}),(0,B.jsx)(v.A,{variant:"contained",sx:{textTransform:"none"},onClick:()=>{const e=le(vt.target);if(Ct(!0),At(e),e)return void yt(null);const t=Number.parseFloat(vt.duration);if(!Number.isFinite(t)||t<1)return void yt("Duration must be a positive number.");const n=Number.parseFloat(vt.interval);if(!Number.isFinite(n)||n<.2)return void yt("Interval must be at least 0.2 seconds.");const o={target:vt.target.trim(),duration:Math.max(1,Math.round(t)),interval:Math.min(5,Math.max(.2,n))};pt(o),(e=>{if("undefined"!==typeof window&&"undefined"!==typeof window.localStorage)try{window.localStorage.setItem(V,JSON.stringify(e))}catch(t){console.warn("[PingConfig] Failed to persist configuration",t)}})(o),xt(ce(o)),yt(null),At(null),Ct(!1),gt(!1),_({severity:"success",message:"Ping configuration saved."})},children:"Save"})]})]}),(0,B.jsxs)(S.A,{open:Nt,onClose:Fn,fullWidth:!0,maxWidth:"xs",children:[(0,B.jsx)(C.A,{children:"Wrong APN Configuration"}),(0,B.jsx)(j.A,{children:(0,B.jsx)(l.A,{margin:"dense",label:"Wrong APN value",fullWidth:!0,value:Wt,onChange:e=>Bt(e.target.value),helperText:'Used by the "Wrong APN Configuration" module (default "arnaud").'})}),(0,B.jsxs)(E.A,{children:[(0,B.jsx)(v.A,{onClick:Fn,children:"Cancel"}),(0,B.jsx)(v.A,{variant:"contained",onClick:()=>{const e=(Wt||"").trim().replace(/[^A-Za-z0-9._-]/g,""),t=e.length>0?e:we;It(t),Bt(t),_({severity:"success",message:'Wrong APN value set to "'.concat(t,'".')}),Ft(!1)},children:"Save"})]})]}),(0,B.jsxs)(S.A,{open:Ot,onClose:Bn,fullWidth:!0,maxWidth:"sm",children:[(0,B.jsx)(C.A,{children:"Log Pull Destination"}),(0,B.jsx)(j.A,{children:(0,B.jsx)(l.A,{margin:"dense",label:"Log pull destination (PC path)",fullWidth:!0,value:Rt,onChange:e=>zt(e.target.value),error:Boolean(Lt),helperText:Lt||"Directory where /sdcard/log content will be copied (per device subfolder)."})}),(0,B.jsxs)(E.A,{children:[(0,B.jsx)(v.A,{onClick:Bn,children:"Cancel"}),(0,B.jsx)(v.A,{variant:"contained",onClick:()=>{const e=(Rt||"").trim();e?(Tt(e),_({severity:"success",message:'Log pull destination set to "'.concat(e,'".')}),Ut(null),Mt(!1)):Ut("Destination path is required.")},children:"Save"})]})]}),(0,B.jsxs)(S.A,{open:Ht,onClose:()=>Jt(!1),fullWidth:!0,maxWidth:"sm",children:[(0,B.jsx)(C.A,{children:"Dial Secret/USSD Code"}),(0,B.jsx)(j.A,{children:(0,B.jsx)(l.A,{margin:"dense",label:"Code to dial (e.g., *#9900#)",fullWidth:!0,value:Kt,onChange:e=>qt(e.target.value),error:Boolean($t),helperText:$t||"Only digits, * and # are supported; the code will be typed then CALL sent."})}),(0,B.jsxs)(E.A,{children:[(0,B.jsx)(v.A,{onClick:()=>Jt(!1),children:"Cancel"}),(0,B.jsx)(v.A,{variant:"contained",onClick:()=>{const e=(Kt||"").trim();e?(Pt(e),(e=>{try{"undefined"!==typeof window&&"undefined"!==typeof window.localStorage&&window.localStorage.setItem(se,e||"")}catch(t){}})(e),Vt(null),Jt(!1),_({severity:"success",message:"Code saved."})):Vt("Enter a code to dial.")},children:"Save"})]})]}),(0,B.jsx)(O,{open:Le,mode:He,initialValues:Ke,targetDeviceId:jn,stepIndex:0===Ge?void 0:Qe+1,totalSteps:Ge,canGoBack:Qe>0,onPrevious:Sn,onCancel:()=>{Ue(!1),Ve(null),et(0),Xe(0),Ze([]),nt({}),ot.current={success:[],failure:[]},"run"===He&&_({severity:"info",message:"Call Test cancelled."})},onSubmit:An}),(0,B.jsx)(k.A,{open:Boolean(n),autoHideDuration:3500,onClose:()=>_(void 0),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:n?(0,B.jsx)(p.A,{severity:n.severity,onClose:()=>_(void 0),sx:{borderRadius:"8px"},children:n.message}):null})]})}}}]);
//# sourceMappingURL=698.784c8c3a.chunk.js.map